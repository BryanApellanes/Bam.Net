(function(){var c="forge";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var d=true;define=function(g,f){f(require,module)}}else{if(typeof forge==="undefined"){forge={disableNativeCode:false}}return}}var b;var a=function(g,f){f.exports=function(h){var k=b.map(function(i){return g(i)});h=h||{};h.defined=h.defined||{};if(h.defined[c]){return h[c]}h.defined[c]=true;for(var j=0;j<k.length;++j){k[j](h)}return h};f.exports.disableNativeCode=false;f.exports(f.exports)};var e=define;define=function(g,f){b=(typeof g==="string")?f.slice(2):g.slice(2);if(d){delete define;return e.apply(null,Array.prototype.slice.call(arguments,0))}define=e;return define.apply(null,Array.prototype.slice.call(arguments,0))};define(["require","module","./aes","./aesCipherSuites","./asn1","./debug","./des","./hmac","./log","./pbkdf2","./pem","./pkcs7","./pkcs1","./pkcs12","./pki","./prng","./pss","./random","./rc2","./task","./tls","./util","./md","./mgf1"],function(){a.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function c(g){g.debug=g.debug||{};g.debug.storage={};g.debug.get=function(h,i){var j;if(typeof(h)==="undefined"){j=g.debug.storage}else{if(h in g.debug.storage){if(typeof(i)==="undefined"){j=g.debug.storage[h]}else{j=g.debug.storage[h][i]}}}return j};g.debug.set=function(h,j,i){if(!(h in g.debug.storage)){g.debug.storage[h]={}}g.debug.storage[h][j]=i};g.debug.clear=function(h,i){if(typeof(h)==="undefined"){g.debug.storage={}}else{if(h in g.debug.storage){if(typeof(i)==="undefined"){delete g.debug.storage[h]}else{delete g.debug.storage[h][i]}}}}}var d="debug";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var e=true;define=function(h,g){g(require,module)}}else{if(typeof forge==="undefined"){forge={}}return c(forge)}}var b;var a=function(h,g){g.exports=function(j){var l=b.map(function(i){return h(i)}).concat(c);j=j||{};j.defined=j.defined||{};if(j.defined[d]){return j[d]}j.defined[d]=true;for(var k=0;k<l.length;++k){l[k](j)}return j[d]}};var f=define;define=function(h,g){b=(typeof h==="string")?g.slice(2):h.slice(2);if(e){delete define;return f.apply(null,Array.prototype.slice.call(arguments,0))}define=f;return define.apply(null,Array.prototype.slice.call(arguments,0))};define(["require","module"],function(){a.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function c(r){var s=r.util=r.util||{};if(typeof process==="undefined"||!process.nextTick){if(typeof setImmediate==="function"){s.setImmediate=setImmediate;s.nextTick=function(t){return setImmediate(t)}}else{s.setImmediate=function(t){setTimeout(t,0)};s.nextTick=s.setImmediate}}else{s.nextTick=process.nextTick;if(typeof setImmediate==="function"){s.setImmediate=setImmediate}else{s.setImmediate=s.nextTick}}s.isArray=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};s.isArrayBuffer=function(t){return typeof ArrayBuffer!=="undefined"&&t instanceof ArrayBuffer};var g=[];if(typeof Int8Array!=="undefined"){g.push(Int8Array)}if(typeof Uint8Array!=="undefined"){g.push(Uint8Array)}if(typeof Uint8ClampedArray!=="undefined"){g.push(Uint8ClampedArray)}if(typeof Int16Array!=="undefined"){g.push(Int16Array)}if(typeof Uint16Array!=="undefined"){g.push(Uint16Array)}if(typeof Int32Array!=="undefined"){g.push(Int32Array)}if(typeof Uint32Array!=="undefined"){g.push(Uint32Array)}if(typeof Float32Array!=="undefined"){g.push(Float32Array)}if(typeof Float64Array!=="undefined"){g.push(Float64Array)}s.isArrayBufferView=function(u){for(var t=0;t<g.length;++t){if(u instanceof g[t]){return true}}return false};s.ByteBuffer=function(u){this.data="";this.read=0;if(typeof u==="string"){this.data=u}else{if(s.isArrayBuffer(u)||s.isArrayBufferView(u)){var t=new Uint8Array(u);try{this.data=String.fromCharCode.apply(null,t)}catch(v){for(var w=0;w<t.length;++w){this.putByte(t[w])}}}}};s.ByteBuffer.prototype.length=function(){return this.data.length-this.read};s.ByteBuffer.prototype.isEmpty=function(){return this.length()<=0};s.ByteBuffer.prototype.putByte=function(t){this.data+=String.fromCharCode(t);return this};s.ByteBuffer.prototype.fillWithByte=function(t,v){t=String.fromCharCode(t);var u=this.data;while(v>0){if(v&1){u+=t}v>>>=1;if(v>0){t+=t}}this.data=u;return this};s.ByteBuffer.prototype.putBytes=function(t){this.data+=t;return this};s.ByteBuffer.prototype.putString=function(t){this.data+=s.encodeUtf8(t);return this};s.ByteBuffer.prototype.putInt16=function(t){this.data+=String.fromCharCode(t>>8&255)+String.fromCharCode(t&255);return this};s.ByteBuffer.prototype.putInt24=function(t){this.data+=String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255);return this};s.ByteBuffer.prototype.putInt32=function(t){this.data+=String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255);return this};s.ByteBuffer.prototype.putInt16Le=function(t){this.data+=String.fromCharCode(t&255)+String.fromCharCode(t>>8&255);return this};s.ByteBuffer.prototype.putInt24Le=function(t){this.data+=String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255);return this};s.ByteBuffer.prototype.putInt32Le=function(t){this.data+=String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>24&255);return this};s.ByteBuffer.prototype.putInt=function(t,u){do{u-=8;this.data+=String.fromCharCode((t>>u)&255)}while(u>0);return this};s.ByteBuffer.prototype.putSignedInt=function(t,u){if(t<0){t+=2<<(u-1)}return this.putInt(t,u)};s.ByteBuffer.prototype.putBuffer=function(t){this.data+=t.getBytes();return this};s.ByteBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};s.ByteBuffer.prototype.getInt16=function(){var t=(this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1));this.read+=2;return t};s.ByteBuffer.prototype.getInt24=function(){var t=(this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2));this.read+=3;return t};s.ByteBuffer.prototype.getInt32=function(){var t=(this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3));this.read+=4;return t};s.ByteBuffer.prototype.getInt16Le=function(){var t=(this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8);this.read+=2;return t};s.ByteBuffer.prototype.getInt24Le=function(){var t=(this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16);this.read+=3;return t};s.ByteBuffer.prototype.getInt32Le=function(){var t=(this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24);this.read+=4;return t};s.ByteBuffer.prototype.getInt=function(t){var u=0;do{u=(u<<8)+this.data.charCodeAt(this.read++);t-=8}while(t>0);return u};s.ByteBuffer.prototype.getSignedInt=function(u){var v=this.getInt(u);var t=2<<(u-2);if(v>=t){v-=t<<1}return v};s.ByteBuffer.prototype.getBytes=function(t){var u;if(t){t=Math.min(this.length(),t);u=this.data.slice(this.read,this.read+t);this.read+=t}else{if(t===0){u=""}else{u=(this.read===0)?this.data:this.data.slice(this.read);this.clear()}}return u};s.ByteBuffer.prototype.bytes=function(t){return(typeof(t)==="undefined"?this.data.slice(this.read):this.data.slice(this.read,this.read+t))};s.ByteBuffer.prototype.at=function(t){return this.data.charCodeAt(this.read+t)};s.ByteBuffer.prototype.setAt=function(u,t){this.data=this.data.substr(0,this.read+u)+String.fromCharCode(t)+this.data.substr(this.read+u+1);return this};s.ByteBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};s.ByteBuffer.prototype.copy=function(){var t=s.createBuffer(this.data);t.read=this.read;return t};s.ByteBuffer.prototype.compact=function(){if(this.read>0){this.data=this.data.slice(this.read);this.read=0}return this};s.ByteBuffer.prototype.clear=function(){this.data="";this.read=0;return this};s.ByteBuffer.prototype.truncate=function(t){var u=Math.max(0,this.length()-t);this.data=this.data.substr(this.read,u);this.read=0;return this};s.ByteBuffer.prototype.toHex=function(){var v="";for(var u=this.read;u<this.data.length;++u){var t=this.data.charCodeAt(u);if(t<16){v+="0"}v+=t.toString(16)}return v};s.ByteBuffer.prototype.toString=function(){return s.decodeUtf8(this.bytes())};s.createBuffer=function(u,t){t=t||"raw";if(u!==undefined&&t==="utf8"){u=s.encodeUtf8(u)}return new s.ByteBuffer(u)};s.fillString=function(t,u){var v="";while(u>0){if(u&1){v+=t}u>>>=1;if(u>0){t+=t}}return v};s.xorBytes=function(y,z,x){var A="";var u="";var B="";var w=0;var v=0;for(;x>0;--x,++w){u=y.charCodeAt(w)^z.charCodeAt(w);if(v>=10){A+=B;B="";v=0}B+=String.fromCharCode(u);++v}A+=B;return A};s.hexToBytes=function(t){var v="";var u=0;if(t.length&1==1){u=1;v+=String.fromCharCode(parseInt(t[0],16))}for(;u<t.length;u+=2){v+=String.fromCharCode(parseInt(t.substr(u,2),16))}return v};s.bytesToHex=function(t){return s.createBuffer(t).toHex()};s.int32ToBytes=function(t){return(String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};var h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var i=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];s.encode64=function(x,z){var y="";var A="";var t,u,v;var w=0;while(w<x.length){t=x.charCodeAt(w++);u=x.charCodeAt(w++);v=x.charCodeAt(w++);y+=h.charAt(t>>2);y+=h.charAt(((t&3)<<4)|(u>>4));if(isNaN(u)){y+="=="}else{y+=h.charAt(((u&15)<<2)|(v>>6));y+=isNaN(v)?"=":h.charAt(v&63)}if(z&&y.length>z){A+=y.substr(0,z)+"\r\n";y=y.substr(z)}}A+=y;return A};s.decode64=function(y){y=y.replace(/[^A-Za-z0-9\+\/\=]/g,"");var z="";var t,u,v,w;var x=0;while(x<y.length){t=i[y.charCodeAt(x++)-43];u=i[y.charCodeAt(x++)-43];v=i[y.charCodeAt(x++)-43];w=i[y.charCodeAt(x++)-43];z+=String.fromCharCode((t<<2)|(u>>4));if(v!==64){z+=String.fromCharCode(((u&15)<<4)|(v>>2));if(w!==64){z+=String.fromCharCode(((v&3)<<6)|w)}}}return z};s.encodeUtf8=function(t){return unescape(encodeURIComponent(t))};s.decodeUtf8=function(t){return decodeURIComponent(escape(t))};s.deflate=function(t,u,w){u=s.decode64(t.deflate(s.encode64(u)).rval);if(w){var x=2;var v=u.charCodeAt(1);if(v&32){x=6}u=u.substring(x,u.length-4)}return u};s.inflate=function(t,u,v){var w=t.inflate(s.encode64(u)).rval;return(w===null)?null:s.decode64(w)};var q=function(t,u,v){if(!t){throw {message:"WebStorage not available."}}var w;if(v===null){w=t.removeItem(u)}else{v=s.encode64(JSON.stringify(v));w=t.setItem(u,v)}if(typeof(w)!=="undefined"&&w.rval!==true){throw w.error}};var m=function(t,u){if(!t){throw {message:"WebStorage not available."}}var v=t.getItem(u);if(t.init){if(v.rval===null){if(v.error){throw v.error}v=null}else{v=v.rval}}if(v!==null){v=JSON.parse(s.decode64(v))}return v};var p=function(t,v,w,u){var x=m(t,v);if(x===null){x={}}x[w]=u;q(t,v,x)};var l=function(t,u,v){var w=m(t,u);if(w!==null){w=(v in w)?w[v]:null}return w};var o=function(t,v,w){var x=m(t,v);if(x!==null&&w in x){delete x[w];var u=true;for(var y in x){u=false;break}if(u){x=null}q(t,v,x)}};var k=function(t,u){q(t,u,null)};var j=function(x,t,z){var A=null;if(typeof(z)==="undefined"){z=["web","flash"]}var B;var u=false;var w=null;for(var y in z){B=z[y];try{if(B==="flash"||B==="both"){if(t[0]===null){throw {message:"Flash local storage not available."}}else{A=x.apply(this,t);u=(B==="flash")}}if(B==="web"||B==="both"){t[0]=localStorage;A=x.apply(this,t);u=true}}catch(v){w=v}if(u){break}}if(!u){throw w}return A};s.setItem=function(t,v,w,u,x){j(p,arguments,x)};s.getItem=function(t,u,v,w){return j(l,arguments,w)};s.removeItem=function(t,u,v,w){j(o,arguments,w)};s.clearItems=function(t,u,v){j(k,arguments,v)};s.parseUrl=function(v){var u=/^(https?):\/\/([^:&^\/]*):?(\d*)(.*)$/g;u.lastIndex=0;var t=u.exec(v);var w=(t===null)?null:{full:v,scheme:t[1],host:t[2],port:t[3],path:t[4]};if(w){w.fullHost=w.host;if(w.port){if(w.port!==80&&w.scheme==="http"){w.fullHost+=":"+w.port}else{if(w.port!==443&&w.scheme==="https"){w.fullHost+=":"+w.port}}}else{if(w.scheme==="http"){w.port=80}else{if(w.scheme==="https"){w.port=443}}}w.full=w.scheme+"://"+w.fullHost}return w};var n=null;s.getQueryVariables=function(u){var t=function(A){var B={};var y=A.split("&");for(var w=0;w<y.length;w++){var z=y[w].indexOf("=");var x;var C;if(z>0){x=y[w].substring(0,z);C=y[w].substring(z+1)}else{x=y[w];C=null}if(!(x in B)){B[x]=[]}if(!(x in Object.prototype)&&C!==null){B[x].push(unescape(C))}}return B};var v;if(typeof(u)==="undefined"){if(n===null){if(typeof(window)==="undefined"){n={}}else{n=t(window.location.search.substring(1))}}v=n}else{v=t(u)}return v};s.parseFragment=function(v){var t=v;var u="";var x=v.indexOf("?");if(x>0){t=v.substring(0,x);u=v.substring(x+1)}var w=t.split("/");if(w.length>0&&w[0]===""){w.shift()}var y=(u==="")?{}:s.getQueryVariables(u);return{pathString:t,queryString:u,path:w,query:y}};s.makeRequest=function(v){var t=s.parseFragment(v);var u={path:t.pathString,query:t.queryString,getPath:function(w){return(typeof(w)==="undefined")?t.path:t.path[w]},getQuery:function(x,w){var y;if(typeof(x)==="undefined"){y=t.query}else{y=t.query[x];if(y&&typeof(w)!=="undefined"){y=y[w]}}return y},getQueryLast:function(x,w){var y;var z=u.getQuery(x);if(z){y=z[z.length-1]}else{y=w}return y}};return u};s.makeLink=function(u,w,t){u=jQuery.isArray(u)?u.join("/"):u;var v=jQuery.param(w||{});t=t||"";return u+((v.length>0)?("?"+v):"")+((t.length>0)?("#"+t):"")};s.setPath=function(y,v,z){if(typeof(y)==="object"&&y!==null){var u=0;var w=v.length;while(u<w){var x=v[u++];if(u==w){y[x]=z}else{var t=(x in y);if(!t||(t&&typeof(y[x])!=="object")||(t&&y[x]===null)){y[x]={}}y=y[x]}}}};s.getPath=function(z,w,t){var v=0;var x=w.length;var u=true;while(u&&v<x&&typeof(z)==="object"&&z!==null){var y=w[v++];u=y in z;if(u){z=z[y]}}return(u?z:t)};s.deletePath=function(x,u){if(typeof(x)==="object"&&x!==null){var t=0;var v=u.length;while(t<v){var w=u[t++];if(t==v){delete x[w]}else{if(!(w in x)||(typeof(x[w])!=="object")||(x[w]===null)){break}x=x[w]}}}};s.isEmpty=function(t){for(var u in t){if(t.hasOwnProperty(u)){return false}}return true};s.format=function(v){var A=/%./g;var x;var y;var t=0;var z=[];var w=0;while((x=A.exec(v))){y=v.substring(w,A.lastIndex-2);if(y.length>0){z.push(y)}w=A.lastIndex;var u=x[0][1];switch(u){case"s":case"o":if(t<arguments.length){z.push(arguments[t+++1])}else{z.push("<?>")}break;case"%":z.push("%");break;default:z.push("<%"+u+"?>")}}z.push(v.substring(w));return z.join("")};s.formatNumber=function(B,x,w,E){var A=B,u=isNaN(x=Math.abs(x))?2:x;var v=w===undefined?",":w;var D=E===undefined?".":E,C=A<0?"-":"";var y=parseInt((A=Math.abs(+A||0).toFixed(u)),10)+"";var z=(y.length>3)?y.length%3:0;return C+(z?y.substr(0,z)+D:"")+y.substr(z).replace(/(\d{3})(?=\d)/g,"$1"+D)+(u?v+Math.abs(A-y).toFixed(u).slice(2):"")};s.formatSize=function(t){if(t>=1073741824){t=s.formatNumber(t/1073741824,2,".","")+" GiB"}else{if(t>=1048576){t=s.formatNumber(t/1048576,2,".","")+" MiB"}else{if(t>=1024){t=s.formatNumber(t/1024,0)+" KiB"}else{t=s.formatNumber(t,0)+" bytes"}}}return t};s.bytesFromIP=function(t){if(t.indexOf(".")!==-1){return s.bytesFromIPv4(t)}if(t.indexOf(":")!==-1){return s.bytesFromIPv6(t)}return null};s.bytesFromIPv4=function(v){v=v.split(".");if(v.length!==4){return null}var t=s.createBuffer();for(var u=0;u<v.length;++u){var w=parseInt(v[u],10);if(isNaN(w)){return null}t.putByte(w)}return t.getBytes()};s.bytesFromIPv6=function(x){var u=0;x=x.split(":").filter(function(z){if(z.length===0){++u}return true});var y=(8-x.length+u)*2;var t=s.createBuffer();for(var w=0;w<8;++w){if(!x[w]||x[w].length===0){t.fillWithByte(0,y);y=0;continue}var v=s.hexToBytes(x[w]);if(v.length<2){t.putByte(0)}t.putBytes(v)}return t.getBytes()};s.bytesToIP=function(t){if(t.length===4){return s.bytesToIPv4(t)}if(t.length===16){return s.bytesToIPv6(t)}return null};s.bytesToIPv4=function(t){if(t.length!==4){return null}var v=[];for(var u=0;u<t.length;++u){v.push(t.charCodeAt(u))}return v.join(".")};s.bytesToIPv6=function(t){if(t.length!==16){return null}var y=[];var A=[];var B=0;for(var w=0;w<t.length;w+=2){var v=s.bytesToHex(t[w]+t[w+1]);while(v[0]==="0"&&v!=="0"){v=v.substr(1)}if(v==="0"){var z=A[A.length-1];var x=y.length;if(!z||x!==z.end+1){A.push({start:x,end:x})}else{z.end=x;if((z.end-z.start)>(A[B].end-A[B].start)){B=A.length-1}}}y.push(v)}if(A.length>0){var u=A[B];if(u.end-u.start>0){y.splice(u.start,u.end-u.start+1,"");if(u.start===0){y.unshift("")}if(u.end===7){y.push("")}}}return y.join(":")};s.estimateCores=function(w,u){if(typeof w==="function"){u=w;w={}}w=w||{};if("cores" in s&&!w.update){return u(null,s.cores)}if(typeof Worker===undefined){s.cores=1;return u(null,s.cores)}if(typeof Blob===undefined){s.cores=2;return u(null,s.cores)}var t=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(z){var B=Date.now();var A=B+4;while(Date.now()<A){}self.postMessage({st:B,et:A})})}.toString(),")()"],{type:"application/javascript"}));y([],5,16);function y(A,C,B){if(C===0){var z=Math.floor(A.reduce(function(D,E){return D+E},0)/A.length);s.cores=Math.max(1,z);URL.revokeObjectURL(t);return u(null,s.cores)}v(B,function(D,E){A.push(x(B,E));y(A,C-1,B)})}function v(B,z){var E=[];var C=[];for(var A=0;A<B;++A){var D=new Worker(t);D.addEventListener("message",function(F){C.push(F.data);if(C.length===B){for(var G=0;G<B;++G){E[G].terminate()}z(null,C)}});E.push(D)}for(var A=0;A<B;++A){E[A].postMessage(A)}}function x(B,G){var D=[];for(var A=0;A<B;++A){var E=G[A];var C=D[A]=[];for(var z=0;z<B;++z){if(A===z){continue}var F=G[z];if((E.st>F.st&&E.st<F.et)||(F.st>E.st&&F.st<E.et)){C.push(z)}}}return D.reduce(function(H,I){return Math.max(H,I.length)},0)}}}var d="util";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var e=true;define=function(h,g){g(require,module)}}else{if(typeof forge==="undefined"){forge={}}return c(forge)}}var b;var a=function(h,g){g.exports=function(j){var l=b.map(function(i){return h(i)}).concat(c);j=j||{};j.defined=j.defined||{};if(j.defined[d]){return j[d]}j.defined[d]=true;for(var k=0;k<l.length;++k){l[k](j)}return j[d]}};var f=define;define=function(h,g){b=(typeof h==="string")?g.slice(2):h.slice(2);if(e){delete define;return f.apply(null,Array.prototype.slice.call(arguments,0))}define=f;return define.apply(null,Array.prototype.slice.call(arguments,0))};define(["require","module"],function(){a.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function c(h){h.log=h.log||{};h.log.levels=["none","error","warning","info","debug","verbose","max"];var r={};var s=[];var q=null;h.log.LEVEL_LOCKED=(1<<1);h.log.NO_LEVEL_CHECK=(1<<2);h.log.INTERPOLATE=(1<<3);for(var j=0;j<h.log.levels.length;++j){var k=h.log.levels[j];r[k]={index:j,name:k.toUpperCase()}}h.log.logMessage=function(w){var x=r[w.level].index;for(var t=0;t<s.length;++t){var u=s[t];if(u.flags&h.log.NO_LEVEL_CHECK){u.f(w)}else{var v=r[u.level].index;if(x<=v){u.f(u,w)}}}};h.log.prepareStandard=function(i){if(!("standard" in i)){i.standard=r[i.level].name+" ["+i.category+"] "+i.message}};h.log.prepareFull=function(t){if(!("full" in t)){var i=[t.message];i=i.concat([]||t["arguments"]);t.full=h.util.format.apply(this,i)}};h.log.prepareStandardFull=function(i){if(!("standardFull" in i)){h.log.prepareStandard(i);i.standardFull=i.standard}};if(true){var m=["error","warning","info","debug","verbose"];for(var j=0;j<m.length;++j){(function(i){h.log[i]=function(u,v){var t=Array.prototype.slice.call(arguments).slice(2);var w={timestamp:new Date(),level:i,category:u,message:v,"arguments":t};h.log.logMessage(w)}})(m[j])}}h.log.makeLogger=function(i){var t={flags:0,f:i};h.log.setLevel(t,"none");return t};h.log.setLevel=function(w,v){var x=false;if(w&&!(w.flags&h.log.LEVEL_LOCKED)){for(var u=0;u<h.log.levels.length;++u){var t=h.log.levels[u];if(v==t){w.level=v;x=true;break}}}return x};h.log.lock=function(t,i){if(typeof i==="undefined"||i){t.flags|=h.log.LEVEL_LOCKED}else{t.flags&=~h.log.LEVEL_LOCKED}};h.log.addLogger=function(i){s.push(i)};if(typeof(console)!=="undefined"&&"log" in console){var o;if(console.error&&console.warn&&console.info&&console.debug){var l={error:console.error,warning:console.warn,info:console.info,debug:console.debug,verbose:console.debug};var g=function(u,v){h.log.prepareStandard(v);var t=l[v.level];var i=[v.standard];i=i.concat(v["arguments"].slice());t.apply(console,i)};o=h.log.makeLogger(g)}else{var g=function(i,t){h.log.prepareStandardFull(t);console.log(t.standardFull)};o=h.log.makeLogger(g)}h.log.setLevel(o,"debug");h.log.addLogger(o);q=o}else{console={log:function(){}}}if(q!==null){var p=h.util.getQueryVariables();if("console.level" in p){h.log.setLevel(q,p["console.level"].slice(-1)[0])}if("console.lock" in p){var n=p["console.lock"].slice(-1)[0];if(n=="true"){h.log.lock(q)}}}h.log.consoleLogger=q}var d="log";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var e=true;define=function(h,g){g(require,module)}}else{if(typeof forge==="undefined"){forge={}}return c(forge)}}var b;var a=function(h,g){g.exports=function(j){var l=b.map(function(i){return h(i)}).concat(c);j=j||{};j.defined=j.defined||{};if(j.defined[d]){return j[d]}j.defined[d]=true;for(var k=0;k<l.length;++k){l[k](j)}return j[d]}};var f=define;define=function(h,g){b=(typeof h==="string")?g.slice(2):h.slice(2);if(e){delete define;return f.apply(null,Array.prototype.slice.call(arguments,0))}define=f;return define.apply(null,Array.prototype.slice.call(arguments,0))};define(["require","module","./util"],function(){a.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function c(o){var j="forge.task";var E=0;var B={};var v=0;o.debug.set(j,"tasks",B);var A={};o.debug.set(j,"queues",A);var w="?";var u=30;var C=20;var p="ready";var r="running";var h="blocked";var t="sleeping";var k="done";var l="error";var D="stop";var z="start";var g="block";var G="unblock";var s="sleep";var H="wakeup";var i="cancel";var m="fail";var x={};x[p]={};x[p][D]=p;x[p][z]=r;x[p][i]=k;x[p][m]=l;x[r]={};x[r][D]=p;x[r][z]=r;x[r][g]=h;x[r][G]=r;x[r][s]=t;x[r][H]=r;x[r][i]=k;x[r][m]=l;x[h]={};x[h][D]=h;x[h][z]=h;x[h][g]=h;x[h][G]=h;x[h][s]=h;x[h][H]=h;x[h][i]=k;x[h][m]=l;x[t]={};x[t][D]=t;x[t][z]=t;x[t][g]=t;x[t][G]=t;x[t][s]=t;x[t][H]=t;x[t][i]=k;x[t][m]=l;x[k]={};x[k][D]=k;x[k][z]=k;x[k][g]=k;x[k][G]=k;x[k][s]=k;x[k][H]=k;x[k][i]=k;x[k][m]=l;x[l]={};x[l][D]=l;x[l][z]=l;x[l][g]=l;x[l][G]=l;x[l][s]=l;x[l][H]=l;x[l][i]=l;x[l][m]=l;var F=function(I){this.id=-1;this.name=I.name||w;this.parent=I.parent||null;this.run=I.run;this.subtasks=[];this.error=false;this.state=p;this.blocks=0;this.timeoutId=null;this.swapTime=null;this.userData=null;this.id=v++;B[this.id]=this;if(E>=1){o.log.verbose(j,"[%s][%s] init",this.id,this.name,this)}};F.prototype.debug=function(I){I=I||"";o.log.debug(j,I,"[%s][%s] task:",this.id,this.name,this,"subtasks:",this.subtasks.length,"queue:",A)};F.prototype.next=function(I,J){if(typeof(I)==="function"){J=I;I=this.name}var K=new F({run:J,name:I,parent:this});K.state=r;K.type=this.type;K.successCallback=this.successCallback||null;K.failureCallback=this.failureCallback||null;this.subtasks.push(K);return this};F.prototype.parallel=function(I,J){if(o.util.isArray(I)){J=I;I=this.name}return this.next(I,function(P){var N=P;N.block(J.length);var O=function(R,Q){o.task.start({type:R,run:function(S){J[Q](S)},success:function(S){N.unblock()},failure:function(S){N.unblock()}})};for(var K=0;K<J.length;K++){var M=I+"__parallel-"+P.id+"-"+K;var L=K;O(M,L)}})};F.prototype.stop=function(){this.state=x[this.state][D]};F.prototype.start=function(){this.error=false;this.state=x[this.state][z];if(this.state===r){this.start=new Date();this.run(this);q(this,0)}};F.prototype.block=function(I){I=typeof(I)==="undefined"?1:I;this.blocks+=I;if(this.blocks>0){this.state=x[this.state][g]}};F.prototype.unblock=function(I){I=typeof(I)==="undefined"?1:I;this.blocks-=I;if(this.blocks===0&&this.state!==k){this.state=r;q(this,0)}return this.blocks};F.prototype.sleep=function(I){I=typeof(I)==="undefined"?0:I;this.state=x[this.state][s];var J=this;this.timeoutId=setTimeout(function(){J.timeoutId=null;J.state=r;q(J,0)},I)};F.prototype.wait=function(I){I.wait(this)};F.prototype.wakeup=function(){if(this.state===t){cancelTimeout(this.timeoutId);this.timeoutId=null;this.state=r;q(this,0)}};F.prototype.cancel=function(){this.state=x[this.state][i];this.permitsNeeded=0;if(this.timeoutId!==null){cancelTimeout(this.timeoutId);this.timeoutId=null}this.subtasks=[]};F.prototype.fail=function(I){this.error=true;n(this,true);if(I){I.error=this.error;I.swapTime=this.swapTime;I.userData=this.userData;q(I,0)}else{if(this.parent!==null){var J=this.parent;while(J.parent!==null){J.error=this.error;J.swapTime=this.swapTime;J.userData=this.userData;J=J.parent}n(J,true)}if(this.failureCallback){this.failureCallback(this)}}};var y=function(I){I.error=false;I.state=x[I.state][z];setTimeout(function(){if(I.state===r){I.swapTime=+new Date();I.run(I);q(I,0)}},0)};var q=function(L,J){var K=(J>u)||(+new Date()-L.swapTime)>C;var I=function(M){M++;if(L.state===r){if(K){L.swapTime=+new Date()}if(L.subtasks.length>0){var N=L.subtasks.shift();N.error=L.error;N.swapTime=L.swapTime;N.userData=L.userData;N.run(N);if(!N.error){q(N,M)}}else{n(L);if(!L.error){if(L.parent!==null){L.parent.error=L.error;L.parent.swapTime=L.swapTime;L.parent.userData=L.userData;q(L.parent,M)}}}}};if(K){setTimeout(I,0)}else{I(J)}};var n=function(J,I){J.state=k;delete B[J.id];if(E>=1){o.log.verbose(j,"[%s][%s] finish",J.id,J.name,J)}if(J.parent===null){if(!(J.type in A)){o.log.error(j,"[%s][%s] task queue missing [%s]",J.id,J.name,J.type)}else{if(A[J.type].length===0){o.log.error(j,"[%s][%s] task queue empty [%s]",J.id,J.name,J.type)}else{if(A[J.type][0]!==J){o.log.error(j,"[%s][%s] task not first in queue [%s]",J.id,J.name,J.type)}else{A[J.type].shift();if(A[J.type].length===0){if(E>=1){o.log.verbose(j,"[%s][%s] delete queue [%s]",J.id,J.name,J.type)}delete A[J.type]}else{if(E>=1){o.log.verbose(j,"[%s][%s] queue start next [%s] remain:%s",J.id,J.name,J.type,A[J.type].length)}A[J.type][0].start()}}}}if(!I){if(J.error&&J.failureCallback){J.failureCallback(J)}else{if(!J.error&&J.successCallback){J.successCallback(J)}}}}};o.task=o.task||{};o.task.start=function(I){var J=new F({run:I.run,name:I.name||w});J.type=I.type;J.successCallback=I.success||null;J.failureCallback=I.failure||null;if(!(J.type in A)){if(E>=1){o.log.verbose(j,"[%s][%s] create queue [%s]",J.id,J.name,J.type)}A[J.type]=[J];y(J)}else{A[I.type].push(J)}};o.task.cancel=function(I){if(I in A){A[I]=[A[I][0]]}};o.task.createCondition=function(){var I={tasks:{}};I.wait=function(J){if(!(J.id in I.tasks)){J.block();I.tasks[J.id]=J}};I.notify=function(){var K=I.tasks;I.tasks={};for(var J in K){K[J].unblock()}};return I}}var d="task";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var e=true;define=function(h,g){g(require,module)}}else{if(typeof forge==="undefined"){forge={}}return c(forge)}}var b;var a=function(h,g){g.exports=function(j){var l=b.map(function(i){return h(i)}).concat(c);j=j||{};j.defined=j.defined||{};if(j.defined[d]){return j[d]}j.defined[d]=true;for(var k=0;k<l.length;++k){l[k](j)}return j[d]}};var f=define;define=function(h,g){b=(typeof h==="string")?g.slice(2):h.slice(2);if(e){delete define;return f.apply(null,Array.prototype.slice.call(arguments,0))}define=f;return define.apply(null,Array.prototype.slice.call(arguments,0))};define(["require","module","./debug","./log","./util"],function(){a.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function c(n){var o=n.md5=n.md5||{};n.md=n.md||{};n.md.algorithms=n.md.algorithms||{};n.md.md5=n.md.algorithms.md5=o;var k=null;var g=null;var l=null;var j=null;var i=false;var h=function(){k=String.fromCharCode(128);k+=n.util.fillString(String.fromCharCode(0),64);g=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,1,6,11,0,5,10,15,4,9,14,3,8,13,2,7,12,5,8,11,14,1,4,7,10,13,0,3,6,9,12,15,2,0,7,14,5,12,3,10,1,8,15,6,13,4,11,2,9];l=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21];j=new Array(64);for(var p=0;p<64;++p){j[p]=Math.floor(Math.abs(Math.sin(p+1))*4294967296)}i=true};var m=function(C,E,u){var D,p,q,v,x,y,B,z;var A=u.length();while(A>=64){p=C.h0;q=C.h1;v=C.h2;x=C.h3;for(z=0;z<16;++z){E[z]=u.getInt32Le();y=x^(q&(v^x));D=(p+y+j[z]+E[z]);B=l[z];p=x;x=v;v=q;q+=(D<<B)|(D>>>(32-B))}for(;z<32;++z){y=v^(x&(q^v));D=(p+y+j[z]+E[g[z]]);B=l[z];p=x;x=v;v=q;q+=(D<<B)|(D>>>(32-B))}for(;z<48;++z){y=q^v^x;D=(p+y+j[z]+E[g[z]]);B=l[z];p=x;x=v;v=q;q+=(D<<B)|(D>>>(32-B))}for(;z<64;++z){y=v^(q|~x);D=(p+y+j[z]+E[g[z]]);B=l[z];p=x;x=v;v=q;q+=(D<<B)|(D>>>(32-B))}C.h0=(C.h0+p)&4294967295;C.h1=(C.h1+q)&4294967295;C.h2=(C.h2+v)&4294967295;C.h3=(C.h3+x)&4294967295;A-=64}};o.create=function(){if(!i){h()}var q=null;var p=n.util.createBuffer();var r=new Array(16);var s={algorithm:"md5",blockLength:64,digestLength:16,messageLength:0};s.start=function(){s.messageLength=0;p=n.util.createBuffer();q={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878};return s};s.start();s.update=function(u,t){if(t==="utf8"){u=n.util.encodeUtf8(u)}s.messageLength+=u.length;p.putBytes(u);m(q,r,p);if(p.read>2048||p.length()===0){p.compact()}return s};s.digest=function(){var t=s.messageLength;var u=n.util.createBuffer();u.putBytes(p.bytes());u.putBytes(k.substr(0,64-((t+8)%64)));u.putInt32Le((t<<3)&4294967295);u.putInt32Le((t>>>29)&255);var w={h0:q.h0,h1:q.h1,h2:q.h2,h3:q.h3};m(w,r,u);var v=n.util.createBuffer();v.putInt32Le(w.h0);v.putInt32Le(w.h1);v.putInt32Le(w.h2);v.putInt32Le(w.h3);return v};return s}}var d="md5";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var e=true;define=function(h,g){g(require,module)}}else{if(typeof forge==="undefined"){forge={}}return c(forge)}}var b;var a=function(h,g){g.exports=function(j){var l=b.map(function(i){return h(i)}).concat(c);j=j||{};j.defined=j.defined||{};if(j.defined[d]){return j[d]}j.defined[d]=true;for(var k=0;k<l.length;++k){l[k](j)}return j[d]}};var f=define;define=function(h,g){b=(typeof h==="string")?g.slice(2):h.slice(2);if(e){delete define;return f.apply(null,Array.prototype.slice.call(arguments,0))}define=f;return define.apply(null,Array.prototype.slice.call(arguments,0))};define(["require","module","./util"],function(){a.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function c(k){var l=k.sha1=k.sha1||{};k.md=k.md||{};k.md.algorithms=k.md.algorithms||{};k.md.sha1=k.md.algorithms.sha1=l;var i=null;var h=false;var g=function(){i=String.fromCharCode(128);i+=k.util.fillString(String.fromCharCode(0),64);h=true};var j=function(y,A,o){var z,m,n,p,q,r,u,v;var x=o.length();while(x>=64){m=y.h0;n=y.h1;p=y.h2;q=y.h3;r=y.h4;for(v=0;v<16;++v){z=o.getInt32();A[v]=z;u=q^(n&(p^q));z=((m<<5)|(m>>>27))+u+r+1518500249+z;r=q;q=p;p=(n<<30)|(n>>>2);n=m;m=z}for(;v<20;++v){z=(A[v-3]^A[v-8]^A[v-14]^A[v-16]);z=(z<<1)|(z>>>31);A[v]=z;u=q^(n&(p^q));z=((m<<5)|(m>>>27))+u+r+1518500249+z;r=q;q=p;p=(n<<30)|(n>>>2);n=m;m=z}for(;v<32;++v){z=(A[v-3]^A[v-8]^A[v-14]^A[v-16]);z=(z<<1)|(z>>>31);A[v]=z;u=n^p^q;z=((m<<5)|(m>>>27))+u+r+1859775393+z;r=q;q=p;p=(n<<30)|(n>>>2);n=m;m=z}for(;v<40;++v){z=(A[v-6]^A[v-16]^A[v-28]^A[v-32]);z=(z<<2)|(z>>>30);A[v]=z;u=n^p^q;z=((m<<5)|(m>>>27))+u+r+1859775393+z;r=q;q=p;p=(n<<30)|(n>>>2);n=m;m=z}for(;v<60;++v){z=(A[v-6]^A[v-16]^A[v-28]^A[v-32]);z=(z<<2)|(z>>>30);A[v]=z;u=(n&p)|(q&(n^p));z=((m<<5)|(m>>>27))+u+r+2400959708+z;r=q;q=p;p=(n<<30)|(n>>>2);n=m;m=z}for(;v<80;++v){z=(A[v-6]^A[v-16]^A[v-28]^A[v-32]);z=(z<<2)|(z>>>30);A[v]=z;u=n^p^q;z=((m<<5)|(m>>>27))+u+r+3395469782+z;r=q;q=p;p=(n<<30)|(n>>>2);n=m;m=z}y.h0+=m;y.h1+=n;y.h2+=p;y.h3+=q;y.h4+=r;x-=64}};l.create=function(){if(!h){g()}var n=null;var m=k.util.createBuffer();var o=new Array(80);var p={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0};p.start=function(){p.messageLength=0;m=k.util.createBuffer();n={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520};return p};p.start();p.update=function(r,q){if(q==="utf8"){r=k.util.encodeUtf8(r)}p.messageLength+=r.length;m.putBytes(r);j(n,o,m);if(m.read>2048||m.length()===0){m.compact()}return p};p.digest=function(){var q=p.messageLength;var r=k.util.createBuffer();r.putBytes(m.bytes());r.putBytes(i.substr(0,64-((q+8)%64)));r.putInt32((q>>>29)&255);r.putInt32((q<<3)&4294967295);var t={h0:n.h0,h1:n.h1,h2:n.h2,h3:n.h3,h4:n.h4};j(t,o,r);var s=k.util.createBuffer();s.putInt32(t.h0);s.putInt32(t.h1);s.putInt32(t.h2);s.putInt32(t.h3);s.putInt32(t.h4);return s};return p}}var d="sha1";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var e=true;define=function(h,g){g(require,module)}}else{if(typeof forge==="undefined"){forge={}}return c(forge)}}var b;var a=function(h,g){g.exports=function(j){var l=b.map(function(i){return h(i)}).concat(c);j=j||{};j.defined=j.defined||{};if(j.defined[d]){return j[d]}j.defined[d]=true;for(var k=0;k<l.length;++k){l[k](j)}return j[d]}};var f=define;define=function(h,g){b=(typeof h==="string")?g.slice(2):h.slice(2);if(e){delete define;return f.apply(null,Array.prototype.slice.call(arguments,0))}define=f;return define.apply(null,Array.prototype.slice.call(arguments,0))};define(["require","module","./util"],function(){a.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function c(l){var m=l.sha256=l.sha256||{};l.md=l.md||{};l.md.algorithms=l.md.algorithms||{};l.md.sha256=l.md.algorithms.sha256=m;var j=null;var h=false;var i=null;var g=function(){j=String.fromCharCode(128);j+=l.util.fillString(String.fromCharCode(0),64);i=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];h=true};var k=function(C,H,p){var F,G,D,E,r,B,z,n,o,q,t,u,v,x,y;var A=p.length();while(A>=64){for(z=0;z<16;++z){H[z]=p.getInt32()}for(;z<64;++z){F=H[z-2];F=((F>>>17)|(F<<15))^((F>>>19)|(F<<13))^(F>>>10);G=H[z-15];G=((G>>>7)|(G<<25))^((G>>>18)|(G<<14))^(G>>>3);H[z]=(F+H[z-7]+G+H[z-16])&4294967295}n=C.h0;o=C.h1;q=C.h2;t=C.h3;u=C.h4;v=C.h5;x=C.h6;y=C.h7;for(z=0;z<64;++z){E=((u>>>6)|(u<<26))^((u>>>11)|(u<<21))^((u>>>25)|(u<<7));r=x^(u&(v^x));D=((n>>>2)|(n<<30))^((n>>>13)|(n<<19))^((n>>>22)|(n<<10));B=(n&o)|(q&(n^o));F=y+E+r+i[z]+H[z];G=D+B;y=x;x=v;v=u;u=(t+F)&4294967295;t=q;q=o;o=n;n=(F+G)&4294967295}C.h0=(C.h0+n)&4294967295;C.h1=(C.h1+o)&4294967295;C.h2=(C.h2+q)&4294967295;C.h3=(C.h3+t)&4294967295;C.h4=(C.h4+u)&4294967295;C.h5=(C.h5+v)&4294967295;C.h6=(C.h6+x)&4294967295;C.h7=(C.h7+y)&4294967295;A-=64}};m.create=function(){if(!h){g()}var o=null;var n=l.util.createBuffer();var p=new Array(64);var q={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0};q.start=function(){q.messageLength=0;n=l.util.createBuffer();o={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225};return q};q.start();q.update=function(s,r){if(r==="utf8"){s=l.util.encodeUtf8(s)}q.messageLength+=s.length;n.putBytes(s);k(o,p,n);if(n.read>2048||n.length()===0){n.compact()}return q};q.digest=function(){var r=q.messageLength;var s=l.util.createBuffer();s.putBytes(n.bytes());s.putBytes(j.substr(0,64-((r+8)%64)));s.putInt32((r>>>29)&255);s.putInt32((r<<3)&4294967295);var u={h0:o.h0,h1:o.h1,h2:o.h2,h3:o.h3,h4:o.h4,h5:o.h5,h6:o.h6,h7:o.h7};k(u,p,s);var t=l.util.createBuffer();t.putInt32(u.h0);t.putInt32(u.h1);t.putInt32(u.h2);t.putInt32(u.h3);t.putInt32(u.h4);t.putInt32(u.h5);t.putInt32(u.h6);t.putInt32(u.h7);return t};return q}}var d="sha256";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var e=true;define=function(h,g){g(require,module)}}else{if(typeof forge==="undefined"){forge={}}return c(forge)}}var b;var a=function(h,g){g.exports=function(j){var l=b.map(function(i){return h(i)}).concat(c);j=j||{};j.defined=j.defined||{};if(j.defined[d]){return j[d]}j.defined[d]=true;for(var k=0;k<l.length;++k){l[k](j)}return j[d]}};var f=define;define=function(h,g){b=(typeof h==="string")?g.slice(2):h.slice(2);if(e){delete define;return f.apply(null,Array.prototype.slice.call(arguments,0))}define=f;return define.apply(null,Array.prototype.slice.call(arguments,0))};define(["require","module","./util"],function(){a.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function c(g){var h=g.hmac=g.hmac||{};h.create=function(){var j=null;var k=null;var i=null;var l=null;var m={};m.start=function(q,o){if(q!==null){if(typeof q==="string"){q=q.toLowerCase();if(q in g.md.algorithms){k=g.md.algorithms[q].create()}else{throw'Unknown hash algorithm "'+q+'"'}}else{k=q}}if(o===null){o=j}else{if(typeof o==="string"){o=g.util.createBuffer(o)}else{if(g.util.isArray(o)){var r=o;o=g.util.createBuffer();for(var n=0;n<r.length;++n){o.putByte(r[n])}}}var p=o.length();if(p>k.blockLength){k.start();k.update(o.bytes());o=k.digest()}i=g.util.createBuffer();l=g.util.createBuffer();p=o.length();for(var n=0;n<p;++n){var r=o.at(n);i.putByte(54^r);l.putByte(92^r)}if(p<k.blockLength){var r=k.blockLength-p;for(var n=0;n<r;++n){i.putByte(54);l.putByte(92)}}j=o;i=i.bytes();l=l.bytes()}k.start();k.update(i)};m.update=function(n){k.update(n)};m.getMac=function(){var n=k.digest().bytes();k.start();k.update(l);k.update(n);return k.digest()};m.digest=m.getMac;return m}}var d="hmac";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var e=true;define=function(h,g){g(require,module)}}else{if(typeof forge==="undefined"){forge={}}return c(forge)}}var b;var a=function(h,g){g.exports=function(j){var l=b.map(function(i){return h(i)}).concat(c);j=j||{};j.defined=j.defined||{};if(j.defined[d]){return j[d]}j.defined[d]=true;for(var k=0;k<l.length;++k){l[k](j)}return j[d]}};var f=define;define=function(h,g){b=(typeof h==="string")?g.slice(2):h.slice(2);if(e){delete define;return f.apply(null,Array.prototype.slice.call(arguments,0))}define=f;return define.apply(null,Array.prototype.slice.call(arguments,0))};define(["require","module","./md","./util"],function(){a.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function c(g){var h=g.pkcs5=g.pkcs5||{};g.pbkdf2=h.pbkdf2=function(v,y,k,m,u){if(typeof u==="undefined"||u===null){u=g.md.sha1.create()}var n=u.digestLength;if(m>(4294967295*n)){throw {message:"Derived key is too long."}}var t=Math.ceil(m/n);var x=m-(t-1)*n;var w=g.hmac.create();w.start(u,v);var l="";var B,z,A;for(var o=1;o<=t;++o){w.start(null,null);w.update(y);w.update(g.util.int32ToBytes(o));B=A=w.digest().getBytes();for(var q=2;q<=k;++q){w.start(null,null);w.update(A);z=w.digest().getBytes();B=g.util.xorBytes(B,z,n);A=z}l+=(o<t)?B:B.substr(0,x)}return l}}var d="pbkdf2";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var e=true;define=function(h,g){g(require,module)}}else{if(typeof forge==="undefined"){forge={}}return c(forge)}}var b;var a=function(h,g){g.exports=function(j){var l=b.map(function(i){return h(i)}).concat(c);j=j||{};j.defined=j.defined||{};if(j.defined[d]){return j[d]}j.defined[d]=true;for(var k=0;k<l.length;++k){l[k](j)}return j[d]}};var f=define;define=function(h,g){b=(typeof h==="string")?g.slice(2):h.slice(2);if(e){delete define;return f.apply(null,Array.prototype.slice.call(arguments,0))}define=f;return define.apply(null,Array.prototype.slice.call(arguments,0))};define(["require","module","./hmac","./md","./util"],function(){a.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function c(j){var l=false;var p=4;var r;var n;var q;var o;var k;var m=function(){l=true;q=[0,1,2,4,8,16,32,64,128,27,54];var D=new Array(256);for(var x=0;x<128;++x){D[x]=x<<1;D[x+128]=(x+128)<<1^283}r=new Array(256);n=new Array(256);o=new Array(4);k=new Array(4);for(var x=0;x<4;++x){o[x]=new Array(256);k[x]=new Array(256)}var s=0,w=0,t,u,v,B,C,z,y;for(var x=0;x<256;++x){B=w^(w<<1)^(w<<2)^(w<<3)^(w<<4);B=(B>>8)^(B&255)^99;r[s]=B;n[B]=s;C=D[B];t=D[s];u=D[t];v=D[u];z=(C<<24)^(B<<16)^(B<<8)^(B^C);y=(t^u^v)<<24^(s^v)<<16^(s^u^v)<<8^(s^t^v);for(var A=0;A<4;++A){o[A][s]=z;k[A][B]=y;z=z<<24|z>>>8;y=y<<24|y>>>8}if(s===0){s=w=1}else{s=t^D[D[D[t^v]]];w^=D[D[w]]}}};var i=function(x,s){var H=x.slice(0);var F,v=1;var D=H.length;var E=D+6+1;var t=p*E;for(var u=D;u<t;++u){F=H[u-1];if(u%D===0){F=r[F>>>16&255]<<24^r[F>>>8&255]<<16^r[F&255]<<8^r[F>>>24]^(q[v]<<24);v++}else{if(D>6&&(u%D===4)){F=r[F>>>24]<<24^r[F>>>16&255]<<16^r[F>>>8&255]<<8^r[F&255]}}H[u]=H[u-D]^F}if(s){var G;var y=k[0];var z=k[1];var A=k[2];var B=k[3];var J=H.slice(0);var t=H.length;for(var u=0,I=t-p;u<t;u+=p,I-=p){if(u===0||u===(t-p)){J[u]=H[I];J[u+1]=H[I+3];J[u+2]=H[I+2];J[u+3]=H[I+1]}else{for(var C=0;C<p;++C){G=H[I+C];J[u+(3&-C)]=y[r[G>>>24]]^z[r[G>>>16&255]]^A[r[G>>>8&255]]^B[r[G&255]]}}}H=J}return H};var h=function(L,C,I,A){var H=L.length/4-1;var D,E,F,G,K;if(A){D=k[0];E=k[1];F=k[2];G=k[3];K=n}else{D=o[0];E=o[1];F=o[2];G=o[3];K=r}var s,u,x,z,t,v,y;s=C[0]^L[0];u=C[A?3:1]^L[1];x=C[2]^L[2];z=C[A?1:3]^L[3];var B=3;for(var J=1;J<H;++J){t=D[s>>>24]^E[u>>>16&255]^F[x>>>8&255]^G[z&255]^L[++B];v=D[u>>>24]^E[x>>>16&255]^F[z>>>8&255]^G[s&255]^L[++B];y=D[x>>>24]^E[z>>>16&255]^F[s>>>8&255]^G[u&255]^L[++B];z=D[z>>>24]^E[s>>>16&255]^F[u>>>8&255]^G[x&255]^L[++B];s=t;u=v;x=y}I[0]=(K[s>>>24]<<24)^(K[u>>>16&255]<<16)^(K[x>>>8&255]<<8)^(K[z&255])^L[++B];I[A?3:1]=(K[u>>>24]<<24)^(K[x>>>16&255]<<16)^(K[z>>>8&255]<<8)^(K[s&255])^L[++B];I[2]=(K[x>>>24]<<24)^(K[z>>>16&255]<<16)^(K[s>>>8&255]<<8)^(K[u&255])^L[++B];I[A?1:3]=(K[z>>>24]<<24)^(K[s>>>16&255]<<16)^(K[u>>>8&255]<<8)^(K[x&255])^L[++B]};var g=function(J,I,N,G,L){var E=null;if(!l){m()}L=(L||"CBC").toUpperCase();if(typeof J==="string"&&(J.length===16||J.length===24||J.length===32)){J=j.util.createBuffer(J)}else{if(j.util.isArray(J)&&(J.length===16||J.length===24||J.length===32)){var P=J;var J=j.util.createBuffer();for(var H=0;H<P.length;++H){J.putByte(P[H])}}}if(!j.util.isArray(J)){var P=J;J=[];var K=P.length();if(K===16||K===24||K===32){K=K>>>2;for(var H=0;H<K;++H){J.push(P.getInt32())}}}if(!j.util.isArray(J)||!(J.length===4||J.length===6||J.length===8)){return E}var B=(["CFB","OFB","CTR"].indexOf(L)!==-1);var O=(L==="CBC");var A=i(J,G&&!B);var s=p<<2;var v;var y;var u;var x;var z;var t;var w;E={output:null};if(L==="CBC"){w=C}else{if(L==="CFB"){w=D}else{if(L==="OFB"){w=M}else{if(L==="CTR"){w=F}else{throw {message:'Unsupported block cipher mode of operation: "'+L+'"'}}}}}E.update=function(Q){if(!t){v.putBuffer(Q)}while(v.length()>=s||(v.length()>0&&t)){w()}};E.finish=function(T){var V=true;var S=v.length()%s;if(!G){if(T){V=T(s,v,G)}else{if(O){var U=(v.length()===s)?s:(s-v.length());v.fillWithByte(U,U)}}}if(V){t=true;E.update()}if(G){if(O){V=(S===0)}if(V){if(T){V=T(s,y,G)}else{if(O){var R=y.length();var Q=y.at(R-1);if(Q>(p<<2)){V=false}else{y.truncate(Q)}}}}}if(!O&&!T&&S>0){y.truncate(s-S)}return V};E.start=function(R,S){if(R===null){R=z.slice(0)}if(typeof R==="string"&&R.length===16){R=j.util.createBuffer(R)}else{if(j.util.isArray(R)&&R.length===16){var T=R;var R=j.util.createBuffer();for(var Q=0;Q<16;++Q){R.putByte(T[Q])}}}if(!j.util.isArray(R)){var T=R;R=new Array(4);R[0]=T.getInt32();R[1]=T.getInt32();R[2]=T.getInt32();R[3]=T.getInt32()}v=j.util.createBuffer();y=S||j.util.createBuffer();z=R.slice(0);u=new Array(p);x=new Array(p);t=false;E.output=y;if(["CFB","OFB","CTR"].indexOf(L)!==-1){for(var Q=0;Q<p;++Q){u[Q]=z[Q]}z=null}};if(I!==null){E.start(I,N)}return E;function C(){if(G){for(var Q=0;Q<p;++Q){u[Q]=v.getInt32()}}else{for(var Q=0;Q<p;++Q){u[Q]=z[Q]^v.getInt32()}}h(A,u,x,G);if(G){for(var Q=0;Q<p;++Q){y.putInt32(z[Q]^x[Q])}z=u.slice(0)}else{for(var Q=0;Q<p;++Q){y.putInt32(x[Q])}z=x}}function D(){h(A,u,x,false);for(var Q=0;Q<p;++Q){u[Q]=v.getInt32()}for(var Q=0;Q<p;++Q){var R=u[Q]^x[Q];if(!G){u[Q]=R}y.putInt32(R)}}function M(){h(A,u,x,false);for(var Q=0;Q<p;++Q){u[Q]=v.getInt32()}for(var Q=0;Q<p;++Q){y.putInt32(u[Q]^x[Q]);u[Q]=x[Q]}}function F(){h(A,u,x,false);for(var Q=p-1;Q>=0;--Q){if(u[Q]===4294967295){u[Q]=0}else{++u[Q];break}}for(var Q=0;Q<p;++Q){y.putInt32(v.getInt32()^x[Q])}}};j.aes=j.aes||{};j.aes.startEncrypting=function(t,s,v,u){return g(t,s,v,false,u)};j.aes.createEncryptionCipher=function(s,t){return g(s,null,null,false,t)};j.aes.startDecrypting=function(t,s,v,u){return g(t,s,v,true,u)};j.aes.createDecryptionCipher=function(s,t){return g(s,null,null,true,t)};j.aes._expandKey=function(t,s){if(!l){m()}return i(t,s)};j.aes._updateBlock=h}var d="aes";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var e=true;define=function(h,g){g(require,module)}}else{if(typeof forge==="undefined"){forge={}}return c(forge)}}var b;var a=function(h,g){g.exports=function(j){var l=b.map(function(i){return h(i)}).concat(c);j=j||{};j.defined=j.defined||{};if(j.defined[d]){return j[d]}j.defined[d]=true;for(var k=0;k<l.length;++k){l[k](j)}return j[d]}};var f=define;define=function(h,g){b=(typeof h==="string")?g.slice(2):h.slice(2);if(e){delete define;return f.apply(null,Array.prototype.slice.call(arguments,0))}define=f;return define.apply(null,Array.prototype.slice.call(arguments,0))};define(["require","module","./util"],function(){a.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function c(h){var j=h.pem=h.pem||{};j.encode=function(m,n){n=n||{};var o="-----BEGIN "+m.type+"-----\r\n";var k;if(m.procType){k={name:"Proc-Type",values:[String(m.procType.version),m.procType.type]};o+=g(k)}if(m.contentDomain){k={name:"Content-Domain",values:[m.contentDomain]};o+=g(k)}if(m.dekInfo){k={name:"DEK-Info",values:[m.dekInfo.algorithm]};if(m.dekInfo.parameters){k.values.push(m.dekInfo.parameters)}o+=g(k)}if(m.headers){for(var l=0;l<m.headers.length;++l){o+=g(m.headers[l])}}if(m.procType){o+="\r\n"}o+=h.util.encode64(m.body,n.maxline||64)+"\r\n";o+="-----END "+m.type+"-----\r\n";return o};j.decode=function(w){var v=[];var u=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g;var t=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/;var s=/\r?\n/;var o;while(true){o=u.exec(w);if(!o){break}var p={type:o[1],procType:null,contentDomain:null,dekInfo:null,headers:[],body:h.util.decode64(o[3])};v.push(p);if(!o[2]){continue}var n=o[2].split(s);var l=0;while(o&&l<n.length){var m=n[l].replace(/\s+$/,"");for(var r=l+1;r<n.length;++r){var q=n[r];if(!/\s/.test(q[0])){break}m+=q;l=r}o=m.match(t);if(o){var k={name:o[1],values:[]};var x=o[2].split(",");for(var y=0;y<x.length;++y){k.values.push(i(x[y]))}if(!p.procType){if(k.name!=="Proc-Type"){throw {message:'Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".'}}else{if(k.values.length!==2){throw {message:'Invalid PEM formatted message. The "Proc-Type" header must have two subfields.'}}}p.procType={version:x[0],type:x[1]}}else{if(!p.contentDomain&&k.name==="Content-Domain"){p.contentDomain=x[0]||""}else{if(!p.dekInfo&&k.name==="DEK-Info"){if(k.values.length===0){throw {message:'Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.'}}p.dekInfo={algorithm:x[0],parameters:x[1]||null}}else{p.headers.push(k)}}}}++l}if(p.procType==="ENCRYPTED"&&!p.dekInfo){throw {message:'Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".'}}}if(v.length===0){throw {message:"Invalid PEM formatted message."}}return v};function g(l){var p=l.name+": ";var q=[];for(var m=0;m<l.values.length;++m){q.push(l.values[m].replace(/^(\S+\r\n)/,function(s,r){return" "+r}))}p+=q.join(",")+"\r\n";var o=0;var k=-1;for(var m=0;m<p.length;++m,++o){if(o>65&&k!==-1){var n=p[k];if(n===","){++k;p=p.substr(0,k)+"\r\n "+p.substr(k)}else{p=p.substr(0,k)+"\r\n"+n+p.substr(k+1)}o=(m-k-1);k=-1;++m}else{if(p[m]===" "||p[m]==="\t"||p[m]===","){k=m}}}return p}function i(k){return k.replace(/^\s+/,"")}}var d="pem";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var e=true;define=function(h,g){g(require,module)}}else{if(typeof forge==="undefined"){forge={}}return c(forge)}}var b;var a=function(h,g){g.exports=function(j){var l=b.map(function(i){return h(i)}).concat(c);j=j||{};j.defined=j.defined||{};if(j.defined[d]){return j[d]}j.defined[d]=true;for(var k=0;k<l.length;++k){l[k](j)}return j[d]}};var f=define;define=function(h,g){b=(typeof h==="string")?g.slice(2):h.slice(2);if(e){delete define;return f.apply(null,Array.prototype.slice.call(arguments,0))}define=f;return define.apply(null,Array.prototype.slice.call(arguments,0))};define(["require","module","./util"],function(){a.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function c(j){var i=j.asn1=j.asn1||{};i.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};i.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};i.create=function(m,o,k,p){if(j.util.isArray(p)){var n=[];for(var l=0;l<p.length;++l){if(p[l]!==undefined){n.push(p[l])}}p=n}return{tagClass:m,type:o,constructed:k,composed:k||j.util.isArray(p),value:p}};var g=function(k){var l=k.getByte();if(l===128){return undefined}var m;var n=l&128;if(!n){m=l}else{m=k.getInt((l&127)<<3)}return m};i.fromDer=function(l,u){if(u===undefined){u=true}if(typeof l==="string"){l=j.util.createBuffer(l)}if(l.length()<2){throw {message:"Too few bytes to parse DER.",bytes:l.length()}}var k=l.getByte();var v=(k&192);var x=k&31;var r=g(l);if(l.length()<r){if(u){throw {message:"Too few bytes to read ASN.1 value.",detail:l.length()+" < "+r}}r=l.length()}var z;var n=((k&32)===32);var m=n;if(!m&&v===i.Class.UNIVERSAL&&x===i.Type.BITSTRING&&r>1){var s=l.read;var y=l.getByte();if(y===0){k=l.getByte();var w=(k&192);if(w===i.Class.UNIVERSAL||w===i.Class.CONTEXT_SPECIFIC){try{var q=g(l);m=(q===r-(l.read-s));if(m){++s;--r}}catch(o){}}}l.read=s}if(m){z=[];if(r===undefined){for(;;){if(l.bytes(2)===String.fromCharCode(0,0)){l.getBytes(2);break}z.push(i.fromDer(l,u))}}else{var t=l.length();while(r>0){z.push(i.fromDer(l,u));r-=t-l.length();t=l.length()}}}else{if(r===undefined){if(u){throw {message:"Non-constructed ASN.1 object of indefinite length."}}else{r=l.length()}}if(x===i.Type.BMPSTRING){z="";for(var p=0;p<r;p+=2){z+=String.fromCharCode(l.getInt16())}}else{z=l.getBytes(r)}}return i.create(v,x,n,z)};i.toDer=function(p){var l=j.util.createBuffer();var k=p.tagClass|p.type;var q=j.util.createBuffer();if(p.composed){if(p.constructed){k|=32}else{q.putByte(0)}for(var m=0;m<p.value.length;++m){if(p.value[m]!==undefined){q.putBuffer(i.toDer(p.value[m]))}}}else{if(p.type===i.Type.BMPSTRING){for(var m=0;m<p.value.length;++m){q.putInt16(p.value.charCodeAt(m))}}else{q.putBytes(p.value)}}l.putByte(k);if(q.length()<=127){l.putByte(q.length()&127)}else{var n=q.length();var o="";do{o+=String.fromCharCode(n&255);n=n>>>8}while(n>0);l.putByte(o.length|128);for(var m=o.length-1;m>=0;--m){l.putByte(o.charCodeAt(m))}}l.putBuffer(q);return l};i.oidToDer=function(q){var t=q.split(".");var l=j.util.createBuffer();l.putByte(40*parseInt(t[0],10)+parseInt(t[1],10));var o,s,r,k;for(var m=2;m<t.length;++m){o=true;s=[];r=parseInt(t[m],10);do{k=r&127;r=r>>>7;if(!o){k|=128}s.push(k);o=false}while(r>0);for(var p=s.length-1;p>=0;--p){l.putByte(s[p])}}return l};i.derToOid=function(l){var m;if(typeof l==="string"){l=j.util.createBuffer(l)}var k=l.getByte();m=Math.floor(k/40)+"."+(k%40);var n=0;while(l.length()>0){k=l.getByte();n=n<<7;if(k&128){n+=k&127}else{m+="."+(n+k);n=0}}return m};i.utcTimeToDate=function(v){var l=new Date();var w=parseInt(v.substr(0,2),10);w=(w>=50)?1900+w:2000+w;var r=parseInt(v.substr(2,2),10)-1;var m=parseInt(v.substr(4,2),10);var o=parseInt(v.substr(6,2),10);var q=parseInt(v.substr(8,2),10);var u=0;if(v.length>11){var k=v.charAt(10);var n=10;if(k!=="+"&&k!=="-"){u=parseInt(v.substr(10,2),10);n+=2}}l.setUTCFullYear(w,r,m);l.setUTCHours(o,q,u,0);if(n){k=v.charAt(n);if(k==="+"||k==="-"){var p=parseInt(v.substr(n+1,2),10);var s=parseInt(v.substr(n+4,2),10);var t=p*60+s;t*=60000;if(k==="+"){l.setTime(+l-t)}else{l.setTime(+l+t)}}}return l};i.generalizedTimeToDate=function(p){var l=new Date();var y=parseInt(p.substr(0,4),10);var u=parseInt(p.substr(4,2),10)-1;var m=parseInt(p.substr(6,2),10);var q=parseInt(p.substr(8,2),10);var t=parseInt(p.substr(10,2),10);var x=parseInt(p.substr(12,2),10);var o=0;var w=0;var s=false;if(p.charAt(p.length-1)==="Z"){s=true}var n=p.length-5,k=p.charAt(n);if(k==="+"||k==="-"){var r=parseInt(p.substr(n+1,2),10);var v=parseInt(p.substr(n+4,2),10);w=r*60+v;w*=60000;if(k==="+"){w*=-1}s=true}if(p.charAt(14)==="."){o=parseFloat(p.substr(14),10)*1000}if(s){l.setUTCFullYear(y,u,m);l.setUTCHours(q,t,x,o);l.setTime(+l+w)}else{l.setFullYear(y,u,m);l.setHours(q,t,x,o)}return l};i.dateToUtcTime=function(k){var n="";var l=[];l.push((""+k.getUTCFullYear()).substr(2));l.push(""+(k.getUTCMonth()+1));l.push(""+k.getUTCDate());l.push(""+k.getUTCHours());l.push(""+k.getUTCMinutes());l.push(""+k.getUTCSeconds());for(var m=0;m<l.length;++m){if(l[m].length<2){n+="0"}n+=l[m]}n+="Z";return n};i.integerToDer=function(l){var k=j.util.createBuffer();if(l>=-128&&l<128){return k.putSignedInt(l,8)}if(l>=-32768&&l<32768){return k.putSignedInt(l,16)}if(l>=-8388608&&l<8388608){return k.putSignedInt(l,24)}if(l>=-2147483648&&l<2147483648){return k.putSignedInt(l,32)}throw {message:"Integer too large; max is 32-bits.",integer:l}};i.derToInteger=function(k){if(typeof k==="string"){k=j.util.createBuffer(k)}var l=k.length()*8;if(l>32){throw {message:"Integer too large; max is 32-bits."}}return k.getSignedInt(l)};i.validate=function(o,q,k,l){var p=false;if((o.tagClass===q.tagClass||typeof(q.tagClass)==="undefined")&&(o.type===q.type||typeof(q.type)==="undefined")){if(o.constructed===q.constructed||typeof(q.constructed)==="undefined"){p=true;if(q.value&&j.util.isArray(q.value)){var n=0;for(var m=0;p&&m<q.value.length;++m){p=q.value[m].optional||false;if(o.value[n]){p=i.validate(o.value[n],q.value[m],k,l);if(p){++n}else{if(q.value[m].optional){p=true}}}if(!p&&l){l.push("["+q.name+'] Tag class "'+q.tagClass+'", type "'+q.type+'" expected value length "'+q.value.length+'", got "'+o.value.length+'"')}}}if(p&&k){if(q.capture){k[q.capture]=o.value}if(q.captureAsn1){k[q.captureAsn1]=o}}}else{if(l){l.push("["+q.name+'] Expected constructed "'+q.constructed+'", got "'+o.constructed+'"')}}}else{if(l){if(o.tagClass!==q.tagClass){l.push("["+q.name+'] Expected tag class "'+q.tagClass+'", got "'+o.tagClass+'"')}if(o.type!==q.type){l.push("["+q.name+'] Expected type "'+q.type+'", got "'+o.type+'"')}}}return p};var h=/[^\\u0000-\\u00ff]/;i.prettyPrint=function(p,o,n){var r="";o=o||0;n=n||2;if(o>0){r+="\n"}var m="";for(var l=0;l<o*n;++l){m+=" "}r+=m+"Tag: ";switch(p.tagClass){case i.Class.UNIVERSAL:r+="Universal:";break;case i.Class.APPLICATION:r+="Application:";break;case i.Class.CONTEXT_SPECIFIC:r+="Context-Specific:";break;case i.Class.PRIVATE:r+="Private:";break}if(p.tagClass===i.Class.UNIVERSAL){r+=p.type;switch(p.type){case i.Type.NONE:r+=" (None)";break;case i.Type.BOOLEAN:r+=" (Boolean)";break;case i.Type.BITSTRING:r+=" (Bit string)";break;case i.Type.INTEGER:r+=" (Integer)";break;case i.Type.OCTETSTRING:r+=" (Octet string)";break;case i.Type.NULL:r+=" (Null)";break;case i.Type.OID:r+=" (Object Identifier)";break;case i.Type.ODESC:r+=" (Object Descriptor)";break;case i.Type.EXTERNAL:r+=" (External or Instance of)";break;case i.Type.REAL:r+=" (Real)";break;case i.Type.ENUMERATED:r+=" (Enumerated)";break;case i.Type.EMBEDDED:r+=" (Embedded PDV)";break;case i.Type.UTF8:r+=" (UTF8)";break;case i.Type.ROID:r+=" (Relative Object Identifier)";break;case i.Type.SEQUENCE:r+=" (Sequence)";break;case i.Type.SET:r+=" (Set)";break;case i.Type.PRINTABLESTRING:r+=" (Printable String)";break;case i.Type.IA5String:r+=" (IA5String (ASCII))";break;case i.Type.UTCTIME:r+=" (UTC time)";break;case i.Type.GENERALIZEDTIME:r+=" (Generalized time)";break;case i.Type.BMPSTRING:r+=" (BMP String)";break}}else{r+=p.type}r+="\n";r+=m+"Constructed: "+p.constructed+"\n";if(p.composed){var t=0;var s="";for(var l=0;l<p.value.length;++l){if(p.value[l]!==undefined){t+=1;s+=i.prettyPrint(p.value[l],o+1,n);if((l+1)<p.value.length){s+=","}}}r+=m+"Sub values: "+t+s}else{r+=m+"Value: ";if(p.type===i.Type.OID){var q=i.derToOid(p.value);r+=q;if(j.pki&&j.pki.oids){if(q in j.pki.oids){r+=" ("+j.pki.oids[q]+")"}}}if(p.type===i.Type.INTEGER){try{r+=i.derToInteger(p.value)}catch(k){r+="0x"+j.util.bytesToHex(p.value)}}else{if(h.test(p.value)){r+="0x"+j.util.createBuffer(p.value,"utf8").toHex()}else{if(p.value.length===0){r+="[null]"}else{r+=p.value}}}}return r}}var d="asn1";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var e=true;define=function(h,g){g(require,module)}}else{if(typeof forge==="undefined"){forge={}}return c(forge)}}var b;var a=function(h,g){g.exports=function(j){var l=b.map(function(i){return h(i)}).concat(c);j=j||{};j.defined=j.defined||{};if(j.defined[d]){return j[d]}j.defined[d]=true;for(var k=0;k<l.length;++k){l[k](j)}return j[d]}};var f=define;define=function(h,g){b=(typeof h==="string")?g.slice(2):h.slice(2);if(e){delete define;return f.apply(null,Array.prototype.slice.call(arguments,0))}define=f;return define.apply(null,Array.prototype.slice.call(arguments,0))};define(["require","module","./util","./oids"],function(){a.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function c(aU){var aT;var aL=244837814094590;var aX=((aL&16777215)==15715070);function s(bk,bl,bm){this.data=[];if(bk!=null){if("number"==typeof bk){this.fromNumber(bk,bl,bm)}else{if(bl==null&&"string"!=typeof bk){this.fromString(bk,256)}else{this.fromString(bk,bl)}}}}function a7(){return new s(null)}function g(bl,bq,bp,bm,bk,bn){while(--bn>=0){var bo=bq*this.data[bl++]+bp.data[bm]+bk;bk=Math.floor(bo/67108864);bp.data[bm++]=bo&67108863}return bk}function h(bm,bs,br,bn,bk,bq){var bu=bs&32767,bt=bs>>15;while(--bq>=0){var bo=this.data[bm]&32767;var bl=this.data[bm++]>>15;var bp=bt*bo+bl*bu;bo=bu*bo+((bp&32767)<<15)+br.data[bn]+(bk&1073741823);bk=(bo>>>30)+(bp>>>15)+bt*bl+(bk>>>30);br.data[bn++]=bo&1073741823}return bk}function i(bm,bs,br,bn,bk,bq){var bu=bs&16383,bt=bs>>14;while(--bq>=0){var bo=this.data[bm]&16383;var bl=this.data[bm++]>>14;var bp=bt*bo+bl*bu;bo=bu*bo+((bp&16383)<<14)+br.data[bn]+bk;bk=(bo>>28)+(bp>>14)+bt*bl;br.data[bn++]=bo&268435455}return bk}if(typeof(navigator)==="undefined"){s.prototype.am=i;aT=28}else{if(aX&&(navigator.appName=="Microsoft Internet Explorer")){s.prototype.am=h;aT=30}else{if(aX&&(navigator.appName!="Netscape")){s.prototype.am=g;aT=26}else{s.prototype.am=i;aT=28}}}s.prototype.DB=aT;s.prototype.DM=((1<<aT)-1);s.prototype.DV=(1<<aT);var p=52;s.prototype.FV=Math.pow(2,p);s.prototype.F1=p-aT;s.prototype.F2=2*aT-p;var r="0123456789abcdefghijklmnopqrstuvwxyz";var q=new Array();var bi,bj;bi="0".charCodeAt(0);for(bj=0;bj<=9;++bj){q[bi++]=bj}bi="a".charCodeAt(0);for(bj=10;bj<36;++bj){q[bi++]=bj}bi="A".charCodeAt(0);for(bj=10;bj<36;++bj){q[bi++]=bj}function aV(bk){return r.charAt(bk)}function aW(bm,bl){var bk=q[bm.charCodeAt(bl)];return(bk==null)?-1:bk}function ab(bl){for(var bk=this.t-1;bk>=0;--bk){bl.data[bk]=this.data[bk]}bl.t=this.t;bl.s=this.s}function ai(bk){this.t=1;this.s=(bk<0)?-1:0;if(bk>0){this.data[0]=bk}else{if(bk<-1){this.data[0]=bk+this.DV}else{this.t=0}}}function a9(bk){var bl=a7();bl.fromInt(bk);return bl}function al(bo,bk){var bm;if(bk==16){bm=4}else{if(bk==8){bm=3}else{if(bk==256){bm=8}else{if(bk==2){bm=1}else{if(bk==32){bm=5}else{if(bk==4){bm=2}else{this.fromRadix(bo,bk);return}}}}}}this.t=0;this.s=0;var bl=bo.length,bn=false,bp=0;while(--bl>=0){var bq=(bm==8)?bo[bl]&255:aW(bo,bl);if(bq<0){if(bo.charAt(bl)=="-"){bn=true}continue}bn=false;if(bp==0){this.data[this.t++]=bq}else{if(bp+bm>this.DB){this.data[this.t-1]|=(bq&((1<<(this.DB-bp))-1))<<bp;this.data[this.t++]=(bq>>(this.DB-bp))}else{this.data[this.t-1]|=bq<<bp}}bp+=bm;if(bp>=this.DB){bp-=this.DB}}if(bm==8&&(bo[0]&128)!=0){this.s=-1;if(bp>0){this.data[this.t-1]|=((1<<(this.DB-bp))-1)<<bp}}this.clamp();if(bn){s.ZERO.subTo(this,this)}}function aa(){var bk=this.s&this.DM;while(this.t>0&&this.data[this.t-1]==bk){--this.t}}function aJ(bk){if(this.s<0){return"-"+this.negate().toString(bk)}var bn;if(bk==16){bn=4}else{if(bk==8){bn=3}else{if(bk==2){bn=1}else{if(bk==32){bn=5}else{if(bk==4){bn=2}else{return this.toRadix(bk)}}}}}var bo=(1<<bn)-1,bl,bp=false,br="",bm=this.t;var bq=this.DB-(bm*this.DB)%bn;if(bm-->0){if(bq<this.DB&&(bl=this.data[bm]>>bq)>0){bp=true;br=aV(bl)}while(bm>=0){if(bq<bn){bl=(this.data[bm]&((1<<bq)-1))<<(bn-bq);bl|=this.data[--bm]>>(bq+=this.DB-bn)}else{bl=(this.data[bm]>>(bq-=bn))&bo;if(bq<=0){bq+=this.DB;--bm}}if(bl>0){bp=true}if(bp){br+=aV(bl)}}}return bp?br:"0"}function T(){var bk=a7();s.ZERO.subTo(this,bk);return bk}function t(){return(this.s<0)?this.negate():this}function C(bk){var bm=this.s-bk.s;if(bm!=0){return bm}var bl=this.t;bm=bl-bk.t;if(bm!=0){return(this.s<0)?-bm:bm}while(--bl>=0){if((bm=this.data[bl]-bk.data[bl])!=0){return bm}}return 0}function a8(bm){var bk=1,bl;if((bl=bm>>>16)!=0){bm=bl;bk+=16}if((bl=bm>>8)!=0){bm=bl;bk+=8}if((bl=bm>>4)!=0){bm=bl;bk+=4}if((bl=bm>>2)!=0){bm=bl;bk+=2}if((bl=bm>>1)!=0){bm=bl;bk+=1}return bk}function y(){if(this.t<=0){return 0}return this.DB*(this.t-1)+a8(this.data[this.t-1]^(this.s&this.DM))}function ae(bl,bm){var bk;for(bk=this.t-1;bk>=0;--bk){bm.data[bk+bl]=this.data[bk]}for(bk=bl-1;bk>=0;--bk){bm.data[bk]=0}bm.t=this.t+bl;bm.s=this.s}function ag(bl,bm){for(var bk=bl;bk<this.t;++bk){bm.data[bk-bl]=this.data[bk]}bm.t=Math.max(this.t-bl,0);bm.s=this.s}function ao(br,bt){var bl=br%this.DB;var bo=this.DB-bl;var bk=(1<<bo)-1;var bp=Math.floor(br/this.DB),bn=(this.s<<bl)&this.DM,bq;for(bq=this.t-1;bq>=0;--bq){bt.data[bq+bp+1]=(this.data[bq]>>bo)|bn;bn=(this.data[bq]&bk)<<bl}for(bq=bp-1;bq>=0;--bq){bt.data[bq]=0}bt.data[bp]=bn;bt.t=this.t+bp+1;bt.s=this.s;bt.clamp()}function aw(bq,br){br.s=this.s;var bo=Math.floor(bq/this.DB);if(bo>=this.t){br.t=0;return}var bl=bq%this.DB;var bn=this.DB-bl;var bk=(1<<bl)-1;br.data[0]=this.data[bo]>>bl;for(var bp=bo+1;bp<this.t;++bp){br.data[bp-bo-1]|=(this.data[bp]&bk)<<bn;br.data[bp-bo]=this.data[bp]>>bl}if(bl>0){br.data[this.t-bo-1]|=(this.s&bk)<<bn}br.t=this.t-bo;br.clamp()}function ay(bk,bo){var bm=0,bl=0,bn=Math.min(bk.t,this.t);while(bm<bn){bl+=this.data[bm]-bk.data[bm];bo.data[bm++]=bl&this.DM;bl>>=this.DB}if(bk.t<this.t){bl-=bk.s;while(bm<this.t){bl+=this.data[bm];bo.data[bm++]=bl&this.DM;bl>>=this.DB}bl+=this.s}else{bl+=this.s;while(bm<bk.t){bl-=bk.data[bm];bo.data[bm++]=bl&this.DM;bl>>=this.DB}bl-=bk.s}bo.s=(bl<0)?-1:0;if(bl<-1){bo.data[bm++]=this.DV+bl}else{if(bl>0){bo.data[bm++]=bl}}bo.t=bm;bo.clamp()}function at(bk,bm){var bn=this.abs(),bo=bk.abs();var bl=bn.t;bm.t=bl+bo.t;while(--bl>=0){bm.data[bl]=0}for(bl=0;bl<bo.t;++bl){bm.data[bl+bn.t]=bn.am(0,bo.data[bl],bm,bl,0,bn.t)}bm.s=0;bm.clamp();if(this.s!=bk.s){s.ZERO.subTo(bm,bm)}}function ax(bm){var bn=this.abs();var bl=bm.t=2*bn.t;while(--bl>=0){bm.data[bl]=0}for(bl=0;bl<bn.t-1;++bl){var bk=bn.am(bl,bn.data[bl],bm,2*bl,0,1);if((bm.data[bl+bn.t]+=bn.am(bl+1,2*bn.data[bl],bm,2*bl+1,bk,bn.t-bl-1))>=bn.DV){bm.data[bl+bn.t]-=bn.DV;bm.data[bl+bn.t+1]=1}}if(bm.t>0){bm.data[bm.t-1]+=bn.am(bl,bn.data[bl],bm,2*bl,0,1)}bm.s=0;bm.clamp()}function ad(bp,bu,bw){var bs=bp.abs();if(bs.t<=0){return}var bt=this.abs();if(bt.t<bs.t){if(bu!=null){bu.fromInt(0)}if(bw!=null){this.copyTo(bw)}return}if(bw==null){bw=a7()}var bz=a7(),by=this.s,bq=bp.s;var br=this.DB-a8(bs.data[bs.t-1]);if(br>0){bs.lShiftTo(br,bz);bt.lShiftTo(br,bw)}else{bs.copyTo(bz);bt.copyTo(bw)}var bB=bz.t;var bA=bz.data[bB-1];if(bA==0){return}var bC=bA*(1<<this.F1)+((bB>1)?bz.data[bB-2]>>this.F2:0);var bk=this.FV/bC,bl=(1<<this.F1)/bC,bm=1<<this.F2;var bn=bw.t,bo=bn-bB,bx=(bu==null)?a7():bu;bz.dlShiftTo(bo,bx);if(bw.compareTo(bx)>=0){bw.data[bw.t++]=1;bw.subTo(bx,bw)}s.ONE.dlShiftTo(bB,bx);bx.subTo(bz,bz);while(bz.t<bB){bz.data[bz.t++]=0}while(--bo>=0){var bv=(bw.data[--bn]==bA)?this.DM:Math.floor(bw.data[bn]*bk+(bw.data[bn-1]+bm)*bl);if((bw.data[bn]+=bz.am(0,bv,bw,bo,0,bB))<bv){bz.dlShiftTo(bo,bx);bw.subTo(bx,bw);while(bw.data[bn]<--bv){bw.subTo(bx,bw)}}}if(bu!=null){bw.drShiftTo(bB,bu);if(by!=bq){s.ZERO.subTo(bu,bu)}}bw.t=bB;bw.clamp();if(br>0){bw.rShiftTo(br,bw)}if(by<0){s.ZERO.subTo(bw,bw)}}function O(bk){var bl=a7();this.abs().divRemTo(bk,null,bl);if(this.s<0&&bl.compareTo(s.ZERO)>0){bk.subTo(bl,bl)}return bl}function aO(bk){this.m=bk}function aN(bk){if(bk.s<0||bk.compareTo(this.m)>=0){return bk.mod(this.m)}else{return bk}}function aR(bk){return bk}function aQ(bk){bk.divRemTo(this.m,null,bk)}function aP(bl,bm,bk){bl.multiplyTo(bm,bk);this.reduce(bk)}function aS(bl,bk){bl.squareTo(bk);this.reduce(bk)}aO.prototype.convert=aN;aO.prototype.revert=aR;aO.prototype.reduce=aQ;aO.prototype.mulTo=aP;aO.prototype.sqrTo=aS;function am(){if(this.t<1){return 0}var bk=this.data[0];if((bk&1)==0){return 0}var bl=bk&3;bl=(bl*(2-(bk&15)*bl))&15;bl=(bl*(2-(bk&255)*bl))&255;bl=(bl*(2-(((bk&65535)*bl)&65535)))&65535;bl=(bl*(2-bk*bl%this.DV))%this.DV;return(bl>0)?this.DV-bl:-bl}function a2(bk){this.m=bk;this.mp=bk.invDigit();this.mpl=this.mp&32767;this.mph=this.mp>>15;this.um=(1<<(bk.DB-15))-1;this.mt2=2*bk.t}function a1(bl){var bk=a7();bl.abs().dlShiftTo(this.m.t,bk);bk.divRemTo(this.m,null,bk);if(bl.s<0&&bk.compareTo(s.ZERO)>0){this.m.subTo(bk,bk)}return bk}function a5(bl){var bk=a7();bl.copyTo(bk);this.reduce(bk);return bk}function a4(bn){while(bn.t<=this.mt2){bn.data[bn.t++]=0}for(var bk=0;bk<this.m.t;++bk){var bl=bn.data[bk]&32767;var bm=(bl*this.mpl+(((bl*this.mph+(bn.data[bk]>>15)*this.mpl)&this.um)<<15))&bn.DM;bl=bk+this.m.t;bn.data[bl]+=this.m.am(0,bm,bn,bk,0,this.m.t);while(bn.data[bl]>=bn.DV){bn.data[bl]-=bn.DV;bn.data[++bl]++}}bn.clamp();bn.drShiftTo(this.m.t,bn);if(bn.compareTo(this.m)>=0){bn.subTo(this.m,bn)}}function a6(bl,bk){bl.squareTo(bk);this.reduce(bk)}function a3(bl,bm,bk){bl.multiplyTo(bm,bk);this.reduce(bk)}a2.prototype.convert=a1;a2.prototype.revert=a5;a2.prototype.reduce=a4;a2.prototype.mulTo=a3;a2.prototype.sqrTo=a6;function an(){return((this.t>0)?(this.data[0]&1):this.s)==0}function ah(bk,bq){if(bk>4294967295||bk<1){return s.ONE}var bn=a7(),bo=a7(),bl=bq.convert(this),bm=a8(bk)-1;bl.copyTo(bn);while(--bm>=0){bq.sqrTo(bn,bo);if((bk&(1<<bm))>0){bq.mulTo(bo,bl,bn)}else{var bp=bn;bn=bo;bo=bp}}return bq.revert(bn)}function R(bk,bl){var bm;if(bk<256||bl.isEven()){bm=new aO(bl)}else{bm=new a2(bl)}return this.exp(bk,bm)}s.prototype.copyTo=ab;s.prototype.fromInt=ai;s.prototype.fromString=al;s.prototype.clamp=aa;s.prototype.dlShiftTo=ae;s.prototype.drShiftTo=ag;s.prototype.lShiftTo=ao;s.prototype.rShiftTo=aw;s.prototype.subTo=ay;s.prototype.multiplyTo=at;s.prototype.squareTo=ax;s.prototype.divRemTo=ad;s.prototype.invDigit=am;s.prototype.isEven=an;s.prototype.exp=ah;s.prototype.toString=aJ;s.prototype.negate=T;s.prototype.abs=t;s.prototype.compareTo=C;s.prototype.bitLength=y;s.prototype.mod=O;s.prototype.modPowInt=R;s.ZERO=a9(0);s.ONE=a9(1);function B(){var bk=a7();this.copyTo(bk);return bk}function K(){if(this.s<0){if(this.t==1){return this.data[0]-this.DV}else{if(this.t==0){return -1}}}else{if(this.t==1){return this.data[0]}else{if(this.t==0){return 0}}}return((this.data[1]&((1<<(32-this.DB))-1))<<this.DB)|this.data[0]}function z(){return(this.t==0)?this.s:(this.data[0]<<24)>>24}function aE(){return(this.t==0)?this.s:(this.data[0]<<16)>>16}function Z(bk){return Math.floor(Math.LN2*this.DB/Math.log(bk))}function aF(){if(this.s<0){return -1}else{if(this.t<=0||(this.t==1&&this.data[0]<=0)){return 0}else{return 1}}}function az(bl){if(bl==null){bl=10}if(this.signum()==0||bl<2||bl>36){return"0"}var bm=this.chunkSize(bl);var bk=Math.pow(bl,bm);var bn=a9(bk),bp=a7(),bq=a7(),bo="";this.divRemTo(bn,bp,bq);while(bp.signum()>0){bo=(bk+bq.intValue()).toString(bl).substr(1)+bo;bp.divRemTo(bn,bp,bq)}return bq.intValue().toString(bl)+bo}function ak(bq,bk){this.fromInt(0);if(bk==null){bk=10}var bl=this.chunkSize(bk);var bm=Math.pow(bk,bl),bp=false,bo=0,br=0;for(var bn=0;bn<bq.length;++bn){var bs=aW(bq,bn);if(bs<0){if(bq.charAt(bn)=="-"&&this.signum()==0){bp=true}continue}br=bk*br+bs;if(++bo>=bl){this.dMultiply(bm);this.dAddOffset(br,0);bo=0;br=0}}if(bo>0){this.dMultiply(Math.pow(bk,bo));this.dAddOffset(br,0)}if(bp){s.ZERO.subTo(this,this)}}function aj(bk,bl,bm){if("number"==typeof bl){if(bk<2){this.fromInt(1)}else{this.fromNumber(bk,bm);if(!this.testBit(bk-1)){this.bitwiseTo(s.ONE.shiftLeft(bk-1),bg,this)}if(this.isEven()){this.dAddOffset(1,0)}while(!this.isProbablePrime(bl)){this.dAddOffset(2,0);if(this.bitLength()>bk){this.subTo(s.ONE.shiftLeft(bk-1),this)}}}}else{var bo=new Array(),bn=bk&7;bo.length=(bk>>3)+1;bl.nextBytes(bo);if(bn>0){bo[0]&=((1<<bn)-1)}else{bo[0]=0}this.fromString(bo,256)}}function aI(){var bl=this.t,bo=new Array();bo[0]=this.s;var bn=this.DB-(bl*this.DB)%8,bk,bm=0;if(bl-->0){if(bn<this.DB&&(bk=this.data[bl]>>bn)!=(this.s&this.DM)>>bn){bo[bm++]=bk|(this.s<<(this.DB-bn))}while(bl>=0){if(bn<8){bk=(this.data[bl]&((1<<bn)-1))<<(8-bn);bk|=this.data[--bl]>>(bn+=this.DB-8)}else{bk=(this.data[bl]>>(bn-=8))&255;if(bn<=0){bn+=this.DB;--bl}}if((bk&128)!=0){bk|=-256}if(bm==0&&(this.s&128)!=(bk&128)){++bm}if(bm>0||bk!=this.s){bo[bm++]=bk}}}return bo}function F(bk){return(this.compareTo(bk)==0)}function N(bk){return(this.compareTo(bk)<0)?this:bk}function M(bk){return(this.compareTo(bk)>0)?this:bk}function X(bk,bo,bp){var bm,bl,bn=Math.min(bk.t,this.t);for(bm=0;bm<bn;++bm){bp.data[bm]=bo(this.data[bm],bk.data[bm])}if(bk.t<this.t){bl=bk.s&this.DM;for(bm=bn;bm<this.t;++bm){bp.data[bm]=bo(this.data[bm],bl)}bp.t=this.t}else{bl=this.s&this.DM;for(bm=bn;bm<bk.t;++bm){bp.data[bm]=bo(bl,bk.data[bm])}bp.t=bk.t}bp.s=bo(this.s,bk.s);bp.clamp()}function be(bk,bl){return bk&bl}function v(bk){var bl=a7();this.bitwiseTo(bk,be,bl);return bl}function bg(bk,bl){return bk|bl}function V(bk){var bl=a7();this.bitwiseTo(bk,bg,bl);return bl}function bh(bk,bl){return bk^bl}function aK(bk){var bl=a7();this.bitwiseTo(bk,bh,bl);return bl}function bf(bk,bl){return bk&~bl}function w(bk){var bl=a7();this.bitwiseTo(bk,bf,bl);return bl}function U(){var bl=a7();for(var bk=0;bk<this.t;++bk){bl.data[bk]=this.DM&~this.data[bk]}bl.t=this.t;bl.s=~this.s;return bl}function aC(bk){var bl=a7();if(bk<0){this.rShiftTo(-bk,bl)}else{this.lShiftTo(bk,bl)}return bl}function aD(bk){var bl=a7();if(bk<0){this.lShiftTo(-bk,bl)}else{this.rShiftTo(bk,bl)}return bl}function aY(bl){if(bl==0){return -1}var bk=0;if((bl&65535)==0){bl>>=16;bk+=16}if((bl&255)==0){bl>>=8;bk+=8}if((bl&15)==0){bl>>=4;bk+=4}if((bl&3)==0){bl>>=2;bk+=2}if((bl&1)==0){++bk}return bk}function I(){for(var bk=0;bk<this.t;++bk){if(this.data[bk]!=0){return bk*this.DB+aY(this.data[bk])}}if(this.s<0){return this.t*this.DB}return -1}function aM(bl){var bk=0;while(bl!=0){bl&=bl-1;++bk}return bk}function x(){var bl=0,bm=this.s&this.DM;for(var bk=0;bk<this.t;++bk){bl+=aM(this.data[bk]^bm)}return bl}function aH(bl){var bk=Math.floor(bl/this.DB);if(bk>=this.t){return(this.s!=0)}return((this.data[bk]&(1<<(bl%this.DB)))!=0)}function Y(bk,bl){var bm=s.ONE.shiftLeft(bk);this.bitwiseTo(bm,bl,bm);return bm}function aB(bk){return this.changeBit(bk,bg)}function A(bk){return this.changeBit(bk,bf)}function G(bk){return this.changeBit(bk,bh)}function W(bk,bo){var bm=0,bl=0,bn=Math.min(bk.t,this.t);while(bm<bn){bl+=this.data[bm]+bk.data[bm];bo.data[bm++]=bl&this.DM;bl>>=this.DB}if(bk.t<this.t){bl+=bk.s;while(bm<this.t){bl+=this.data[bm];bo.data[bm++]=bl&this.DM;bl>>=this.DB}bl+=this.s}else{bl+=this.s;while(bm<bk.t){bl+=bk.data[bm];bo.data[bm++]=bl&this.DM;bl>>=this.DB}bl+=bk.s}bo.s=(bl<0)?-1:0;if(bl>0){bo.data[bm++]=bl}else{if(bl<-1){bo.data[bm++]=this.DV+bl}}bo.t=bm;bo.clamp()}function u(bk){var bl=a7();this.addTo(bk,bl);return bl}function aG(bk){var bl=a7();this.subTo(bk,bl);return bl}function S(bk){var bl=a7();this.multiplyTo(bk,bl);return bl}function D(bk){var bl=a7();this.divRemTo(bk,bl,null);return bl}function aA(bk){var bl=a7();this.divRemTo(bk,null,bl);return bl}function E(bk){var bl=a7(),bm=a7();this.divRemTo(bk,bl,bm);return new Array(bl,bm)}function af(bk){this.data[this.t]=this.am(0,bk-1,this,0,0,this.t);++this.t;this.clamp()}function ac(bk,bl){if(bk==0){return}while(this.t<=bl){this.data[this.t++]=0}this.data[bl]+=bk;while(this.data[bl]>=this.DV){this.data[bl]-=this.DV;if(++bl>=this.t){this.data[this.t++]=0}++this.data[bl]}}function bd(){}function bb(bk){return bk}function ba(bl,bm,bk){bl.multiplyTo(bm,bk)}function bc(bl,bk){bl.squareTo(bk)}bd.prototype.convert=bb;bd.prototype.revert=bb;bd.prototype.mulTo=ba;bd.prototype.sqrTo=bc;function av(bk){return this.exp(bk,new bd())}function ar(bk,bn,bo){var bl=Math.min(this.t+bk.t,bn);bo.s=0;bo.t=bl;while(bl>0){bo.data[--bl]=0}var bm;for(bm=bo.t-this.t;bl<bm;++bl){bo.data[bl+this.t]=this.am(0,bk.data[bl],bo,bl,0,this.t)}for(bm=Math.min(bk.t,bn);bl<bm;++bl){this.am(0,bk.data[bl],bo,bl,0,bn-bl)}bo.clamp()}function au(bk,bm,bn){--bm;var bl=bn.t=this.t+bk.t-bm;bn.s=0;while(--bl>=0){bn.data[bl]=0}for(bl=Math.max(bm-this.t,0);bl<bk.t;++bl){bn.data[this.t+bl-bm]=this.am(bm-bl,bk.data[bl],bn,0,0,this.t+bl-bm)}bn.clamp();bn.drShiftTo(1,bn)}function j(bk){this.r2=a7();this.q3=a7();s.ONE.dlShiftTo(2*bk.t,this.r2);this.mu=this.r2.divide(bk);this.m=bk}function k(bl){if(bl.s<0||bl.t>2*this.m.t){return bl.mod(this.m)}else{if(bl.compareTo(this.m)<0){return bl}else{var bk=a7();bl.copyTo(bk);this.reduce(bk);return bk}}}function n(bk){return bk}function m(bk){bk.drShiftTo(this.m.t-1,this.r2);if(bk.t>this.m.t+1){bk.t=this.m.t+1;bk.clamp()}this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3);this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);while(bk.compareTo(this.r2)<0){bk.dAddOffset(1,this.m.t+1)}bk.subTo(this.r2,bk);while(bk.compareTo(this.m)>=0){bk.subTo(this.m,bk)}}function o(bl,bk){bl.squareTo(bk);this.reduce(bk)}function l(bl,bm,bk){bl.multiplyTo(bm,bk);this.reduce(bk)}j.prototype.convert=k;j.prototype.revert=n;j.prototype.reduce=m;j.prototype.mulTo=l;j.prototype.sqrTo=o;function Q(bk,bt){var bn=bk.bitLength(),bq,bv=a9(1),bz;if(bn<=0){return bv}else{if(bn<18){bq=1}else{if(bn<48){bq=3}else{if(bn<144){bq=4}else{if(bn<768){bq=5}else{bq=6}}}}}if(bn<8){bz=new aO(bt)}else{if(bt.isEven()){bz=new j(bt)}else{bz=new a2(bt)}}var bl=new Array(),bu=3,br=bq-1,bs=(1<<bq)-1;bl[1]=bz.convert(this);if(bq>1){var bm=a7();bz.sqrTo(bl[1],bm);while(bu<=bs){bl[bu]=a7();bz.mulTo(bm,bl[bu-2],bl[bu]);bu+=2}}var bp=bk.t-1,by,bo=true,bw=a7(),bx;bn=a8(bk.data[bp])-1;while(bp>=0){if(bn>=br){by=(bk.data[bp]>>(bn-br))&bs}else{by=(bk.data[bp]&((1<<(bn+1))-1))<<(br-bn);if(bp>0){by|=bk.data[bp-1]>>(this.DB+bn-br)}}bu=bq;while((by&1)==0){by>>=1;--bu}if((bn-=bu)<0){bn+=this.DB;--bp}if(bo){bl[by].copyTo(bv);bo=false}else{while(bu>1){bz.sqrTo(bv,bw);bz.sqrTo(bw,bv);bu-=2}if(bu>0){bz.sqrTo(bv,bw)}else{bx=bv;bv=bw;bw=bx}bz.mulTo(bw,bl[by],bv)}while(bp>=0&&(bk.data[bp]&(1<<bn))==0){bz.sqrTo(bv,bw);bx=bv;bv=bw;bw=bx;if(--bn<0){bn=this.DB-1;--bp}}}return bz.revert(bv)}function H(bk){var bo=(this.s<0)?this.negate():this.clone();var bp=(bk.s<0)?bk.negate():bk.clone();if(bo.compareTo(bp)<0){var bn=bo;bo=bp;bp=bn}var bm=bo.getLowestSetBit(),bl=bp.getLowestSetBit();if(bl<0){return bo}if(bm<bl){bl=bm}if(bl>0){bo.rShiftTo(bl,bo);bp.rShiftTo(bl,bp)}while(bo.signum()>0){if((bm=bo.getLowestSetBit())>0){bo.rShiftTo(bm,bo)}if((bm=bp.getLowestSetBit())>0){bp.rShiftTo(bm,bp)}if(bo.compareTo(bp)>=0){bo.subTo(bp,bo);bo.rShiftTo(1,bo)}else{bp.subTo(bo,bp);bp.rShiftTo(1,bp)}}if(bl>0){bp.lShiftTo(bl,bp)}return bp}function aq(bm){if(bm<=0){return 0}var bk=this.DV%bm,bn=(this.s<0)?bm-1:0;if(this.t>0){if(bk==0){bn=this.data[0]%bm}else{for(var bl=this.t-1;bl>=0;--bl){bn=(bk*bn+this.data[bl])%bm}}}return bn}function P(bp){var bl=bp.isEven();if((this.isEven()&&bl)||bp.signum()==0){return s.ZERO}var bq=bp.clone(),br=this.clone();var bk=a9(1),bm=a9(0),bn=a9(0),bo=a9(1);while(bq.signum()!=0){while(bq.isEven()){bq.rShiftTo(1,bq);if(bl){if(!bk.isEven()||!bm.isEven()){bk.addTo(this,bk);bm.subTo(bp,bm)}bk.rShiftTo(1,bk)}else{if(!bm.isEven()){bm.subTo(bp,bm)}}bm.rShiftTo(1,bm)}while(br.isEven()){br.rShiftTo(1,br);if(bl){if(!bn.isEven()||!bo.isEven()){bn.addTo(this,bn);bo.subTo(bp,bo)}bn.rShiftTo(1,bn)}else{if(!bo.isEven()){bo.subTo(bp,bo)}}bo.rShiftTo(1,bo)}if(bq.compareTo(br)>=0){bq.subTo(br,bq);if(bl){bk.subTo(bn,bk)}bm.subTo(bo,bm)}else{br.subTo(bq,br);if(bl){bn.subTo(bk,bn)}bo.subTo(bm,bo)}}if(br.compareTo(s.ONE)!=0){return s.ZERO}if(bo.compareTo(bp)>=0){return bo.subtract(bp)}if(bo.signum()<0){bo.addTo(bp,bo)}else{return bo}if(bo.signum()<0){return bo.add(bp)}else{return bo}}var aZ=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509];var a0=(1<<26)/aZ[aZ.length-1];function L(bn){var bk,bo=this.abs();if(bo.t==1&&bo.data[0]<=aZ[aZ.length-1]){for(bk=0;bk<aZ.length;++bk){if(bo.data[0]==aZ[bk]){return true}}return false}if(bo.isEven()){return false}bk=1;while(bk<aZ.length){var bm=aZ[bk],bl=bk+1;while(bl<aZ.length&&bm<a0){bm*=aZ[bl++]}bm=bo.modInt(bm);while(bk<bl){if(bm%aZ[bk++]==0){return false}}}return bo.millerRabin(bn)}function ap(br){var bo=this.subtract(s.ONE);var bn=bo.getLowestSetBit();if(bn<=0){return false}var bq=bo.shiftRight(bn);var bp=J();var bk;for(var bl=0;bl<br;++bl){do{bk=new s(this.bitLength(),bp)}while(bk.compareTo(s.ONE)<=0||bk.compareTo(bo)>=0);var bs=bk.modPow(bq,this);if(bs.compareTo(s.ONE)!=0&&bs.compareTo(bo)!=0){var bm=1;while(bm++<bn&&bs.compareTo(bo)!=0){bs=bs.modPowInt(2,this);if(bs.compareTo(s.ONE)==0){return false}}if(bs.compareTo(bo)!=0){return false}}}return true}function J(){return{nextBytes:function(bl){for(var bk=0;bk<bl.length;++bk){bl[bk]=Math.floor(Math.random()*255)}}}}s.prototype.chunkSize=Z;s.prototype.toRadix=az;s.prototype.fromRadix=ak;s.prototype.fromNumber=aj;s.prototype.bitwiseTo=X;s.prototype.changeBit=Y;s.prototype.addTo=W;s.prototype.dMultiply=af;s.prototype.dAddOffset=ac;s.prototype.multiplyLowerTo=ar;s.prototype.multiplyUpperTo=au;s.prototype.modInt=aq;s.prototype.millerRabin=ap;s.prototype.clone=B;s.prototype.intValue=K;s.prototype.byteValue=z;s.prototype.shortValue=aE;s.prototype.signum=aF;s.prototype.toByteArray=aI;s.prototype.equals=F;s.prototype.min=N;s.prototype.max=M;s.prototype.and=v;s.prototype.or=V;s.prototype.xor=aK;s.prototype.andNot=w;s.prototype.not=U;s.prototype.shiftLeft=aC;s.prototype.shiftRight=aD;s.prototype.getLowestSetBit=I;s.prototype.bitCount=x;s.prototype.testBit=aH;s.prototype.setBit=aB;s.prototype.clearBit=A;s.prototype.flipBit=G;s.prototype.add=u;s.prototype.subtract=aG;s.prototype.multiply=S;s.prototype.divide=D;s.prototype.remainder=aA;s.prototype.divideAndRemainder=E;s.prototype.modPow=Q;s.prototype.modInverse=P;s.prototype.pow=av;s.prototype.gcd=H;s.prototype.isProbablePrime=L;aU.jsbn=aU.jsbn||{};aU.jsbn.BigInteger=s}var d="jsbn";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var e=true;define=function(h,g){g(require,module)}}else{if(typeof forge==="undefined"){forge={}}return c(forge)}}var b;var a=function(h,g){g.exports=function(j){var l=b.map(function(i){return h(i)}).concat(c);j=j||{};j.defined=j.defined||{};if(j.defined[d]){return j[d]}j.defined[d]=true;for(var k=0;k<l.length;++k){l[k](j)}return j[d]}};var f=define;define=function(h,g){b=(typeof h==="string")?g.slice(2):h.slice(2);if(e){delete define;return f.apply(null,Array.prototype.slice.call(arguments,0))}define=f;return define.apply(null,Array.prototype.slice.call(arguments,0))};define(["require","module"],function(){a.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function c(i){var g=(typeof process!=="undefined"&&process.versions&&process.versions.node);var h=null;if(!i.disableNativeCode&&g){h=require("crypto")}var j=i.prng=i.prng||{};j.create=function(r){var n={plugin:r,key:null,seed:null,time:null,reseeds:0,generated:0};var q=r.md;var s=new Array(32);for(var p=0;p<32;++p){s[p]=q.create()}n.pools=s;n.pool=0;n.generate=function(w,u){if(!u){return n.generateSync(w)}var v=n.plugin.cipher;var A=n.plugin.increment;var x=n.plugin.formatKey;var y=n.plugin.formatSeed;var t=i.util.createBuffer();z();function z(C){if(C){return u(C)}if(t.length()>=w){return u(null,t.getBytes(w))}if(n.generated>=1048576){var D=+new Date();if(n.time===null||(D-n.time>100)){n.key=null}}if(n.key===null){return k(z)}var B=v(n.key,n.seed);n.generated+=B.length;t.putBytes(B);n.key=x(v(n.key,A(n.seed)));n.seed=y(v(n.key,n.seed));i.util.setImmediate(z)}};n.generateSync=function(w){var v=n.plugin.cipher;var z=n.plugin.increment;var x=n.plugin.formatKey;var y=n.plugin.formatSeed;var t=i.util.createBuffer();while(t.length()<w){if(n.generated>=1048576){var A=+new Date();if(n.time===null||(A-n.time>100)){n.key=null}}if(n.key===null){l()}var u=v(n.key,n.seed);n.generated+=u.length;t.putBytes(u);n.key=x(v(n.key,z(n.seed)));n.seed=y(v(n.key,n.seed))}return t.getBytes(w)};function k(t){if(n.pools[0].messageLength>=32){m();return t()}var u=(32-n.pools[0].messageLength)<<5;n.seedFile(u,function(w,v){if(w){return t(w)}n.collect(v);m();t()})}function l(){if(n.pools[0].messageLength>=32){return m()}var t=(32-n.pools[0].messageLength)<<5;n.collect(n.seedFileSync(t));m()}function m(){var w=i.md.sha1.create();w.update(n.pools[0].digest().getBytes());n.pools[0].start();var u=1;for(var t=1;t<32;++t){u=(u===31)?2147483648:(u<<2);if(u%n.reseeds===0){w.update(n.pools[t].digest().getBytes());n.pools[t].start()}}var v=w.digest().getBytes();w.start();w.update(v);var x=w.digest().getBytes();n.key=n.plugin.formatKey(v);n.seed=n.plugin.formatSeed(x);++n.reseeds;n.generated=0;n.time=+new Date()}function o(C){var y=null;if(typeof window!=="undefined"){var v=window.crypto||window.msCrypto;if(v&&v.getRandomValues){y=function(F){return v.getRandomValues(F)}}}var t=i.util.createBuffer();if(y){while(t.length()<C){var u=Math.max(1,Math.min(C-t.length(),65536)/4);var x=new Uint32Array(Math.floor(u));try{y(x);for(var A=0;A<x.length;++A){t.putInt32(x[A])}}catch(w){if(!(typeof QuotaExceededError!=="undefined"&&w instanceof QuotaExceededError)){throw w}}}}if(t.length()<C){var z,B,D;var E=Math.floor(Math.random()*65536);while(t.length()<C){B=16807*(E&65535);z=16807*(E>>16);B+=(z&32767)<<16;B+=z>>15;B=(B&2147483647)+(B>>31);E=B&4294967295;for(var A=0;A<3;++A){D=E>>>(A<<3);D^=Math.floor(Math.random()*256);t.putByte(String.fromCharCode(D&255))}}}return t.getBytes(C)}if(h){n.seedFile=function(u,t){h.randomBytes(u,function(w,v){if(w){return t(w)}t(null,v.toString())})};n.seedFileSync=function(t){return h.randomBytes(t).toString()}}else{n.seedFile=function(v,t){try{t(null,o(v))}catch(u){t(u)}};n.seedFileSync=o}n.collect=function(t){var u=t.length;for(var v=0;v<u;++v){n.pools[n.pool].update(t.substr(v,1));n.pool=(n.pool===31)?0:n.pool+1}};n.collectInt=function(u,v){var t="";for(var w=0;w<v;w+=8){t+=String.fromCharCode((u>>w)&255)}n.collect(t)};n.registerWorker=function(u){if(u===self){n.seedFile=function(x,v){function w(z){var y=z.data;if(y.forge&&y.forge.prng){self.removeEventListener("message",w);v(y.forge.prng.err,y.forge.prng.bytes)}}self.addEventListener("message",w);self.postMessage({forge:{prng:{needed:x}}})}}else{function t(w){var v=w.data;if(v.forge&&v.forge.prng){n.seedFile(v.forge.prng.needed,function(y,x){u.postMessage({forge:{prng:{err:y,bytes:x}}})})}}u.addEventListener("message",t)}};return n}}var d="prng";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var e=true;define=function(h,g){g(require,module)}}else{if(typeof forge==="undefined"){forge={}}return c(forge)}}var b;var a=function(h,g){g.exports=function(j){var l=b.map(function(i){return h(i)}).concat(c);j=j||{};j.defined=j.defined||{};if(j.defined[d]){return j[d]}j.defined[d]=true;for(var k=0;k<l.length;++k){l[k](j)}return j[d]}};var f=define;define=function(h,g){b=(typeof h==="string")?g.slice(2):h.slice(2);if(e){delete define;return f.apply(null,Array.prototype.slice.call(arguments,0))}define=f;return define.apply(null,Array.prototype.slice.call(arguments,0))};define(["require","module","./md","./util"],function(){a.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function c(g){if(g.random&&g.random.getBytes){return}(function(p){var r={};var l=new Array(4);var k=g.util.createBuffer();r.formatKey=function(s){var t=g.util.createBuffer(s);s=new Array(4);s[0]=t.getInt32();s[1]=t.getInt32();s[2]=t.getInt32();s[3]=t.getInt32();return g.aes._expandKey(s,false)};r.formatSeed=function(s){var t=g.util.createBuffer(s);s=new Array(4);s[0]=t.getInt32();s[1]=t.getInt32();s[2]=t.getInt32();s[3]=t.getInt32();return s};r.cipher=function(s,t){g.aes._updateBlock(s,t,l,false);k.putInt32(l[0]);k.putInt32(l[1]);k.putInt32(l[2]);k.putInt32(l[3]);return k.getBytes()};r.increment=function(s){++s[3];return s};r.md=g.md.sha1;var h=g.prng.create(r);var j=(typeof process!=="undefined"&&process.versions&&process.versions.node);var o=null;if(typeof window!=="undefined"){var m=window.crypto||window.msCrypto;if(m&&m.getRandomValues){o=function(s){return m.getRandomValues(s)}}}if(g.disableNativeCode||(!j&&!o)){if(typeof window==="undefined"||window.document===undefined){}h.collectInt(+new Date(),32);if(typeof(navigator)!=="undefined"){var i="";for(var q in navigator){try{if(typeof(navigator[q])=="string"){i+=navigator[q]}}catch(n){}}h.collect(i);i=null}if(p){p().mousemove(function(s){h.collectInt(s.clientX,16);h.collectInt(s.clientY,16)});p().keypress(function(s){h.collectInt(s.charCode,8)})}}if(!g.random){g.random=h}else{for(var q in h){g.random[q]=h[q]}}g.random.getBytes=function(t,s){return g.random.generate(t,s)};g.random.getBytesSync=function(s){return g.random.generate(s)}})(typeof(jQuery)!=="undefined"?jQuery:null)}var d="random";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var e=true;define=function(h,g){g(require,module)}}else{if(typeof forge==="undefined"){forge={}}return c(forge)}}var b;var a=function(h,g){g.exports=function(j){var l=b.map(function(i){return h(i)}).concat(c);j=j||{};j.defined=j.defined||{};if(j.defined[d]){return j[d]}j.defined[d]=true;for(var k=0;k<l.length;++k){l[k](j)}return j[d]}};var f=define;define=function(h,g){b=(typeof h==="string")?g.slice(2):h.slice(2);if(e){delete define;return f.apply(null,Array.prototype.slice.call(arguments,0))}define=f;return define.apply(null,Array.prototype.slice.call(arguments,0))};define(["require","module","./aes","./md","./prng","./util"],function(){a.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function c(g){g.pki=g.pki||{};var h=g.pki.oids=g.oids=g.oids||{};h["1.2.840.113549.1.1.1"]="rsaEncryption";h.rsaEncryption="1.2.840.113549.1.1.1";h["1.2.840.113549.1.1.4"]="md5WithRSAEncryption";h.md5WithRSAEncryption="1.2.840.113549.1.1.4";h["1.2.840.113549.1.1.5"]="sha1WithRSAEncryption";h.sha1WithRSAEncryption="1.2.840.113549.1.1.5";h["1.2.840.113549.1.1.7"]="RSAES-OAEP";h["RSAES-OAEP"]="1.2.840.113549.1.1.7";h["1.2.840.113549.1.1.8"]="mgf1";h.mgf1="1.2.840.113549.1.1.8";h["1.2.840.113549.1.1.9"]="pSpecified";h.pSpecified="1.2.840.113549.1.1.9";h["1.2.840.113549.1.1.10"]="RSASSA-PSS";h["RSASSA-PSS"]="1.2.840.113549.1.1.10";h["1.2.840.113549.1.1.11"]="sha256WithRSAEncryption";h.sha256WithRSAEncryption="1.2.840.113549.1.1.11";h["1.2.840.113549.1.1.12"]="sha384WithRSAEncryption";h.sha384WithRSAEncryption="1.2.840.113549.1.1.12";h["1.2.840.113549.1.1.13"]="sha512WithRSAEncryption";h.sha512WithRSAEncryption="1.2.840.113549.1.1.13";h["1.3.14.3.2.7"]="desCBC";h.desCBC="1.3.14.3.2.7";h["1.3.14.3.2.26"]="sha1";h.sha1="1.3.14.3.2.26";h["2.16.840.1.101.3.4.2.1"]="sha256";h.sha256="2.16.840.1.101.3.4.2.1";h["2.16.840.1.101.3.4.2.2"]="sha384";h.sha384="2.16.840.1.101.3.4.2.2";h["2.16.840.1.101.3.4.2.3"]="sha512";h.sha512="2.16.840.1.101.3.4.2.3";h["1.2.840.113549.2.5"]="md5";h.md5="1.2.840.113549.2.5";h["1.2.840.113549.1.7.1"]="data";h.data="1.2.840.113549.1.7.1";h["1.2.840.113549.1.7.2"]="signedData";h.signedData="1.2.840.113549.1.7.2";h["1.2.840.113549.1.7.3"]="envelopedData";h.envelopedData="1.2.840.113549.1.7.3";h["1.2.840.113549.1.7.4"]="signedAndEnvelopedData";h.signedAndEnvelopedData="1.2.840.113549.1.7.4";h["1.2.840.113549.1.7.5"]="digestedData";h.digestedData="1.2.840.113549.1.7.5";h["1.2.840.113549.1.7.6"]="encryptedData";h.encryptedData="1.2.840.113549.1.7.6";h["1.2.840.113549.1.9.1"]="emailAddress";h.emailAddress="1.2.840.113549.1.9.1";h["1.2.840.113549.1.9.2"]="unstructuredName";h.unstructuredName="1.2.840.113549.1.9.2";h["1.2.840.113549.1.9.3"]="contentType";h.contentType="1.2.840.113549.1.9.3";h["1.2.840.113549.1.9.4"]="messageDigest";h.messageDigest="1.2.840.113549.1.9.4";h["1.2.840.113549.1.9.5"]="signingTime";h.signingTime="1.2.840.113549.1.9.5";h["1.2.840.113549.1.9.6"]="counterSignature";h.counterSignature="1.2.840.113549.1.9.6";h["1.2.840.113549.1.9.7"]="challengePassword";h.challengePassword="1.2.840.113549.1.9.7";h["1.2.840.113549.1.9.8"]="unstructuredAddress";h.unstructuredAddress="1.2.840.113549.1.9.8";h["1.2.840.113549.1.9.20"]="friendlyName";h.friendlyName="1.2.840.113549.1.9.20";h["1.2.840.113549.1.9.21"]="localKeyId";h.localKeyId="1.2.840.113549.1.9.21";h["1.2.840.113549.1.9.22.1"]="x509Certificate";h.x509Certificate="1.2.840.113549.1.9.22.1";h["1.2.840.113549.1.12.10.1.1"]="keyBag";h.keyBag="1.2.840.113549.1.12.10.1.1";h["1.2.840.113549.1.12.10.1.2"]="pkcs8ShroudedKeyBag";h.pkcs8ShroudedKeyBag="1.2.840.113549.1.12.10.1.2";h["1.2.840.113549.1.12.10.1.3"]="certBag";h.certBag="1.2.840.113549.1.12.10.1.3";h["1.2.840.113549.1.12.10.1.4"]="crlBag";h.crlBag="1.2.840.113549.1.12.10.1.4";h["1.2.840.113549.1.12.10.1.5"]="secretBag";h.secretBag="1.2.840.113549.1.12.10.1.5";h["1.2.840.113549.1.12.10.1.6"]="safeContentsBag";h.safeContentsBag="1.2.840.113549.1.12.10.1.6";h["1.2.840.113549.1.5.13"]="pkcs5PBES2";h.pkcs5PBES2="1.2.840.113549.1.5.13";h["1.2.840.113549.1.5.12"]="pkcs5PBKDF2";h.pkcs5PBKDF2="1.2.840.113549.1.5.12";h["1.2.840.113549.1.12.1.1"]="pbeWithSHAAnd128BitRC4";h.pbeWithSHAAnd128BitRC4="1.2.840.113549.1.12.1.1";h["1.2.840.113549.1.12.1.2"]="pbeWithSHAAnd40BitRC4";h.pbeWithSHAAnd40BitRC4="1.2.840.113549.1.12.1.2";h["1.2.840.113549.1.12.1.3"]="pbeWithSHAAnd3-KeyTripleDES-CBC";h["pbeWithSHAAnd3-KeyTripleDES-CBC"]="1.2.840.113549.1.12.1.3";h["1.2.840.113549.1.12.1.4"]="pbeWithSHAAnd2-KeyTripleDES-CBC";h["pbeWithSHAAnd2-KeyTripleDES-CBC"]="1.2.840.113549.1.12.1.4";h["1.2.840.113549.1.12.1.5"]="pbeWithSHAAnd128BitRC2-CBC";h["pbeWithSHAAnd128BitRC2-CBC"]="1.2.840.113549.1.12.1.5";h["1.2.840.113549.1.12.1.6"]="pbewithSHAAnd40BitRC2-CBC";h["pbewithSHAAnd40BitRC2-CBC"]="1.2.840.113549.1.12.1.6";h["1.2.840.113549.3.7"]="des-EDE3-CBC";h["des-EDE3-CBC"]="1.2.840.113549.3.7";h["2.16.840.1.101.3.4.1.2"]="aes128-CBC";h["aes128-CBC"]="2.16.840.1.101.3.4.1.2";h["2.16.840.1.101.3.4.1.22"]="aes192-CBC";h["aes192-CBC"]="2.16.840.1.101.3.4.1.22";h["2.16.840.1.101.3.4.1.42"]="aes256-CBC";h["aes256-CBC"]="2.16.840.1.101.3.4.1.42";h["2.5.4.3"]="commonName";h.commonName="2.5.4.3";h["2.5.4.5"]="serialName";h.serialName="2.5.4.5";h["2.5.4.6"]="countryName";h.countryName="2.5.4.6";h["2.5.4.7"]="localityName";h.localityName="2.5.4.7";h["2.5.4.8"]="stateOrProvinceName";h.stateOrProvinceName="2.5.4.8";h["2.5.4.10"]="organizationName";h.organizationName="2.5.4.10";h["2.5.4.11"]="organizationalUnitName";h.organizationalUnitName="2.5.4.11";h["2.16.840.1.113730.1.1"]="nsCertType";h.nsCertType="2.16.840.1.113730.1.1";h["2.5.29.1"]="authorityKeyIdentifier";h["2.5.29.2"]="keyAttributes";h["2.5.29.3"]="certificatePolicies";h["2.5.29.4"]="keyUsageRestriction";h["2.5.29.5"]="policyMapping";h["2.5.29.6"]="subtreesConstraint";h["2.5.29.7"]="subjectAltName";h["2.5.29.8"]="issuerAltName";h["2.5.29.9"]="subjectDirectoryAttributes";h["2.5.29.10"]="basicConstraints";h["2.5.29.11"]="nameConstraints";h["2.5.29.12"]="policyConstraints";h["2.5.29.13"]="basicConstraints";h["2.5.29.14"]="subjectKeyIdentifier";h.subjectKeyIdentifier="2.5.29.14";h["2.5.29.15"]="keyUsage";h.keyUsage="2.5.29.15";h["2.5.29.16"]="privateKeyUsagePeriod";h["2.5.29.17"]="subjectAltName";h.subjectAltName="2.5.29.17";h["2.5.29.18"]="issuerAltName";h.issuerAltName="2.5.29.18";h["2.5.29.19"]="basicConstraints";h.basicConstraints="2.5.29.19";h["2.5.29.20"]="cRLNumber";h["2.5.29.21"]="cRLReason";h["2.5.29.22"]="expirationDate";h["2.5.29.23"]="instructionCode";h["2.5.29.24"]="invalidityDate";h["2.5.29.25"]="cRLDistributionPoints";h["2.5.29.26"]="issuingDistributionPoint";h["2.5.29.27"]="deltaCRLIndicator";h["2.5.29.28"]="issuingDistributionPoint";h["2.5.29.29"]="certificateIssuer";h["2.5.29.30"]="nameConstraints";h["2.5.29.31"]="cRLDistributionPoints";h["2.5.29.32"]="certificatePolicies";h["2.5.29.33"]="policyMappings";h["2.5.29.34"]="policyConstraints";h["2.5.29.35"]="authorityKeyIdentifier";h["2.5.29.36"]="policyConstraints";h["2.5.29.37"]="extKeyUsage";h.extKeyUsage="2.5.29.37";h["2.5.29.46"]="freshestCRL";h["2.5.29.54"]="inhibitAnyPolicy";h["1.3.6.1.5.5.7.3.1"]="serverAuth";h.serverAuth="1.3.6.1.5.5.7.3.1";h["1.3.6.1.5.5.7.3.2"]="clientAuth";h.clientAuth="1.3.6.1.5.5.7.3.2";h["1.3.6.1.5.5.7.3.3"]="codeSigning";h.codeSigning="1.3.6.1.5.5.7.3.3";h["1.3.6.1.5.5.7.3.4"]="emailProtection";h.emailProtection="1.3.6.1.5.5.7.3.4";h["1.3.6.1.5.5.7.3.8"]="timeStamping";h.timeStamping="1.3.6.1.5.5.7.3.8"}var d="oids";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var e=true;define=function(h,g){g(require,module)}}else{if(typeof forge==="undefined"){forge={}}return c(forge)}}var b;var a=function(h,g){g.exports=function(j){var l=b.map(function(i){return h(i)}).concat(c);j=j||{};j.defined=j.defined||{};if(j.defined[d]){return j[d]}j.defined[d]=true;for(var k=0;k<l.length;++k){l[k](j)}return j[d]}};var f=define;define=function(h,g){b=(typeof h==="string")?g.slice(2):h.slice(2);if(e){delete define;return f.apply(null,Array.prototype.slice.call(arguments,0))}define=f;return define.apply(null,Array.prototype.slice.call(arguments,0))};define(["require","module"],function(){a.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function c(p){if(typeof n==="undefined"){var n=p.jsbn.BigInteger}var m=p.asn1;p.pki=p.pki||{};p.pki.rsa=p.rsa=p.rsa||{};var r=p.pki;var q=[6,4,2,4,2,4,6,2];var s={name:"PrivateKeyInfo",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:true,value:[{name:"PrivateKeyInfo.version",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:false,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:true,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:m.Class.UNIVERSAL,type:m.Type.OID,constructed:false,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:m.Class.UNIVERSAL,type:m.Type.OCTETSTRING,constructed:false,capture:"privateKey"}]};var u={name:"RSAPrivateKey",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:true,value:[{name:"RSAPrivateKey.version",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:false,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:false,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:false,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:false,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:false,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:false,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:false,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:false,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:false,capture:"privateKeyCoefficient"}]};var v={name:"RSAPublicKey",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:true,value:[{name:"RSAPublicKey.modulus",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:false,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:false,capture:"publicKeyExponent"}]};var t=p.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:true,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:true,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:m.Class.UNIVERSAL,type:m.Type.OID,constructed:false,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:m.Class.UNIVERSAL,type:m.Type.BITSTRING,constructed:false,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:true,optional:true,captureAsn1:"rsaPublicKey"}]}]};var o=function(z){var A;if(z.algorithm in r.oids){A=r.oids[z.algorithm]}else{throw {message:"Unknown message digest algorithm.",algorithm:z.algorithm}}var B=m.oidToDer(A).getBytes();var y=m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,true,[]);var x=m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,true,[]);x.value.push(m.create(m.Class.UNIVERSAL,m.Type.OID,false,B));x.value.push(m.create(m.Class.UNIVERSAL,m.Type.NULL,false,""));var w=m.create(m.Class.UNIVERSAL,m.Type.OCTETSTRING,false,z.digest().getBytes());y.value.push(x);y.value.push(w);return m.toDer(y).getBytes()};var l=function(A,w,z){var D;if(z){D=A.modPow(w.e,w.n)}else{if(!w.p||!w.q){D=A.modPow(w.d,w.n)}else{if(!w.dP){w.dP=w.d.mod(w.p.subtract(n.ONE))}if(!w.dQ){w.dQ=w.d.mod(w.q.subtract(n.ONE))}if(!w.qInv){w.qInv=w.q.modInverse(w.p)}var B=A.mod(w.p).modPow(w.dP,w.p);var C=A.mod(w.q).modPow(w.dQ,w.q);while(B.compareTo(C)<0){B=B.add(w.p)}D=B.subtract(C).multiply(w.qInv).mod(w.p).multiply(w.q).add(C)}}return D};r.rsa.encrypt=function(D,C,w){var E=w;var z;var B=Math.ceil(C.n.bitLength()/8);if(w!==false&&w!==true){E=(w===2);z=i(D,C,w)}else{z=p.util.createBuffer();z.putBytes(D)}var F=new n(z.toHex(),16);var G=l(F,C,E);var H=G.toString(16);var A=p.util.createBuffer();var I=B-Math.ceil(H.length/2);while(I>0){A.putByte(0);--I}A.putBytes(p.util.hexToBytes(H));return A.getBytes()};r.rsa.decrypt=function(z,B,D,C){var A=Math.ceil(B.n.bitLength()/8);if(z.length!==A){throw {message:"Encrypted message length is invalid.",length:z.length,expected:A}}var G=new n(p.util.createBuffer(z).toHex(),16);if(G.compareTo(B.n)>=0){throw {message:"Encrypted message is invalid."}}var E=l(G,B,D);var F=E.toString(16);var w=p.util.createBuffer();var H=A-Math.ceil(F.length/2);while(H>0){w.putByte(0);--H}w.putBytes(p.util.hexToBytes(F));if(C!==false){return h(w.getBytes(),B,D)}return w.getBytes()};r.rsa.createKeyPairGenerationState=function(w,x){if(typeof(w)==="string"){w=parseInt(w,10)}w=w||2048;var y={nextBytes:function(C){var A=p.random.getBytes(C.length);for(var B=0;B<C.length;++B){C[B]=A.charCodeAt(B)}}};var z={state:0,bits:w,rng:y,eInt:x||65537,e:new n(null),p:null,q:null,qBits:w>>1,pBits:w-(w>>1),pqState:0,num:null,keys:null};z.e.fromInt(z.eInt);return z};r.rsa.stepKeyPairGenerationState=function(C,A){var F=new n(null);F.fromInt(30);var z=0;var B=function(H,I){return H|I};var D=+new Date();var E;var G=0;while(C.keys===null&&(A<=0||G<A)){if(C.state===0){var w=(C.p===null)?C.pBits:C.qBits;var x=w-1;if(C.pqState===0){C.num=new n(w,C.rng);if(!C.num.testBit(x)){C.num.bitwiseTo(n.ONE.shiftLeft(x),B,C.num)}C.num.dAddOffset(31-C.num.mod(F).byteValue(),0);z=0;++C.pqState}else{if(C.pqState===1){if(C.num.bitLength()>w){C.pqState=0}else{if(C.num.isProbablePrime(k(C.num.bitLength()))){++C.pqState}else{C.num.dAddOffset(q[z++%8],0)}}}else{if(C.pqState===2){C.pqState=(C.num.subtract(n.ONE).gcd(C.e).compareTo(n.ONE)===0)?3:0}else{if(C.pqState===3){C.pqState=0;if(C.p===null){C.p=C.num}else{C.q=C.num}if(C.p!==null&&C.q!==null){++C.state}C.num=null}}}}}else{if(C.state===1){if(C.p.compareTo(C.q)<0){C.num=C.p;C.p=C.q;C.q=C.num}++C.state}else{if(C.state===2){C.p1=C.p.subtract(n.ONE);C.q1=C.q.subtract(n.ONE);C.phi=C.p1.multiply(C.q1);++C.state}else{if(C.state===3){if(C.phi.gcd(C.e).compareTo(n.ONE)===0){++C.state}else{C.p=null;C.q=null;C.state=0}}else{if(C.state===4){C.n=C.p.multiply(C.q);if(C.n.bitLength()===C.bits){++C.state}else{C.q=null;C.state=0}}else{if(C.state===5){var y=C.e.modInverse(C.phi);C.keys={privateKey:r.rsa.setPrivateKey(C.n,C.e,y,C.p,C.q,y.mod(C.p1),y.mod(C.q1),C.q.modInverse(C.p)),publicKey:r.rsa.setPublicKey(C.n,C.e)}}}}}}}E=+new Date();G+=E-D;D=E}return C.keys!==null};r.rsa.generateKeyPair=function(w,y,z,x){if(arguments.length===1){if(typeof w==="object"){z=w;w=undefined}else{if(typeof w==="function"){x=w;w=undefined}}}else{if(arguments.length===2){if(typeof w==="number"){if(typeof y==="function"){x=y}else{z=y}}else{z=w;x=y;w=undefined}y=undefined}else{if(arguments.length===3){if(typeof y==="number"){if(typeof z==="function"){x=z;z=undefined}}else{x=z;z=y;y=undefined}}}}z=z||{};if(w===undefined){w=z.bits||2048}if(y===undefined){y=z.e||65537}var A=r.rsa.createKeyPairGenerationState(w,y);if(!x){r.rsa.stepKeyPairGenerationState(A,0);return A.keys}j(A,z,x)};r.setRsaPublicKey=r.rsa.setPublicKey=function(y,w){var x={n:y,e:w};x.encrypt=function(z,B,C){if(typeof B==="string"){B=B.toUpperCase()}else{if(B===undefined){B="RSAES-PKCS1-V1_5"}}if(B==="RSAES-PKCS1-V1_5"){B={encode:function(E,D,F){return i(E,D,2).getBytes()}}}else{if(B==="RSA-OAEP"||B==="RSAES-OAEP"){B={encode:function(E,D){return p.pkcs1.encode_rsa_oaep(D,E,C)}}}else{if(["RAW","NONE","NULL",null].indexOf(B)!==-1){B={encode:function(D){return D}}}else{throw {message:'Unsupported encryption scheme: "'+B+'".'}}}}var A=B.encode(z,x,true);return r.rsa.encrypt(A,x,true)};x.verify=function(A,C,B){if(typeof B==="string"){B=B.toUpperCase()}else{if(B===undefined){B="RSASSA-PKCS1-V1_5"}}if(B==="RSASSA-PKCS1-V1_5"){B={verify:function(E,D){D=h(D,x,true);var F=m.fromDer(D);return E===F.value[1].value}}}else{if(B==="NONE"||B==="NULL"||B===null){B={verify:function(E,D){D=h(D,x,true);return E===D}}}}var z=r.rsa.decrypt(C,x,true,false);return B.verify(A,z,x.n.bitLength())};return x};r.setRsaPrivateKey=r.rsa.setPrivateKey=function(B,z,w,C,D,x,y,E){var A={n:B,e:z,d:w,p:C,q:D,dP:x,dQ:y,qInv:E};A.decrypt=function(G,H,I){if(typeof H==="string"){H=H.toUpperCase()}else{if(H===undefined){H="RSAES-PKCS1-V1_5"}}var F=r.rsa.decrypt(G,A,false,false);if(H==="RSAES-PKCS1-V1_5"){H={decode:h}}else{if(H==="RSA-OAEP"||H==="RSAES-OAEP"){H={decode:function(J,K){return p.pkcs1.decode_rsa_oaep(K,J,I)}}}else{if(["RAW","NONE","NULL",null].indexOf(H)!==-1){H={decode:function(J){return J}}}else{throw {message:'Unsupported encryption scheme: "'+H+'".'}}}}return H.decode(F,A,false)};A.sign=function(H,I){var F=false;if(typeof I==="string"){I=I.toUpperCase()}if(I===undefined||I==="RSASSA-PKCS1-V1_5"){I={encode:o};F=1}else{if(I==="NONE"||I==="NULL"||I===null){I={encode:function(){return H}};F=1}}var G=I.encode(H,A.n.bitLength());return r.rsa.encrypt(G,A,F)};return A};r.wrapRsaPrivateKey=function(w){return m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,true,[m.create(m.Class.UNIVERSAL,m.Type.INTEGER,false,m.integerToDer(0).getBytes()),m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,true,[m.create(m.Class.UNIVERSAL,m.Type.OID,false,m.oidToDer(r.oids.rsaEncryption).getBytes()),m.create(m.Class.UNIVERSAL,m.Type.NULL,false,"")]),m.create(m.Class.UNIVERSAL,m.Type.OCTETSTRING,false,m.toDer(w).getBytes())])};r.wrapRsaPrivateKey=function(w){return m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,true,[m.create(m.Class.UNIVERSAL,m.Type.INTEGER,false,m.integerToDer(0).getBytes()),m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,true,[m.create(m.Class.UNIVERSAL,m.Type.OID,false,m.oidToDer(r.oids.rsaEncryption).getBytes()),m.create(m.Class.UNIVERSAL,m.Type.NULL,false,"")]),m.create(m.Class.UNIVERSAL,m.Type.OCTETSTRING,false,m.toDer(w).getBytes())])};r.privateKeyFromAsn1=function(D){var w={};var B=[];if(m.validate(D,s,w,B)){D=m.fromDer(p.util.createBuffer(w.privateKey))}w={};B=[];if(!m.validate(D,u,w,B)){throw {message:"Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.",errors:B}}var C,A,x,E,F,y,z,G;C=p.util.createBuffer(w.privateKeyModulus).toHex();A=p.util.createBuffer(w.privateKeyPublicExponent).toHex();x=p.util.createBuffer(w.privateKeyPrivateExponent).toHex();E=p.util.createBuffer(w.privateKeyPrime1).toHex();F=p.util.createBuffer(w.privateKeyPrime2).toHex();y=p.util.createBuffer(w.privateKeyExponent1).toHex();z=p.util.createBuffer(w.privateKeyExponent2).toHex();G=p.util.createBuffer(w.privateKeyCoefficient).toHex();return r.setRsaPrivateKey(new n(C,16),new n(A,16),new n(x,16),new n(E,16),new n(F,16),new n(y,16),new n(z,16),new n(G,16))};r.privateKeyToAsn1=r.privateKeyToRSAPrivateKey=function(w){return m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,true,[m.create(m.Class.UNIVERSAL,m.Type.INTEGER,false,m.integerToDer(0).getBytes()),m.create(m.Class.UNIVERSAL,m.Type.INTEGER,false,g(w.n)),m.create(m.Class.UNIVERSAL,m.Type.INTEGER,false,g(w.e)),m.create(m.Class.UNIVERSAL,m.Type.INTEGER,false,g(w.d)),m.create(m.Class.UNIVERSAL,m.Type.INTEGER,false,g(w.p)),m.create(m.Class.UNIVERSAL,m.Type.INTEGER,false,g(w.q)),m.create(m.Class.UNIVERSAL,m.Type.INTEGER,false,g(w.dP)),m.create(m.Class.UNIVERSAL,m.Type.INTEGER,false,g(w.dQ)),m.create(m.Class.UNIVERSAL,m.Type.INTEGER,false,g(w.qInv))])};r.publicKeyFromAsn1=function(A){var w={};var y=[];if(m.validate(A,t,w,y)){var B=m.derToOid(w.publicKeyOid);if(B!==r.oids.rsaEncryption){throw {message:"Cannot read public key. Unknown OID.",oid:B}}A=w.rsaPublicKey}y=[];if(!m.validate(A,v,w,y)){throw {message:"Cannot read public key. ASN.1 object does not contain an RSAPublicKey.",errors:y}}var z=p.util.createBuffer(w.publicKeyModulus).toHex();var x=p.util.createBuffer(w.publicKeyExponent).toHex();return r.setRsaPublicKey(new n(z,16),new n(x,16))};r.publicKeyToAsn1=r.publicKeyToSubjectPublicKeyInfo=function(w){return m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,true,[m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,true,[m.create(m.Class.UNIVERSAL,m.Type.OID,false,m.oidToDer(r.oids.rsaEncryption).getBytes()),m.create(m.Class.UNIVERSAL,m.Type.NULL,false,"")]),m.create(m.Class.UNIVERSAL,m.Type.BITSTRING,false,[r.publicKeyToRSAPublicKey(w)])])};r.publicKeyToRSAPublicKey=function(w){return m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,true,[m.create(m.Class.UNIVERSAL,m.Type.INTEGER,false,g(w.n)),m.create(m.Class.UNIVERSAL,m.Type.INTEGER,false,g(w.e))])};function i(B,A,w){var x=p.util.createBuffer();var z=Math.ceil(A.n.bitLength()/8);if(B.length>(z-11)){throw {message:"Message is too long for PKCS#1 v1.5 padding.",length:B.length,max:(z-11)}}x.putByte(0);x.putByte(w);var F=z-3-B.length;var D;if(w===0||w===1){D=(w===0)?0:255;for(var y=0;y<F;++y){x.putByte(D)}}else{while(F>0){var C=0;var E=p.random.getBytes(F);for(var y=0;y<F;++y){D=E.charCodeAt(y);if(D===0){++C}else{x.putByte(D)}}F=C}}x.putByte(0);x.putBytes(B);return x}function h(y,C,F,D){var B=Math.ceil(C.n.bitLength()/8);var x=p.util.createBuffer(y);var z=x.getByte();var w=x.getByte();if(z!==0||(F&&w!==0&&w!==1)||(!F&&w!=2)||(F&&w===0&&typeof(D)==="undefined")){throw {message:"Encryption block is invalid."}}var E=0;if(w===0){E=B-3-D;for(var A=0;A<E;++A){if(x.getByte()!==0){throw {message:"Encryption block is invalid."}}}}else{if(w===1){E=0;while(x.length()>1){if(x.getByte()!==255){--x.read;break}++E}}else{if(w===2){E=0;while(x.length()>1){if(x.getByte()===0){--x.read;break}++E}}}}var G=x.getByte();if(G!==0||E!==(B-3-x.length())){throw {message:"Encryption block is invalid."}}return x.getBytes()}function j(E,C,w){if(typeof C==="function"){w=C;C={}}if(typeof(Worker)==="undefined"){function F(){if(r.rsa.stepKeyPairGenerationState(E,10)){return w(null,E.keys)}p.util.setImmediate(F)}return F()}var A=C.workers||2;var I=C.workLoad||100;var D=I*30/8;var H=C.workerScript||"forge/prime.worker.js";var G=new n(null);G.fromInt(30);var B=function(J,K){return J|K};if(A===-1){return p.util.estimateCores(function(K,J){if(K){J=2}A=J-1;y()})}y();function y(){A=Math.max(1,A);z(E.pBits,function(J,K){if(J){return w(J)}E.p=K;z(E.qBits,x)})}function z(J,K){var R=[];for(var N=0;N<A;++N){R[N]=new Worker(H)}var P=A;var O=M();for(var N=0;N<A;++N){R[N].addEventListener("message",Q)}function M(){var S=J-1;var T=new n(J,E.rng);if(!T.testBit(S)){T.bitwiseTo(n.ONE.shiftLeft(S),B,T)}T.dAddOffset(31-T.mod(G).byteValue(),0);return T}var L=false;function Q(T){if(L){return}--P;var S=T.data;if(S.found){for(var V=0;V<R.length;++V){R[V].terminate()}L=true;return K(null,new n(S.prime,16))}if(O.bitLength()>J){O=M()}var U=O.toString(16);T.target.postMessage({e:E.eInt,hex:U,workLoad:I});O.dAddOffset(D,0)}}function x(K,L){E.q=L;if(E.p.compareTo(E.q)<0){var M=E.p;E.p=E.q;E.q=M}E.p1=E.p.subtract(n.ONE);E.q1=E.q.subtract(n.ONE);E.phi=E.p1.multiply(E.q1);if(E.phi.gcd(E.e).compareTo(n.ONE)!==0){E.p=E.q=null;y();return}E.n=E.p.multiply(E.q);if(E.n.bitLength()!==E.bits){E.q=null;z(E.qBits,x);return}var J=E.e.modInverse(E.phi);E.keys={privateKey:r.rsa.setPrivateKey(E.n,E.e,J,E.p,E.q,J.mod(E.p1),J.mod(E.q1),E.q.modInverse(E.p)),publicKey:r.rsa.setPublicKey(E.n,E.e)};w(null,E.keys)}}function g(w){var x=w.toString(16);if(x[0]>="8"){x="00"+x}return p.util.hexToBytes(x)}function k(w){if(w<=100){return 27}if(w<=150){return 18}if(w<=200){return 15}if(w<=250){return 12}if(w<=300){return 9}if(w<=350){return 8}if(w<=400){return 7}if(w<=500){return 6}if(w<=600){return 5}if(w<=800){return 4}if(w<=1250){return 3}return 2}}var d="rsa";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var e=true;define=function(h,g){g(require,module)}}else{if(typeof forge==="undefined"){forge={}}return c(forge)}}var b;var a=function(h,g){g.exports=function(j){var l=b.map(function(i){return h(i)}).concat(c);j=j||{};j.defined=j.defined||{};if(j.defined[d]){return j[d]}j.defined[d]=true;for(var k=0;k<l.length;++k){l[k](j)}return j[d]}};var f=define;define=function(h,g){b=(typeof h==="string")?g.slice(2):h.slice(2);if(e){delete define;return f.apply(null,Array.prototype.slice.call(arguments,0))}define=f;return define.apply(null,Array.prototype.slice.call(arguments,0))};define(["require","module","./asn1","./oids","./random","./util","./jsbn","./pkcs1"],function(){a.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function c(k){if(typeof h==="undefined"){var h=k.jsbn.BigInteger}var g=k.asn1;var p=k.pki=k.pki||{};p.pbe=k.pbe=k.pbe||{};var m=p.oids;var i={name:"EncryptedPrivateKeyInfo",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:true,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:true,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:g.Class.UNIVERSAL,type:g.Type.OID,constructed:false,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:true,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:g.Class.UNIVERSAL,type:g.Type.OCTETSTRING,constructed:false,capture:"encryptedData"}]};var n={name:"PBES2Algorithms",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:true,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:true,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:g.Class.UNIVERSAL,type:g.Type.OID,constructed:false,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:true,value:[{name:"PBES2Algorithms.params.salt",tagClass:g.Class.UNIVERSAL,type:g.Type.OCTETSTRING,constructed:false,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:g.Class.UNIVERSAL,type:g.Type.INTEGER,onstructed:true,capture:"kdfIterationCount"}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:true,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:g.Class.UNIVERSAL,type:g.Type.OID,constructed:false,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:g.Class.UNIVERSAL,type:g.Type.OCTETSTRING,constructed:false,capture:"encIv"}]}]};var o={name:"pkcs-12PbeParams",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:true,value:[{name:"pkcs-12PbeParams.salt",tagClass:g.Class.UNIVERSAL,type:g.Type.OCTETSTRING,constructed:false,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:g.Class.UNIVERSAL,type:g.Type.INTEGER,constructed:false,capture:"iterations"}]};p.encryptPrivateKeyInfo=function(B,D,C){C=C||{};C.saltSize=C.saltSize||8;C.count=C.count||2048;C.algorithm=C.algorithm||"aes128";var F=k.random.getBytesSync(C.saltSize);var s=C.count;var t=g.integerToDer(s);var v;var y;var x;if(C.algorithm.indexOf("aes")===0||C.algorithm==="des"){var A,w,r;switch(C.algorithm){case"aes128":v=16;A=16;w=m["aes128-CBC"];r=k.aes.createEncryptionCipher;break;case"aes192":v=24;A=16;w=m["aes192-CBC"];r=k.aes.createEncryptionCipher;break;case"aes256":v=32;A=16;w=m["aes256-CBC"];r=k.aes.createEncryptionCipher;break;case"des":v=8;A=8;w=m.desCBC;r=k.des.createEncryptionCipher;break;default:throw {message:"Cannot encrypt private key. Unknown encryption algorithm.",algorithm:C.algorithm}}var u=k.pkcs5.pbkdf2(D,F,s,v);var z=k.random.getBytesSync(A);var q=r(u);q.start(z);q.update(g.toDer(B));q.finish();x=q.output.getBytes();y=g.create(g.Class.UNIVERSAL,g.Type.SEQUENCE,true,[g.create(g.Class.UNIVERSAL,g.Type.OID,false,g.oidToDer(m.pkcs5PBES2).getBytes()),g.create(g.Class.UNIVERSAL,g.Type.SEQUENCE,true,[g.create(g.Class.UNIVERSAL,g.Type.SEQUENCE,true,[g.create(g.Class.UNIVERSAL,g.Type.OID,false,g.oidToDer(m.pkcs5PBKDF2).getBytes()),g.create(g.Class.UNIVERSAL,g.Type.SEQUENCE,true,[g.create(g.Class.UNIVERSAL,g.Type.OCTETSTRING,false,F),g.create(g.Class.UNIVERSAL,g.Type.INTEGER,false,t.getBytes())])]),g.create(g.Class.UNIVERSAL,g.Type.SEQUENCE,true,[g.create(g.Class.UNIVERSAL,g.Type.OID,false,g.oidToDer(w).getBytes()),g.create(g.Class.UNIVERSAL,g.Type.OCTETSTRING,false,z)])])])}else{if(C.algorithm==="3des"){v=24;var G=new k.util.ByteBuffer(F);var u=p.pbe.generatePkcs12Key(D,G,1,s,v);var z=p.pbe.generatePkcs12Key(D,G,2,s,v);var q=k.des.createEncryptionCipher(u);q.start(z);q.update(g.toDer(B));q.finish();x=q.output.getBytes();y=g.create(g.Class.UNIVERSAL,g.Type.SEQUENCE,true,[g.create(g.Class.UNIVERSAL,g.Type.OID,false,g.oidToDer(m["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),g.create(g.Class.UNIVERSAL,g.Type.SEQUENCE,true,[g.create(g.Class.UNIVERSAL,g.Type.OCTETSTRING,false,F),g.create(g.Class.UNIVERSAL,g.Type.INTEGER,false,t.getBytes())])])}else{throw {message:"Cannot encrypt private key. Unknown encryption algorithm.",algorithm:C.algorithm}}}var E=g.create(g.Class.UNIVERSAL,g.Type.SEQUENCE,true,[y,g.create(g.Class.UNIVERSAL,g.Type.OCTETSTRING,false,x)]);return E};p.decryptPrivateKeyInfo=function(u,w){var x=null;var q={};var t=[];if(!g.validate(u,i,q,t)){throw {message:"Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.",errors:t}}var v=g.derToOid(q.encryptionOid);var r=p.pbe.getCipher(v,q.encryptionParams,w);var s=k.util.createBuffer(q.encryptedData);r.update(s);if(r.finish()){x=g.fromDer(r.output)}return x};p.encryptedPrivateKeyToPem=function(q,r){var s={type:"ENCRYPTED PRIVATE KEY",body:g.toDer(q).getBytes()};return k.pem.encode(s,{maxline:r})};p.encryptedPrivateKeyFromPem=function(r){var q=k.pem.decode(r)[0];if(q.type!=="ENCRYPTED PRIVATE KEY"){throw {message:'Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".',headerType:q.type}}if(q.procType&&q.procType.type==="ENCRYPTED"){throw {message:"Could not convert encrypted private key from PEM; PEM is encrypted."}}return g.fromDer(q.body)};p.encryptRsaPrivateKey=function(z,y,x){x=x||{};if(!x.legacy){var A=p.wrapRsaPrivateKey(p.privateKeyToAsn1(z));A=p.encryptPrivateKeyInfo(A,y,x);return p.encryptedPrivateKeyToPem(A)}var q;var v;var u;var s;switch(x.algorithm){case"aes128":q="AES-128-CBC";u=16;v=k.random.getBytesSync(16);s=k.aes.createEncryptionCipher;break;case"aes192":q="AES-192-CBC";u=24;v=k.random.getBytesSync(16);s=k.aes.createEncryptionCipher;break;case"aes256":q="AES-256-CBC";u=32;v=k.random.getBytesSync(16);s=k.aes.createEncryptionCipher;break;case"3des":q="DES-EDE3-CBC";u=24;v=k.random.getBytesSync(8);s=k.des.createEncryptionCipher;break;case"des":q="DES-CBC";u=8;v=k.random.getBytesSync(8);s=k.des.createEncryptionCipher;break;default:throw {message:'Could not encrypt RSA private key; unsupported encryption algorithm "'+x.algorithm+'".',algorithm:x.algorithm}}var t=j(y,v.substr(0,8),u);var r=s(t);r.start(v);r.update(g.toDer(p.privateKeyToAsn1(z)));r.finish();var w={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:q,parameters:k.util.bytesToHex(v).toUpperCase()},body:r.output.getBytes()};return k.pem.encode(w)};p.decryptRsaPrivateKey=function(x,w){var y=null;var v=k.pem.decode(x)[0];if(v.type!=="ENCRYPTED PRIVATE KEY"&&v.type!=="PRIVATE KEY"&&v.type!=="RSA PRIVATE KEY"){throw {message:'Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".',headerType:v.type}}if(v.procType&&v.procType.type==="ENCRYPTED"){var t;var r;switch(v.dekInfo.algorithm){case"DES-CBC":t=8;r=k.des.createDecryptionCipher;break;case"DES-EDE3-CBC":t=24;r=k.des.createDecryptionCipher;break;case"AES-128-CBC":t=16;r=k.aes.createDecryptionCipher;break;case"AES-192-CBC":t=24;r=k.aes.createDecryptionCipher;break;case"AES-256-CBC":t=32;r=k.aes.createDecryptionCipher;break;case"RC2-40-CBC":t=5;r=function(z){return k.rc2.createDecryptionCipher(z,40)};break;case"RC2-64-CBC":t=8;r=function(z){return k.rc2.createDecryptionCipher(z,64)};break;case"RC2-128-CBC":t=16;r=function(z){return k.rc2.createDecryptionCipher(z,128)};break;default:throw {message:'Could not decrypt private key; unsupported encryption algorithm "'+v.dekInfo.algorithm+'".',algorithm:v.dekInfo.algorithm}}var u=k.util.hexToBytes(v.dekInfo.parameters);var s=j(w,u.substr(0,8),t);var q=r(s);q.start(u);q.update(k.util.createBuffer(v.body));if(q.finish()){y=q.output.getBytes()}else{return y}}else{y=v.body}if(v.type==="ENCRYPTED PRIVATE KEY"){y=p.decryptPrivateKeyInfo(g.fromDer(y),w)}else{y=g.fromDer(y)}if(y!==null){y=p.privateKeyFromAsn1(y)}return y};p.pbe.generatePkcs12Key=function(Q,X,C,F,L,K){var G,J;if(typeof K==="undefined"||K===null){K=k.md.sha1.create()}var Z=K.digestLength;var aa=K.blockLength;var T=new k.util.ByteBuffer();var O=new k.util.ByteBuffer();for(J=0;J<Q.length;J++){O.putInt16(Q.charCodeAt(J))}O.putInt16(0);var M=O.length();var V=X.length();var y=new k.util.ByteBuffer();y.fillWithByte(C,aa);var Y=aa*Math.ceil(V/aa);var W=new k.util.ByteBuffer();for(J=0;J<Y;J++){W.putByte(X.at(J%V))}var R=aa*Math.ceil(M/aa);var N=new k.util.ByteBuffer();for(J=0;J<R;J++){N.putByte(O.at(J%M))}var A=W;A.putBuffer(N);var t=Math.ceil(L/Z);for(var z=1;z<=t;z++){var r=new k.util.ByteBuffer();r.putBytes(y.bytes());r.putBytes(A.bytes());for(var U=0;U<F;U++){K.start();K.update(r.getBytes());r=K.digest()}var q=new k.util.ByteBuffer();for(J=0;J<aa;J++){q.putByte(r.at(J%Z))}var H=Math.ceil(V/aa)+Math.ceil(M/aa);var E=new k.util.ByteBuffer();for(G=0;G<H;G++){var w=new k.util.ByteBuffer(A.getBytes(aa));var ab=511;for(J=q.length()-1;J>=0;J--){ab=ab>>8;ab+=q.at(J)+w.at(J);w.setAt(J,ab&255)}E.putBuffer(w)}A=E;T.putBuffer(r)}T.truncate(T.length()-L);return T};p.pbe.getCipher=function(q,r,s){switch(q){case p.oids.pkcs5PBES2:return p.pbe.getCipherForPBES2(q,r,s);case p.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case p.oids["pbewithSHAAnd40BitRC2-CBC"]:return p.pbe.getCipherForPKCS12PBE(q,r,s);default:throw {message:"Cannot read encrypted PBE data block. Unsupported OID.",oid:q,supportedOids:["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"]}}};p.pbe.getCipherForPBES2=function(y,z,A){var q={};var w=[];if(!g.validate(z,n,q,w)){throw {message:"Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.",errors:w}}y=g.derToOid(q.kdfOid);if(y!==p.oids.pkcs5PBKDF2){throw {message:"Cannot read encrypted private key. Unsupported key derivation function OID.",oid:y,supportedOids:["pkcs5PBKDF2"]}}y=g.derToOid(q.encOid);if(y!==p.oids["aes128-CBC"]&&y!==p.oids["aes192-CBC"]&&y!==p.oids["aes256-CBC"]&&y!==p.oids["des-EDE3-CBC"]&&y!==p.oids.desCBC){throw {message:"Cannot read encrypted private key. Unsupported encryption scheme OID.",oid:y,supportedOids:["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"]}}var B=q.kdfSalt;var t=k.util.createBuffer(q.kdfIterationCount);t=t.getInt(t.length()<<3);var v;var s;switch(p.oids[y]){case"aes128-CBC":v=16;s=k.aes.createDecryptionCipher;break;case"aes192-CBC":v=24;s=k.aes.createDecryptionCipher;break;case"aes256-CBC":v=32;s=k.aes.createDecryptionCipher;break;case"des-EDE3-CBC":v=24;s=k.des.createDecryptionCipher;break;case"desCBC":v=8;s=k.des.createDecryptionCipher;break}var u=k.pkcs5.pbkdf2(A,B,t,v);var x=q.encIv;var r=s(u);r.start(x);return r};p.pbe.getCipherForPKCS12PBE=function(y,z,A){var q={};var v=[];if(!g.validate(z,o,q,v)){throw {message:"Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.",errors:v}}var B=k.util.createBuffer(q.salt);var s=k.util.createBuffer(q.iterations);s=s.getInt(s.length()<<3);var u,t,r;switch(y){case p.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:u=24;t=8;r=k.des.startDecrypting;break;case p.oids["pbewithSHAAnd40BitRC2-CBC"]:u=5;t=8;r=function(E,D){var C=k.rc2.createDecryptionCipher(E,40);C.start(D,null);return C};break;default:throw {message:"Cannot read PKCS #12 PBE data block. Unsupported OID.",oid:y}}var x=p.pbe.generatePkcs12Key(A,B,1,s,u);var w=p.pbe.generatePkcs12Key(A,B,2,s,t);return r(x,w)};function j(u,v,r){var q=[l(u+v)];for(var t=16,s=1;t<r;++s,t+=16){q.push(l(q[s-1]+u+v))}return q.join("").substr(0,r)}function l(q){return k.md.md5.create().update(q).digest().getBytes()}}var d="pbe";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var e=true;define=function(h,g){g(require,module)}}else{if(typeof forge==="undefined"){forge={}}return c(forge)}}var b;var a=function(h,g){g.exports=function(j){var l=b.map(function(i){return h(i)}).concat(c);j=j||{};j.defined=j.defined||{};if(j.defined[d]){return j[d]}j.defined[d]=true;for(var k=0;k<l.length;++k){l[k](j)}return j[d]}};var f=define;define=function(h,g){b=(typeof h==="string")?g.slice(2):h.slice(2);if(e){delete define;return f.apply(null,Array.prototype.slice.call(arguments,0))}define=f;return define.apply(null,Array.prototype.slice.call(arguments,0))};define(["require","module","./aes","./asn1","./des","./md","./oids","./pem","./pbkdf2","./random","./rc2","./rsa","./util"],function(){a.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function c(t){var q=t.asn1;var v=t.pki=t.pki||{};var u=v.oids;var o={};o.CN=u.commonName;o.commonName="CN";o.C=u.countryName;o.countryName="C";o.L=u.localityName;o.localityName="L";o.ST=u.stateOrProvinceName;o.stateOrProvinceName="ST";o.O=u.organizationName;o.organizationName="O";o.OU=u.organizationalUnitName;o.organizationalUnitName="OU";o.E=u.emailAddress;o.emailAddress="E";var w=t.pki.rsa.publicKeyValidator;var y={name:"Certificate",tagClass:q.Class.UNIVERSAL,type:q.Type.SEQUENCE,constructed:true,value:[{name:"Certificate.TBSCertificate",tagClass:q.Class.UNIVERSAL,type:q.Type.SEQUENCE,constructed:true,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:q.Class.CONTEXT_SPECIFIC,type:0,constructed:true,optional:true,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:q.Class.UNIVERSAL,type:q.Type.INTEGER,constructed:false,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:q.Class.UNIVERSAL,type:q.Type.INTEGER,constructed:false,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:q.Class.UNIVERSAL,type:q.Type.SEQUENCE,constructed:true,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:q.Class.UNIVERSAL,type:q.Type.OID,constructed:false,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:q.Class.UNIVERSAL,optional:true,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:q.Class.UNIVERSAL,type:q.Type.SEQUENCE,constructed:true,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:q.Class.UNIVERSAL,type:q.Type.SEQUENCE,constructed:true,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:q.Class.UNIVERSAL,type:q.Type.UTCTIME,constructed:false,optional:true,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:q.Class.UNIVERSAL,type:q.Type.GENERALIZEDTIME,constructed:false,optional:true,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:q.Class.UNIVERSAL,type:q.Type.UTCTIME,constructed:false,optional:true,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:q.Class.UNIVERSAL,type:q.Type.GENERALIZEDTIME,constructed:false,optional:true,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:q.Class.UNIVERSAL,type:q.Type.SEQUENCE,constructed:true,captureAsn1:"certSubject"},w,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:q.Class.CONTEXT_SPECIFIC,type:1,constructed:true,optional:true,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:q.Class.UNIVERSAL,type:q.Type.BITSTRING,constructed:false,capture:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:q.Class.CONTEXT_SPECIFIC,type:2,constructed:true,optional:true,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:q.Class.UNIVERSAL,type:q.Type.BITSTRING,constructed:false,capture:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:q.Class.CONTEXT_SPECIFIC,type:3,constructed:true,captureAsn1:"certExtensions",optional:true}]},{name:"Certificate.signatureAlgorithm",tagClass:q.Class.UNIVERSAL,type:q.Type.SEQUENCE,constructed:true,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:q.Class.UNIVERSAL,type:q.Type.OID,constructed:false,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:q.Class.UNIVERSAL,optional:true,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:q.Class.UNIVERSAL,type:q.Type.BITSTRING,constructed:false,capture:"certSignature"}]};var x={name:"rsapss",tagClass:q.Class.UNIVERSAL,type:q.Type.SEQUENCE,constructed:true,value:[{name:"rsapss.hashAlgorithm",tagClass:q.Class.CONTEXT_SPECIFIC,type:0,constructed:true,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:q.Class.UNIVERSAL,type:q.Class.SEQUENCE,constructed:true,optional:true,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:q.Class.UNIVERSAL,type:q.Type.OID,constructed:false,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:q.Class.CONTEXT_SPECIFIC,type:1,constructed:true,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:q.Class.UNIVERSAL,type:q.Class.SEQUENCE,constructed:true,optional:true,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:q.Class.UNIVERSAL,type:q.Type.OID,constructed:false,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:q.Class.UNIVERSAL,type:q.Type.SEQUENCE,constructed:true,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:q.Class.UNIVERSAL,type:q.Type.OID,constructed:false,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:q.Class.CONTEXT_SPECIFIC,type:2,optional:true,value:[{name:"rsapss.saltLength.saltLength",tagClass:q.Class.UNIVERSAL,type:q.Class.INTEGER,constructed:false,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:q.Class.CONTEXT_SPECIFIC,type:3,optional:true,value:[{name:"rsapss.trailer.trailer",tagClass:q.Class.UNIVERSAL,type:q.Class.INTEGER,constructed:false,capture:"trailer"}]}]};var r={name:"CertificationRequestInfo",tagClass:q.Class.UNIVERSAL,type:q.Type.SEQUENCE,constructed:true,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:q.Class.UNIVERSAL,type:q.Type.INTEGER,constructed:false,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:q.Class.UNIVERSAL,type:q.Type.SEQUENCE,constructed:true,captureAsn1:"certificationRequestInfoSubject"},w,{name:"CertificationRequestInfo.attributes",tagClass:q.Class.CONTEXT_SPECIFIC,type:0,constructed:true,optional:true,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:q.Class.UNIVERSAL,type:q.Type.SEQUENCE,constructed:true,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:q.Class.UNIVERSAL,type:q.Type.OID,constructed:false},{name:"CertificationRequestInfo.attributes.value",tagClass:q.Class.UNIVERSAL,type:q.Type.SET,constructed:true}]}]}]};var s={name:"CertificationRequest",tagClass:q.Class.UNIVERSAL,type:q.Type.SEQUENCE,constructed:true,captureAsn1:"csr",value:[r,{name:"CertificationRequest.signatureAlgorithm",tagClass:q.Class.UNIVERSAL,type:q.Type.SEQUENCE,constructed:true,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:q.Class.UNIVERSAL,type:q.Type.OID,constructed:false,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:q.Class.UNIVERSAL,optional:true,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:q.Class.UNIVERSAL,type:q.Type.BITSTRING,constructed:false,capture:"csrSignature"}]};v.RDNAttributesAsArray=function(D,B){var E=[];var F,z,C;for(var G=0;G<D.value.length;++G){F=D.value[G];for(var A=0;A<F.value.length;++A){C={};z=F.value[A];C.type=q.derToOid(z.value[0].value);C.value=z.value[1].value;C.valueTagClass=z.value[1].type;if(C.type in u){C.name=u[C.type];if(C.name in o){C.shortName=o[C.name]}}if(B){B.update(C.type);B.update(C.value)}E.push(C)}}return E};v.CRIAttributesAsArray=function(z){var B=[];for(var D=0;D<z.length;++D){var C=z[D];var E=q.derToOid(C.value[0].value);var F=C.value[1].value;for(var G=0;G<F.length;++G){var A={};A.type=E;A.value=F[G].value;A.valueTagClass=F[G].type;if(A.type in u){A.name=u[A.type];if(A.name in o){A.shortName=o[A.name]}}B.push(A)}}return B};function k(B,C){if(typeof C==="string"){C={shortName:C}}var D=null;var z;for(var A=0;D===null&&A<B.attributes.length;++A){z=B.attributes[A];if(C.type&&C.type===z.type){D=z}else{if(C.name&&C.name===z.name){D=z}else{if(C.shortName&&C.shortName===z.shortName){D=z}}}}return D}var m=function(G){var M=[];var C,F,H;for(var J=0;J<G.value.length;++J){H=G.value[J];for(var D=0;D<H.value.length;++D){F=H.value[D];C={};C.id=q.derToOid(F.value[0].value);C.critical=false;if(F.value[1].type===q.Type.BOOLEAN){C.critical=(F.value[1].value.charCodeAt(0)!==0);C.value=F.value[2].value}else{C.value=F.value[1].value}if(C.id in u){C.name=u[C.id];if(C.name==="keyUsage"){var E=q.fromDer(C.value);var A=0;var B=0;if(E.value.length>1){A=E.value.charCodeAt(1);B=E.value.length>2?E.value.charCodeAt(2):0}C.digitalSignature=(A&128)===128;C.nonRepudiation=(A&64)===64;C.keyEncipherment=(A&32)===32;C.dataEncipherment=(A&16)===16;C.keyAgreement=(A&8)===8;C.keyCertSign=(A&4)===4;C.cRLSign=(A&2)===2;C.encipherOnly=(A&1)===1;C.decipherOnly=(B&128)===128}else{if(C.name==="basicConstraints"){var E=q.fromDer(C.value);if(E.value.length>0&&E.value[0].type===q.Type.BOOLEAN){C.cA=(E.value[0].value.charCodeAt(0)!==0)}else{C.cA=false}var N=null;if(E.value.length>0&&E.value[0].type===q.Type.INTEGER){N=E.value[0].value}else{if(E.value.length>1){N=E.value[1].value}}if(N!==null){C.pathLenConstraint=q.derToInteger(N)}}else{if(C.name==="extKeyUsage"){var E=q.fromDer(C.value);for(var O=0;O<E.value.length;++O){var L=q.derToOid(E.value[O].value);if(L in u){C[u[L]]=true}else{C[L]=true}}}else{if(C.name==="nsCertType"){var E=q.fromDer(C.value);var A=0;if(E.value.length>1){A=E.value.charCodeAt(1)}C.client=(A&128)===128;C.server=(A&64)===64;C.email=(A&32)===32;C.objsign=(A&16)===16;C.reserved=(A&8)===8;C.sslCA=(A&4)===4;C.emailCA=(A&2)===2;C.objCA=(A&1)===1}else{if(C.name==="subjectAltName"||C.name==="issuerAltName"){C.altNames=[];var I;var E=q.fromDer(C.value);for(var K=0;K<E.value.length;++K){I=E.value[K];var z={type:I.type,value:I.value};C.altNames.push(z);switch(I.type){case 1:case 2:case 6:break;case 7:z.ip=t.util.bytesToIP(I.value);break;case 8:z.oid=q.derToOid(I.value);break;default:}}}else{if(C.name==="subjectKeyIdentifier"){var E=q.fromDer(C.value);C.subjectKeyIdentifier=t.util.bytesToHex(E.value)}}}}}}}M.push(C)}}return M};var n=function(D,C,B){var E={};if(D!==u["RSASSA-PSS"]){return E}if(B){E={hash:{algorithmOid:u.sha1},mgf:{algorithmOid:u.mgf1,hash:{algorithmOid:u.sha1}},saltLength:20}}var z={};var A=[];if(!q.validate(C,x,z,A)){throw {message:"Cannot read RSASSA-PSS parameter block.",errors:A}}if(z.hashOid!==undefined){E.hash=E.hash||{};E.hash.algorithmOid=q.derToOid(z.hashOid)}if(z.maskGenOid!==undefined){E.mgf=E.mgf||{};E.mgf.algorithmOid=q.derToOid(z.maskGenOid);E.mgf.hash=E.mgf.hash||{};E.mgf.hash.algorithmOid=q.derToOid(z.maskGenHashOid)}if(z.saltLength!==undefined){E.saltLength=z.saltLength.charCodeAt(0)}return E};v.certificateFromPem=function(C,z,D){var A=t.pem.decode(C)[0];if(A.type!=="CERTIFICATE"&&A.type!=="X509 CERTIFICATE"&&A.type!=="TRUSTED CERTIFICATE"){throw {message:'Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".',headerType:A.type}}if(A.procType&&A.procType.type==="ENCRYPTED"){throw {message:"Could not convert certificate from PEM; PEM is encrypted."}}var B=q.fromDer(A.body,D);return v.certificateFromAsn1(B,z)};v.certificateToPem=function(z,A){var B={type:"CERTIFICATE",body:q.toDer(v.certificateToAsn1(z)).getBytes()};return t.pem.encode(B,{maxline:A})};v.publicKeyFromPem=function(B){var z=t.pem.decode(B)[0];if(z.type!=="PUBLIC KEY"&&z.type!=="RSA PUBLIC KEY"){throw {message:'Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".',headerType:z.type}}if(z.procType&&z.procType.type==="ENCRYPTED"){throw {message:"Could not convert public key from PEM; PEM is encrypted."}}var A=q.fromDer(z.body);return v.publicKeyFromAsn1(A)};v.publicKeyToPem=function(z,A){var B={type:"PUBLIC KEY",body:q.toDer(v.publicKeyToAsn1(z)).getBytes()};return t.pem.encode(B,{maxline:A})};v.publicKeyToRSAPublicKeyPem=function(z,A){var B={type:"RSA PUBLIC KEY",body:q.toDer(v.publicKeyToRSAPublicKey(z)).getBytes()};return t.pem.encode(B,{maxline:A})};v.certificationRequestFromPem=function(C,z,D){var A=t.pem.decode(C)[0];if(A.type!=="CERTIFICATE REQUEST"){throw {message:'Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".',headerType:A.type}}if(A.procType&&A.procType.type==="ENCRYPTED"){throw {message:"Could not convert certification request from PEM; PEM is encrypted."}}var B=q.fromDer(A.body,D);return v.certificationRequestFromAsn1(B,z)};v.certificationRequestToPem=function(z,A){var B={type:"CERTIFICATE REQUEST",body:q.toDer(v.certificationRequestToAsn1(z)).getBytes()};return t.pem.encode(B,{maxline:A})};v.createCertificate=function(){var z={};z.version=2;z.serialNumber="00";z.signatureOid=null;z.signature=null;z.siginfo={};z.siginfo.algorithmOid=null;z.validity={};z.validity.notBefore=new Date();z.validity.notAfter=new Date();z.issuer={};z.issuer.getField=function(A){return k(z.issuer,A)};z.issuer.addField=function(A){j([A]);z.issuer.attributes.push(A)};z.issuer.attributes=[];z.issuer.hash=null;z.subject={};z.subject.getField=function(A){return k(z.subject,A)};z.subject.addField=function(A){j([A]);z.subject.attributes.push(A)};z.subject.attributes=[];z.subject.hash=null;z.extensions=[];z.publicKey=null;z.md=null;z.setSubject=function(A,B){j(A);z.subject.attributes=A;delete z.subject.uniqueId;if(B){z.subject.uniqueId=B}z.subject.hash=null};z.setIssuer=function(A,B){j(A);z.issuer.attributes=A;delete z.issuer.uniqueId;if(B){z.issuer.uniqueId=B}z.issuer.hash=null};z.setExtensions=function(E){var D;for(var F=0;F<E.length;++F){D=E[F];if(typeof(D.name)==="undefined"){if(D.id&&D.id in v.oids){D.name=v.oids[D.id]}}if(typeof(D.id)==="undefined"){if(D.name&&D.name in v.oids){D.id=v.oids[D.name]}else{throw {message:"Extension ID not specified.",extension:D}}}if(typeof(D.value)==="undefined"){if(D.name==="keyUsage"){var K=0;var B=0;var C=0;if(D.digitalSignature){B|=128;K=7}if(D.nonRepudiation){B|=64;K=6}if(D.keyEncipherment){B|=32;K=5}if(D.dataEncipherment){B|=16;K=4}if(D.keyAgreement){B|=8;K=3}if(D.keyCertSign){B|=4;K=2}if(D.cRLSign){B|=2;K=1}if(D.encipherOnly){B|=1;K=0}if(D.decipherOnly){C|=128;K=7}var L=String.fromCharCode(K);if(C!==0){L+=String.fromCharCode(B)+String.fromCharCode(C)}else{if(B!==0){L+=String.fromCharCode(B)}}D.value=q.create(q.Class.UNIVERSAL,q.Type.BITSTRING,false,L)}else{if(D.name==="basicConstraints"){D.value=q.create(q.Class.UNIVERSAL,q.Type.SEQUENCE,true,[]);if(D.cA){D.value.value.push(q.create(q.Class.UNIVERSAL,q.Type.BOOLEAN,false,String.fromCharCode(255)))}if("pathLenConstraint" in D){D.value.value.push(q.create(q.Class.UNIVERSAL,q.Type.INTEGER,false,q.integerToDer(D.pathLenConstraint).getBytes()))}}else{if(D.name==="extKeyUsage"){D.value=q.create(q.Class.UNIVERSAL,q.Type.SEQUENCE,true,[]);var I=D.value.value;for(var G in D){if(D[G]!==true){continue}if(G in u){I.push(q.create(q.Class.UNIVERSAL,q.Type.OID,false,q.oidToDer(u[G]).getBytes()))}else{if(G.indexOf(".")!==-1){I.push(q.create(q.Class.UNIVERSAL,q.Type.OID,false,q.oidToDer(G).getBytes()))}}}}else{if(D.name==="nsCertType"){var K=0;var B=0;if(D.client){B|=128;K=7}if(D.server){B|=64;K=6}if(D.email){B|=32;K=5}if(D.objsign){B|=16;K=4}if(D.reserved){B|=8;K=3}if(D.sslCA){B|=4;K=2}if(D.emailCA){B|=2;K=1}if(D.objCA){B|=1;K=0}var L=String.fromCharCode(K);if(B!==0){L+=String.fromCharCode(B)}D.value=q.create(q.Class.UNIVERSAL,q.Type.BITSTRING,false,L)}else{if(D.name==="subjectAltName"||D.name==="issuerAltName"){D.value=q.create(q.Class.UNIVERSAL,q.Type.SEQUENCE,true,[]);var A;for(var H=0;H<D.altNames.length;++H){A=D.altNames[H];var L=A.value;if(A.type===7&&A.ip){L=t.util.bytesFromIP(A.ip);if(L===null){throw {message:'Extension "ip" value is not a valid IPv4 or IPv6 address.',extension:D}}}else{if(A.type===8){if(A.oid){L=q.oidToDer(q.oidToDer(A.oid))}else{L=q.oidToDer(L)}}}D.value.value.push(q.create(q.Class.CONTEXT_SPECIFIC,A.type,false,L))}}else{if(D.name==="subjectKeyIdentifier"){var J=z.generateSubjectKeyIdentifier();D.subjectKeyIdentifier=J.toHex();D.value=q.create(q.Class.UNIVERSAL,q.Type.OCTETSTRING,false,J.getBytes())}}}}}}if(typeof(D.value)==="undefined"){throw {message:"Extension value not specified.",extension:D}}}}z.extensions=E};z.getExtension=function(C){if(typeof C==="string"){C={name:C}}var D=null;var A;for(var B=0;D===null&&B<z.extensions.length;++B){A=z.extensions[B];if(C.id&&A.id===C.id){D=A}else{if(C.name&&A.name===C.name){D=A}}}return D};z.sign=function(C,D){z.md=D||t.md.sha1.create();var A=u[z.md.algorithm+"WithRSAEncryption"];if(!A){throw {message:"Could not compute certificate digest. Unknown message digest algorithm OID.",algorithm:z.md.algorithm}}z.signatureOid=z.siginfo.algorithmOid=A;z.tbsCertificate=v.getTBSCertificate(z);var B=q.toDer(z.tbsCertificate);z.md.update(B.getBytes());z.signature=C.sign(z.md)};z.verify=function(B){var H=false;if(!z.issued(B)){var D=B.issuer;var J=z.subject;throw {message:"The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.",expectedIssuer:D.attributes,actualIssuer:J.attributes}}var E=B.md;if(E===null){if(B.signatureOid in u){var G=u[B.signatureOid];switch(G){case"sha1WithRSAEncryption":E=t.md.sha1.create();break;case"md5WithRSAEncryption":E=t.md.md5.create();break;case"sha256WithRSAEncryption":E=t.md.sha256.create();break;case"RSASSA-PSS":E=t.md.sha256.create();break}}if(E===null){throw {message:"Could not compute certificate digest. Unknown signature OID.",signatureOid:B.signatureOid}}var K=B.tbsCertificate||v.getTBSCertificate(B);var A=q.toDer(K);E.update(A.getBytes())}if(E!==null){var I=undefined;switch(B.signatureOid){case u.sha1WithRSAEncryption:I=undefined;break;case u["RSASSA-PSS"]:var C,F;C=u[B.signatureParameters.mgf.hash.algorithmOid];if(C===undefined||t.md[C]===undefined){throw {message:"Unsupported MGF hash function.",oid:B.signatureParameters.mgf.hash.algorithmOid,name:C}}F=u[B.signatureParameters.mgf.algorithmOid];if(F===undefined||t.mgf[F]===undefined){throw {message:"Unsupported MGF function.",oid:B.signatureParameters.mgf.algorithmOid,name:F}}F=t.mgf[F].create(t.md[C].create());C=u[B.signatureParameters.hash.algorithmOid];if(C===undefined||t.md[C]===undefined){throw {message:"Unsupported RSASSA-PSS hash function.",oid:B.signatureParameters.hash.algorithmOid,name:C}}I=t.pss.create(t.md[C].create(),F,B.signatureParameters.saltLength);break}H=z.publicKey.verify(E.digest().getBytes(),B.signature,I)}return H};z.isIssuer=function(D){var E=false;var A=z.issuer;var F=D.subject;if(A.hash&&F.hash){E=(A.hash===F.hash)}else{if(A.attributes.length===F.attributes.length){E=true;var B,G;for(var C=0;E&&C<A.attributes.length;++C){B=A.attributes[C];G=F.attributes[C];if(B.type!==G.type||B.value!==G.value){E=false}}}}return E};z.issued=function(A){return A.isIssuer(z)};z.generateSubjectKeyIdentifier=function(){var A=q.toDer(v.publicKeyToRSAPublicKey(z.publicKey));var B=t.md.sha1.create();B.update(A.getBytes());return B.digest()};z.verifySubjectKeyIdentifier=function(){var C=u.subjectKeyIdentifier;for(var B=0;B<z.extensions.length;++B){var A=z.extensions[B];if(A.id===C){var D=z.generateSubjectKeyIdentifier().getBytes();return(t.util.hexToBytes(A.subjectKeyIdentifier)===D)}}return false};return z};v.certificateFromAsn1=function(H,D){var A={};var E=[];if(!q.validate(H,y,A,E)){throw {message:"Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.",errors:E}}if(typeof A.certSignature!=="string"){var C="\x00";for(var F=0;F<A.certSignature.length;++F){C+=q.toDer(A.certSignature[F]).getBytes()}A.certSignature=C}var I=q.derToOid(A.publicKeyOid);if(I!==v.oids.rsaEncryption){throw {message:"Cannot read public key. OID is not RSA."}}var B=v.createCertificate();B.version=A.certVersion?A.certVersion.charCodeAt(0):0;var J=t.util.createBuffer(A.certSerialNumber);B.serialNumber=J.toHex();B.signatureOid=t.asn1.derToOid(A.certSignatureOid);B.signatureParameters=n(B.signatureOid,A.certSignatureParams,true);B.siginfo.algorithmOid=t.asn1.derToOid(A.certinfoSignatureOid);B.siginfo.parameters=n(B.siginfo.algorithmOid,A.certinfoSignatureParams,false);var K=t.util.createBuffer(A.certSignature);++K.read;B.signature=K.getBytes();var M=[];if(A.certValidity1UTCTime!==undefined){M.push(q.utcTimeToDate(A.certValidity1UTCTime))}if(A.certValidity2GeneralizedTime!==undefined){M.push(q.generalizedTimeToDate(A.certValidity2GeneralizedTime))}if(A.certValidity3UTCTime!==undefined){M.push(q.utcTimeToDate(A.certValidity3UTCTime))}if(A.certValidity4GeneralizedTime!==undefined){M.push(q.generalizedTimeToDate(A.certValidity4GeneralizedTime))}if(M.length>2){throw {message:"Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate."}}if(M.length<2){throw {message:"Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime."}}B.validity.notBefore=M[0];B.validity.notAfter=M[1];B.tbsCertificate=A.tbsCertificate;if(D){B.md=null;if(B.signatureOid in u){var I=u[B.signatureOid];switch(I){case"sha1WithRSAEncryption":B.md=t.md.sha1.create();break;case"md5WithRSAEncryption":B.md=t.md.md5.create();break;case"sha256WithRSAEncryption":B.md=t.md.sha256.create();break;case"RSASSA-PSS":B.md=t.md.sha256.create();break}}if(B.md===null){throw {message:"Could not compute certificate digest. Unknown signature OID.",signatureOid:B.signatureOid}}var z=q.toDer(B.tbsCertificate);B.md.update(z.getBytes())}var G=t.md.sha1.create();B.issuer.getField=function(N){return k(B.issuer,N)};B.issuer.addField=function(N){j([N]);B.issuer.attributes.push(N)};B.issuer.attributes=v.RDNAttributesAsArray(A.certIssuer,G);if(A.certIssuerUniqueId){B.issuer.uniqueId=A.certIssuerUniqueId}B.issuer.hash=G.digest().toHex();var L=t.md.sha1.create();B.subject.getField=function(N){return k(B.subject,N)};B.subject.addField=function(N){j([N]);B.subject.attributes.push(N)};B.subject.attributes=v.RDNAttributesAsArray(A.certSubject,L);if(A.certSubjectUniqueId){B.subject.uniqueId=A.certSubjectUniqueId}B.subject.hash=L.digest().toHex();if(A.certExtensions){B.extensions=m(A.certExtensions)}else{B.extensions=[]}B.publicKey=v.publicKeyFromAsn1(A.subjectPublicKeyInfo);return B};v.certificationRequestFromAsn1=function(G,B){var A={};var E=[];if(!q.validate(G,s,A,E)){throw {message:"Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.",errors:E}}if(typeof A.csrSignature!=="string"){var D="\x00";for(var F=0;F<A.csrSignature.length;++F){D+=q.toDer(A.csrSignature[F]).getBytes()}A.csrSignature=D}var H=q.derToOid(A.publicKeyOid);if(H!==v.oids.rsaEncryption){throw {message:"Cannot read public key. OID is not RSA."}}var C=v.createCertificationRequest();C.version=A.csrVersion?A.csrVersion.charCodeAt(0):0;C.signatureOid=t.asn1.derToOid(A.csrSignatureOid);C.signatureParameters=n(C.signatureOid,A.csrSignatureParams,true);C.siginfo.algorithmOid=t.asn1.derToOid(A.csrSignatureOid);C.siginfo.parameters=n(C.siginfo.algorithmOid,A.csrSignatureParams,false);var I=t.util.createBuffer(A.csrSignature);++I.read;C.signature=I.getBytes();C.certificationRequestInfo=A.certificationRequestInfo;if(B){C.md=null;if(C.signatureOid in u){var H=u[C.signatureOid];switch(H){case"sha1WithRSAEncryption":C.md=t.md.sha1.create();break;case"md5WithRSAEncryption":C.md=t.md.md5.create();break;case"sha256WithRSAEncryption":C.md=t.md.sha256.create();break;case"RSASSA-PSS":C.md=t.md.sha256.create();break}}if(C.md===null){throw {message:"Could not compute certification request digest. Unknown signature OID.",signatureOid:C.signatureOid}}var z=q.toDer(C.certificationRequestInfo);C.md.update(z.getBytes())}var J=t.md.sha1.create();C.subject.getField=function(K){return k(C.subject,K)};C.subject.addField=function(K){j([K]);C.subject.attributes.push(K)};C.subject.attributes=v.RDNAttributesAsArray(A.certificationRequestInfoSubject,J);C.subject.hash=J.digest().toHex();C.publicKey=v.publicKeyFromAsn1(A.subjectPublicKeyInfo);C.getAttribute=function(K){return k(C.attributes,K)};C.addAttribute=function(K){j([K]);C.attributes.push(K)};C.attributes=v.CRIAttributesAsArray(A.certificationRequestInfoAttributes||[]);return C};v.createCertificationRequest=function(){var z={};z.version=0;z.signatureOid=null;z.signature=null;z.siginfo={};z.siginfo.algorithmOid=null;z.subject={};z.subject.getField=function(A){return k(z.subject,A)};z.subject.addField=function(A){j([A]);z.subject.attributes.push(A)};z.subject.attributes=[];z.subject.hash=null;z.publicKey=null;z.attributes=[];z.getAttribute=function(A){return k(z.attributes,A)};z.addAttribute=function(A){j([A]);z.attributes.push(A)};z.md=null;z.setSubject=function(A){j(A);z.subject.attributes=A;z.subject.hash=null};z.setAttributes=function(A){j(A);z.attributes=A};z.sign=function(C,D){z.md=D||t.md.sha1.create();var A=u[z.md.algorithm+"WithRSAEncryption"];if(!A){throw {message:"Could not compute certification request digest. Unknown message digest algorithm OID.",algorithm:z.md.algorithm}}z.signatureOid=z.siginfo.algorithmOid=A;z.certificationRequestInfo=v.getCertificationRequestInfo(z);var B=q.toDer(z.certificationRequestInfo);z.md.update(B.getBytes());z.signature=C.sign(z.md)};z.verify=function(){var G=false;var D=z.md;if(D===null){if(z.signatureOid in u){var F=u[z.signatureOid];switch(F){case"sha1WithRSAEncryption":D=t.md.sha1.create();break;case"md5WithRSAEncryption":D=t.md.md5.create();break;case"sha256WithRSAEncryption":D=t.md.sha256.create();break;case"RSASSA-PSS":D=t.md.sha256.create();break}}if(D===null){throw {message:"Could not compute certification request digest. Unknown signature OID.",signatureOid:z.signatureOid}}var B=z.certificationRequestInfo||v.getCertificationRequestInfo(z);var A=q.toDer(B);D.update(A.getBytes())}if(D!==null){var H;switch(z.signatureOid){case u.sha1WithRSAEncryption:break;case u["RSASSA-PSS"]:var C,E;C=u[z.signatureParameters.mgf.hash.algorithmOid];if(C===undefined||t.md[C]===undefined){throw {message:"Unsupported MGF hash function.",oid:z.signatureParameters.mgf.hash.algorithmOid,name:C}}E=u[z.signatureParameters.mgf.algorithmOid];if(E===undefined||t.mgf[E]===undefined){throw {message:"Unsupported MGF function.",oid:z.signatureParameters.mgf.algorithmOid,name:E}}E=t.mgf[E].create(t.md[C].create());C=u[z.signatureParameters.hash.algorithmOid];if(C===undefined||t.md[C]===undefined){throw {message:"Unsupported RSASSA-PSS hash function.",oid:z.signatureParameters.hash.algorithmOid,name:C}}H=t.pss.create(t.md[C].create(),E,z.signatureParameters.saltLength);break}G=z.publicKey.verify(D.digest().getBytes(),z.signature,H)}return G};return z};function h(C){var D=q.create(q.Class.UNIVERSAL,q.Type.SEQUENCE,true,[]);var z,E;var A=C.attributes;for(var B=0;B<A.length;++B){z=A[B];var F=z.value;var G=q.Type.PRINTABLESTRING;if("valueTagClass" in z){G=z.valueTagClass;if(G===q.Type.UTF8){F=t.util.encodeUtf8(F)}}E=q.create(q.Class.UNIVERSAL,q.Type.SET,true,[q.create(q.Class.UNIVERSAL,q.Type.SEQUENCE,true,[q.create(q.Class.UNIVERSAL,q.Type.OID,false,q.oidToDer(z.type).getBytes()),q.create(q.Class.UNIVERSAL,G,false,F)])]);D.value.push(E)}return D}function i(A){var D=q.create(q.Class.CONTEXT_SPECIFIC,3,true,[]);var E=q.create(q.Class.UNIVERSAL,q.Type.SEQUENCE,true,[]);D.value.push(E);var z,B;for(var C=0;C<A.length;++C){z=A[C];B=q.create(q.Class.UNIVERSAL,q.Type.SEQUENCE,true,[]);E.value.push(B);B.value.push(q.create(q.Class.UNIVERSAL,q.Type.OID,false,q.oidToDer(z.id).getBytes()));if(z.critical){B.value.push(q.create(q.Class.UNIVERSAL,q.Type.BOOLEAN,false,String.fromCharCode(255)))}var F=z.value;if(typeof z.value!=="string"){F=q.toDer(F).getBytes()}B.value.push(q.create(q.Class.UNIVERSAL,q.Type.OCTETSTRING,false,F))}return D}function l(A){var C={};for(var B=0;B<A.length;++B){var z=A[B];console.log("attr",z);if(z.shortName&&(z.valueTagClass===q.Type.UTF8||z.valueTagClass===q.Type.PRINTABLESTRING||z.valueTagClass===q.Type.IA5String)){var D=z.value;if(z.valueTagClass===q.Type.UTF8){D=t.util.encodeUtf8(z.value)}if(!(z.shortName in C)){C[z.shortName]=D}else{if(t.util.isArray(C[z.shortName])){C[z.shortName].push(D)}else{C[z.shortName]=[C[z.shortName],D]}}}}return C}function j(A){var z;for(var B=0;B<A.length;++B){z=A[B];if(typeof(z.name)==="undefined"){if(z.type&&z.type in v.oids){z.name=v.oids[z.type]}else{if(z.shortName&&z.shortName in o){z.name=v.oids[o[z.shortName]]}}}if(typeof(z.type)==="undefined"){if(z.name&&z.name in v.oids){z.type=v.oids[z.name]}else{throw {message:"Attribute type not specified.",attribute:z}}}if(typeof(z.shortName)==="undefined"){if(z.name&&z.name in o){z.shortName=o[z.name]}}if(typeof(z.value)==="undefined"){throw {message:"Attribute value not specified.",attribute:z}}}}function p(z,A){switch(z){case u["RSASSA-PSS"]:var B=[];if(A.hash.algorithmOid!==undefined){B.push(q.create(q.Class.CONTEXT_SPECIFIC,0,true,[q.create(q.Class.UNIVERSAL,q.Type.SEQUENCE,true,[q.create(q.Class.UNIVERSAL,q.Type.OID,false,q.oidToDer(A.hash.algorithmOid).getBytes()),q.create(q.Class.UNIVERSAL,q.Type.NULL,false,"")])]))}if(A.mgf.algorithmOid!==undefined){B.push(q.create(q.Class.CONTEXT_SPECIFIC,1,true,[q.create(q.Class.UNIVERSAL,q.Type.SEQUENCE,true,[q.create(q.Class.UNIVERSAL,q.Type.OID,false,q.oidToDer(A.mgf.algorithmOid).getBytes()),q.create(q.Class.UNIVERSAL,q.Type.SEQUENCE,true,[q.create(q.Class.UNIVERSAL,q.Type.OID,false,q.oidToDer(A.mgf.hash.algorithmOid).getBytes()),q.create(q.Class.UNIVERSAL,q.Type.NULL,false,"")])])]))}if(A.saltLength!==undefined){B.push(q.create(q.Class.CONTEXT_SPECIFIC,2,true,[q.create(q.Class.UNIVERSAL,q.Type.INTEGER,false,q.integerToDer(A.saltLength).getBytes())]))}return q.create(q.Class.UNIVERSAL,q.Type.SEQUENCE,true,B);default:return q.create(q.Class.UNIVERSAL,q.Type.NULL,false,"")}}function g(B){var D=q.create(q.Class.CONTEXT_SPECIFIC,0,true,[]);if(B.attributes.length===0){return D}var A=B.attributes;for(var C=0;C<A.length;++C){var z=A[C];var F=z.value;var G=q.Type.UTF8;if("valueTagClass" in z){G=z.valueTagClass}if(G===q.Type.UTF8){F=t.util.encodeUtf8(F)}var E=q.create(q.Class.UNIVERSAL,q.Type.SEQUENCE,true,[q.create(q.Class.UNIVERSAL,q.Type.OID,false,q.oidToDer(z.type).getBytes()),q.create(q.Class.UNIVERSAL,q.Type.SET,true,[q.create(q.Class.UNIVERSAL,G,false,F)])]);D.value.push(E)}return D}v.getTBSCertificate=function(z){var A=q.create(q.Class.UNIVERSAL,q.Type.SEQUENCE,true,[q.create(q.Class.CONTEXT_SPECIFIC,0,true,[q.create(q.Class.UNIVERSAL,q.Type.INTEGER,false,q.integerToDer(z.version).getBytes())]),q.create(q.Class.UNIVERSAL,q.Type.INTEGER,false,t.util.hexToBytes(z.serialNumber)),q.create(q.Class.UNIVERSAL,q.Type.SEQUENCE,true,[q.create(q.Class.UNIVERSAL,q.Type.OID,false,q.oidToDer(z.siginfo.algorithmOid).getBytes()),p(z.siginfo.algorithmOid,z.siginfo.parameters)]),h(z.issuer),q.create(q.Class.UNIVERSAL,q.Type.SEQUENCE,true,[q.create(q.Class.UNIVERSAL,q.Type.UTCTIME,false,q.dateToUtcTime(z.validity.notBefore)),q.create(q.Class.UNIVERSAL,q.Type.UTCTIME,false,q.dateToUtcTime(z.validity.notAfter))]),h(z.subject),v.publicKeyToAsn1(z.publicKey)]);if(z.issuer.uniqueId){A.value.push(q.create(q.Class.CONTEXT_SPECIFIC,1,true,[q.create(q.Class.UNIVERSAL,q.Type.BITSTRING,false,String.fromCharCode(0)+z.issuer.uniqueId)]))}if(z.subject.uniqueId){A.value.push(q.create(q.Class.CONTEXT_SPECIFIC,2,true,[q.create(q.Class.UNIVERSAL,q.Type.BITSTRING,false,String.fromCharCode(0)+z.subject.uniqueId)]))}if(z.extensions.length>0){A.value.push(i(z.extensions))}return A};v.getCertificationRequestInfo=function(A){var z=q.create(q.Class.UNIVERSAL,q.Type.SEQUENCE,true,[q.create(q.Class.UNIVERSAL,q.Type.INTEGER,false,q.integerToDer(A.version).getBytes()),h(A.subject),v.publicKeyToAsn1(A.publicKey),g(A)]);return z};v.distinguishedNameToAsn1=function(z){return h(z)};v.certificateToAsn1=function(z){var A=z.tbsCertificate||v.getTBSCertificate(z);return q.create(q.Class.UNIVERSAL,q.Type.SEQUENCE,true,[A,q.create(q.Class.UNIVERSAL,q.Type.SEQUENCE,true,[q.create(q.Class.UNIVERSAL,q.Type.OID,false,q.oidToDer(z.signatureOid).getBytes()),p(z.signatureOid,z.signatureParameters)]),q.create(q.Class.UNIVERSAL,q.Type.BITSTRING,false,String.fromCharCode(0)+z.signature)])};v.certificationRequestToAsn1=function(A){var z=A.certificationRequestInfo||v.getCertificationRequestInfo(A);return q.create(q.Class.UNIVERSAL,q.Type.SEQUENCE,true,[z,q.create(q.Class.UNIVERSAL,q.Type.SEQUENCE,true,[q.create(q.Class.UNIVERSAL,q.Type.OID,false,q.oidToDer(A.signatureOid).getBytes()),p(A.signatureOid,A.signatureParameters)]),q.create(q.Class.UNIVERSAL,q.Type.BITSTRING,false,String.fromCharCode(0)+A.signature)])};v.createCaStore=function(B){var z={certs:{}};z.getIssuer=function(D){var F=null;if(!D.issuer.hash){var E=t.md.sha1.create();D.issuer.attributes=v.RDNAttributesAsArray(h(D.issuer),E);D.issuer.hash=E.digest().toHex()}if(D.issuer.hash in z.certs){F=z.certs[D.issuer.hash];if(t.util.isArray(F)){throw {message:"Resolving multiple issuer matches not implemented yet."}}}return F};z.addCertificate=function(D){if(typeof D==="string"){D=t.pki.certificateFromPem(D)}if(!D.subject.hash){var E=t.md.sha1.create();D.subject.attributes=v.RDNAttributesAsArray(h(D.subject),E);D.subject.hash=E.digest().toHex()}if(D.subject.hash in z.certs){var F=z.certs[D.subject.hash];if(!t.util.isArray(F)){F=[F]}F.push(D)}else{z.certs[D.subject.hash]=D}};if(B){for(var C=0;C<B.length;++C){var A=B[C];z.addCertificate(A)}}return z};v.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"};v.verifyCertificateChain=function(A,D,T){D=D.slice(0);var C=D.slice(0);var M=new Date();var I=true;var F=null;var E=0;var N=null;do{var B=D.shift();if(M<B.validity.notBefore||M>B.validity.notAfter){F={message:"Certificate is not valid yet or has expired.",error:v.certificateError.certificate_expired,notBefore:B.validity.notBefore,notAfter:B.validity.notAfter,now:M}}else{var S=false;if(D.length>0){N=D[0];try{S=N.verify(B)}catch(G){}}else{var O=A.getIssuer(B);if(O===null){F={message:"Certificate is not trusted.",error:v.certificateError.unknown_ca}}else{if(!t.util.isArray(O)){O=[O]}while(!S&&O.length>0){N=O.shift();try{S=N.verify(B)}catch(G){}}}}if(F===null&&!S){F={message:"Certificate signature is invalid.",error:v.certificateError.bad_certificate}}}if(F===null&&!B.isIssuer(N)){F={message:"Certificate issuer is invalid.",error:v.certificateError.bad_certificate}}if(F===null){var Q={keyUsage:true,basicConstraints:true};for(var J=0;F===null&&J<B.extensions.length;++J){var H=B.extensions[J];if(H.critical&&!(H.name in Q)){F={message:"Certificate has an unsupported critical extension.",error:v.certificateError.unsupported_certificate}}}}if(!I||(D.length===0&&!N)){var z=B.getExtension("basicConstraints");var K=B.getExtension("keyUsage");if(K!==null){if(!K.keyCertSign||z===null){F={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:v.certificateError.bad_certificate}}}if(F===null&&z!==null&&!z.cA){F={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:v.certificateError.bad_certificate}}if(F===null&&K!==null&&"pathLenConstraint" in z){var R=0;for(var J=1;J<D.length-1;++J){if(D[J].isIssuer(D[J])){++R}}var L=z.pathLenConstraint+1;if((D.length-R)>L){F={message:"Certificate basicConstraints pathLenConstraint violated.",error:v.certificateError.bad_certificate}}}}var U=(F===null)?true:F.error;var P=T?T(U,E,C):U;if(P===true){F=null}else{if(U===true){F={message:"The application rejected the certificate.",error:v.certificateError.bad_certificate}}if(P||P===0){if(typeof P==="object"&&!t.util.isArray(P)){if(P.message){F.message=P.message}if(P.error){F.error=P.error}}else{if(typeof P==="string"){F.error=P}}}throw F}I=false;++E}while(D.length>0);return true}}var d="x509";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var e=true;define=function(h,g){g(require,module)}}else{if(typeof forge==="undefined"){forge={}}return c(forge)}}var b;var a=function(h,g){g.exports=function(j){var l=b.map(function(i){return h(i)}).concat(c);j=j||{};j.defined=j.defined||{};if(j.defined[d]){return j[d]}j.defined[d]=true;for(var k=0;k<l.length;++k){l[k](j)}return j.pki}};var f=define;define=function(h,g){b=(typeof h==="string")?g.slice(2):h.slice(2);if(e){delete define;return f.apply(null,Array.prototype.slice.call(arguments,0))}define=f;return define.apply(null,Array.prototype.slice.call(arguments,0))};define(["require","module","./aes","./asn1","./des","./md","./mgf","./oids","./pem","./pss","./rsa","./util"],function(){a.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function c(h){var g=h.asn1;var i=h.pki=h.pki||{};i.pemToDer=function(k){var j=h.pem.decode(k)[0];if(j.procType&&j.procType.type==="ENCRYPTED"){throw {message:"Could not convert PEM to DER; PEM is encrypted."}}return h.util.createBuffer(j.body)};i.privateKeyFromPem=function(l){var j=h.pem.decode(l)[0];if(j.type!=="PRIVATE KEY"&&j.type!=="RSA PRIVATE KEY"){throw {message:'Could not convert private key from PEM; PEM header type is not "PRIVATE KEY" or "RSA PRIVATE KEY".',headerType:j.type}}if(j.procType&&j.procType.type==="ENCRYPTED"){throw {message:"Could not convert private key from PEM; PEM is encrypted."}}var k=g.fromDer(j.body);return i.privateKeyFromAsn1(k)};i.privateKeyToPem=function(j,k){var l={type:"RSA PRIVATE KEY",body:g.toDer(i.privateKeyToAsn1(j)).getBytes()};return h.pem.encode(l,{maxline:k})}}var d="pki";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var e=true;define=function(h,g){g(require,module)}}else{if(typeof forge==="undefined"){forge={}}return c(forge)}}var b;var a=function(h,g){g.exports=function(j){var l=b.map(function(i){return h(i)}).concat(c);j=j||{};j.defined=j.defined||{};if(j.defined[d]){return j[d]}j.defined[d]=true;for(var k=0;k<l.length;++k){l[k](j)}return j[d]}};var f=define;define=function(h,g){b=(typeof h==="string")?g.slice(2):h.slice(2);if(e){delete define;return f.apply(null,Array.prototype.slice.call(arguments,0))}define=f;return define.apply(null,Array.prototype.slice.call(arguments,0))};define(["require","module","./asn1","./oids","./pbe","./pem","./pbkdf2","./pkcs12","./pss","./rsa","./util","./x509"],function(){a.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function c(H){var N=function(am,ae,an,af){var aj=H.util.createBuffer();var ad=(am.length>>1);var aq=ad+(am.length&1);var ak=am.substr(0,aq);var al=am.substr(ad,aq);var aa=H.util.createBuffer();var ab=H.hmac.create();an=ae+an;var ah=Math.ceil(af/16);var ap=Math.ceil(af/20);ab.start("MD5",ak);var ag=H.util.createBuffer();aa.putBytes(an);for(var ac=0;ac<ah;++ac){ab.start(null,null);ab.update(aa.getBytes());aa.putBuffer(ab.digest());ab.start(null,null);ab.update(aa.bytes()+an);ag.putBuffer(ab.digest())}ab.start("SHA1",al);var ao=H.util.createBuffer();aa.clear();aa.putBytes(an);for(var ac=0;ac<ap;++ac){ab.start(null,null);ab.update(aa.getBytes());aa.putBuffer(ab.digest());ab.start(null,null);ab.update(aa.bytes()+an);ao.putBuffer(ab.digest())}aj.putBytes(H.util.xorBytes(ag.getBytes(),ao.getBytes(),af));return aj};var M=function(ac,aa,ad,ab){};var I=function(ac,ae,ad){var ab=H.hmac.create();ab.start("SHA1",ac);var aa=H.util.createBuffer();aa.putInt32(ae[0]);aa.putInt32(ae[1]);aa.putByte(ad.type);aa.putByte(ad.version.major);aa.putByte(ad.version.minor);aa.putInt16(ad.length);aa.putBytes(ad.fragment.bytes());ab.update(aa.getBytes());return ab.digest().getBytes()};var s=function(ab,ad,af){var ae=false;try{var aa=ab.deflate(ad.fragment.getBytes());ad.fragment=H.util.createBuffer(aa);ad.length=aa.length;ae=true}catch(ac){}return ae};var K=function(ab,ad,af){var ae=false;try{var aa=ab.inflate(ad.fragment.getBytes());ad.fragment=H.util.createBuffer(aa);ad.length=aa.length;ae=true}catch(ac){}return ae};var O=function(aa,ac){var ab=0;switch(ac){case 1:ab=aa.getByte();break;case 2:ab=aa.getInt16();break;case 3:ab=aa.getInt24();break;case 4:ab=aa.getInt32();break}return H.util.createBuffer(aa.getBytes(ab))};var Z=function(aa,ab,ac){aa.putInt(ac.length(),ab<<3);aa.putBuffer(ac)};var Y={};Y.Version={major:3,minor:1};Y.MaxFragment=(1<<14)-1024;Y.ConnectionEnd={server:0,client:1};Y.PRFAlgorithm={tls_prf_sha256:0};Y.BulkCipherAlgorithm={none:null,rc4:0,des3:1,aes:2};Y.CipherType={stream:0,block:1,aead:2};Y.MACAlgorithm={none:null,hmac_md5:0,hmac_sha1:1,hmac_sha256:2,hmac_sha384:3,hmac_sha512:4};Y.CompressionMethod={none:0,deflate:1};Y.ContentType={change_cipher_spec:20,alert:21,handshake:22,application_data:23};Y.HandshakeType={hello_request:0,client_hello:1,server_hello:2,certificate:11,server_key_exchange:12,certificate_request:13,server_hello_done:14,certificate_verify:15,client_key_exchange:16,finished:20};Y.Alert={};Y.Alert.Level={warning:1,fatal:2};Y.Alert.Description={close_notify:0,unexpected_message:10,bad_record_mac:20,decryption_failed:21,record_overflow:22,decompression_failure:30,handshake_failure:40,bad_certificate:42,unsupported_certificate:43,certificate_revoked:44,certificate_expired:45,certificate_unknown:46,illegal_parameter:47,unknown_ca:48,access_denied:49,decode_error:50,decrypt_error:51,export_restriction:60,protocol_version:70,insufficient_security:71,internal_error:80,user_canceled:90,no_renegotiation:100};Y.CipherSuites={};Y.getCipherSuite=function(ad){var ac=null;for(var ab in Y.CipherSuites){var aa=Y.CipherSuites[ab];if(aa.id[0]===ad.charCodeAt(0)&&aa.id[1]===ad.charCodeAt(1)){ac=aa;break}}return ac};Y.handleUnexpected=function(aa,ac){var ab=(!aa.open&&aa.entity===Y.ConnectionEnd.client);if(!ab){aa.error(aa,{message:"Unexpected message. Received TLS record out of order.",send:true,alert:{level:Y.Alert.Level.fatal,description:Y.Alert.Description.unexpected_message}})}};Y.handleHelloRequest=function(aa,ac,ab){if(!aa.handshaking&&aa.handshakes>0){Y.queue(aa,Y.createAlert({level:Y.Alert.Level.warning,description:Y.Alert.Description.no_renegotiation}));Y.flush(aa)}aa.process()};Y.parseHelloMessage=function(ab,ai,ag){var ah=null;var ac=(ab.entity===Y.ConnectionEnd.client);if(ag<38){ab.error(ab,{message:ac?"Invalid ServerHello message. Message too short.":"Invalid ClientHello message. Message too short.",send:true,alert:{level:Y.Alert.Level.fatal,description:Y.Alert.Description.illegal_parameter}})}else{var aa=ai.fragment;var aj=aa.length();ah={version:{major:aa.getByte(),minor:aa.getByte()},random:H.util.createBuffer(aa.getBytes(32)),session_id:O(aa,1),extensions:[]};if(ac){ah.cipher_suite=aa.getBytes(2);ah.compression_method=aa.getByte()}else{ah.cipher_suites=O(aa,2);ah.compression_methods=O(aa,1)}aj=ag-(aj-aa.length());if(aj>0){var ae=O(aa,2);while(ae.length()>0){ah.extensions.push({type:[ae.getByte(),ae.getByte()],data:O(ae,2)})}if(!ac){for(var af=0;af<ah.extensions.length;++af){var ad=ah.extensions[af];if(ad.type[0]===0&&ad.type[1]===0){var ak=O(ad.data,2);while(ak.length()>0){var al=ak.getByte();if(al!==0){break}ab.session.serverNameList.push(O(ak,2).getBytes())}}}}}if(ah.version.major!==Y.Version.major||ah.version.minor!==Y.Version.minor){ab.error(ab,{message:"Incompatible TLS version.",send:true,alert:{level:Y.Alert.Level.fatal,description:Y.Alert.Description.protocol_version}})}if(ac){ab.session.cipherSuite=Y.getCipherSuite(ah.cipher_suite)}else{var am=H.util.createBuffer(ah.cipher_suites.bytes());while(am.length()>0){ab.session.cipherSuite=Y.getCipherSuite(am.getBytes(2));if(ab.session.cipherSuite!==null){break}}}if(ab.session.cipherSuite===null){return ab.error(ab,{message:"No cipher suites in common.",send:true,alert:{level:Y.Alert.Level.fatal,description:Y.Alert.Description.handshake_failure},cipherSuite:H.util.bytesToHex(ah.cipher_suite)})}if(ac){ab.session.compressionMethod=ah.compression_method}else{ab.session.compressionMethod=Y.CompressionMethod.none}}return ah};Y.createSecurityParameters=function(aa,ad){var ab=(aa.entity===Y.ConnectionEnd.client);var ae=ad.random.bytes();var ac=ab?aa.session.sp.client_random:ae;var af=ab?ae:Y.createRandom().getBytes();aa.session.sp={entity:aa.entity,prf_algorithm:Y.PRFAlgorithm.tls_prf_sha256,bulk_cipher_algorithm:null,cipher_type:null,enc_key_length:null,block_length:null,fixed_iv_length:null,record_iv_length:null,mac_algorithm:null,mac_length:null,mac_key_length:null,compression_algorithm:aa.session.compressionMethod,pre_master_secret:null,master_secret:null,client_random:ac,server_random:af}};Y.handleServerHello=function(aa,ad,ab){var ac=Y.parseHelloMessage(aa,ad,ab);if(!aa.fail){var ae=ac.session_id.bytes();if(ae.length>0&&ae===aa.session.id){aa.expect=Q;aa.session.resuming=true;aa.session.sp.server_random=ac.random.bytes()}else{aa.expect=R;aa.session.resuming=false;Y.createSecurityParameters(aa,ac)}aa.session.id=ae;aa.process()}};Y.handleClientHello=function(aa,ad,ab){var ac=Y.parseHelloMessage(aa,ad,ab);if(!aa.fail){var af=ac.session_id.bytes();var ae=null;if(aa.sessionCache){ae=aa.sessionCache.getSession(af);if(ae===null){af=""}}if(af.length===0){af=H.random.getBytes(32)}aa.session.id=af;aa.session.clientHelloVersion=ac.version;aa.session.sp=ae?ae.sp:{};if(ae!==null){aa.expect=k;aa.session.resuming=true;aa.session.sp.client_random=ac.random.bytes()}else{aa.expect=(aa.verifyClient!==false)?l:q;aa.session.resuming=false;Y.createSecurityParameters(aa,ac)}aa.open=true;Y.queue(aa,Y.createRecord({type:Y.ContentType.handshake,data:Y.createServerHello(aa)}));if(aa.session.resuming){Y.queue(aa,Y.createRecord({type:Y.ContentType.change_cipher_spec,data:Y.createChangeCipherSpec()}));aa.state.pending=Y.createConnectionState(aa);aa.state.current.write=aa.state.pending.write;Y.queue(aa,Y.createRecord({type:Y.ContentType.handshake,data:Y.createFinished(aa)}))}else{Y.queue(aa,Y.createRecord({type:Y.ContentType.handshake,data:Y.createCertificate(aa)}));if(!aa.fail){Y.queue(aa,Y.createRecord({type:Y.ContentType.handshake,data:Y.createServerKeyExchange(aa)}));if(aa.verifyClient!==false){Y.queue(aa,Y.createRecord({type:Y.ContentType.handshake,data:Y.createCertificateRequest(aa)}))}Y.queue(aa,Y.createRecord({type:Y.ContentType.handshake,data:Y.createServerHelloDone(aa)}))}}Y.flush(aa);aa.process()}};Y.handleCertificate=function(ac,aj,ah){if(ah<3){ac.error(ac,{message:"Invalid Certificate message. Message too short.",send:true,alert:{level:Y.Alert.Level.fatal,description:Y.Alert.Description.illegal_parameter}})}else{var ab=aj.fragment;var ai={certificate_list:O(ab,3)};var ad,aa;var ae=[];try{while(ai.certificate_list.length()>0){ad=O(ai.certificate_list,3);aa=H.asn1.fromDer(ad);ad=H.pki.certificateFromAsn1(aa,true);ae.push(ad)}}catch(ag){ac.error(ac,{message:"Could not parse certificate list.",cause:ag,send:true,alert:{level:Y.Alert.Level.fatal,description:Y.Alert.Description.bad_certificate}})}if(!ac.fail){var af=(ac.entity===Y.ConnectionEnd.client);if((af||ac.verifyClient===true)&&ae.length===0){ac.error(ac,{message:af?"No server certificate provided.":"No client certificate provided.",send:true,alert:{level:Y.Alert.Level.fatal,description:Y.Alert.Description.illegal_parameter}})}else{if(ae.length===0){ac.expect=af?X:q}else{if(af){ac.session.serverCertificate=ae[0]}else{ac.session.clientCertificate=ae[0]}if(Y.verifyCertificateChain(ac,ae)){ac.expect=af?X:q}}}ac.process()}}};Y.handleServerKeyExchange=function(aa,ac,ab){if(ab>0){aa.error(aa,{message:"Invalid key parameters. Only RSA is supported.",send:true,alert:{level:Y.Alert.Level.fatal,description:Y.Alert.Description.unsupported_certificate}})}else{aa.expect=S;aa.process()}};Y.handleClientKeyExchange=function(ab,ag,ad){if(ad<48){ab.error(ab,{message:"Invalid key parameters. Only RSA is supported.",send:true,alert:{level:Y.Alert.Level.fatal,description:Y.Alert.Description.unsupported_certificate}})}else{var aa=ag.fragment;var ae={enc_pre_master_secret:O(aa,2).getBytes()};var af=null;if(ab.getPrivateKey){try{af=ab.getPrivateKey(ab,ab.session.serverCertificate);af=H.pki.privateKeyFromPem(af)}catch(ac){ab.error(ab,{message:"Could not get private key.",cause:ac,send:true,alert:{level:Y.Alert.Level.fatal,description:Y.Alert.Description.internal_error}})}}if(af===null){ab.error(ab,{message:"No private key set.",send:true,alert:{level:Y.Alert.Level.fatal,description:Y.Alert.Description.internal_error}})}else{try{var ah=ab.session.sp;ah.pre_master_secret=af.decrypt(ae.enc_pre_master_secret);var ai=ab.session.clientHelloVersion;if(ai.major!==ah.pre_master_secret.charCodeAt(0)||ai.minor!==ah.pre_master_secret.charCodeAt(1)){throw {message:"TLS version rollback attack detected."}}}catch(ac){ah.pre_master_secret=H.random.getBytes(48)}}}if(!ab.fail){ab.expect=k;if(ab.session.clientCertificate!==null){ab.expect=m}ab.process()}};Y.handleCertificateRequest=function(ab,ae,ac){if(ac<3){ab.error(ab,{message:"Invalid CertificateRequest. Message too short.",send:true,alert:{level:Y.Alert.Level.fatal,description:Y.Alert.Description.illegal_parameter}})}else{var aa=ae.fragment;var ad={certificate_types:O(aa,1),certificate_authorities:O(aa,2)};ab.session.certificateRequest=ad;ab.expect=V;ab.process()}};Y.handleCertificateVerify=function(ab,ah,ae){if(ae<2){ab.error(ab,{message:"Invalid CertificateVerify. Message too short.",send:true,alert:{level:Y.Alert.Level.fatal,description:Y.Alert.Description.illegal_parameter}})}else{var aa=ah.fragment;aa.read-=4;var ag=aa.bytes();aa.read+=4;var af={signature:O(aa,2).getBytes()};var ai=H.util.createBuffer();ai.putBuffer(ab.session.md5.digest());ai.putBuffer(ab.session.sha1.digest());ai=ai.getBytes();try{var ac=ab.session.clientCertificate;if(!ac.publicKey.verify(ai,af.signature,"NONE")){throw {message:"CertificateVerify signature does not match."}}ab.session.md5.update(ag);ab.session.sha1.update(ag)}catch(ad){ab.error(ab,{message:"Bad signature in CertificateVerify.",send:true,alert:{level:Y.Alert.Level.fatal,description:Y.Alert.Description.handshake_failure}})}if(!ab.fail){ab.expect=k;ab.process()}}};Y.handleServerHelloDone=function(aa,ae,ad){if(ad>0){aa.error(aa,{message:"Invalid ServerHelloDone message. Invalid length.",send:true,alert:{level:Y.Alert.Level.fatal,description:Y.Alert.Description.record_overflow}})}else{if(aa.serverCertificate===null){var ac={message:"No server certificate provided. Not enough security.",send:true,alert:{level:Y.Alert.Level.fatal,description:Y.Alert.Description.insufficient_security}};var af=aa.verify(aa,ac.alert.description,depth,[]);if(af===true){ac=null}else{if(af||af===0){if(typeof af==="object"&&!H.util.isArray(af)){if(af.message){ac.message=af.message}if(af.alert){ac.alert.description=af.alert}}else{if(typeof af==="number"){ac.alert.description=af}}}aa.error(aa,ac)}}}if(!aa.fail&&aa.session.certificateRequest!==null){ae=Y.createRecord({type:Y.ContentType.handshake,data:Y.createCertificate(aa)});Y.queue(aa,ae)}if(!aa.fail){ae=Y.createRecord({type:Y.ContentType.handshake,data:Y.createClientKeyExchange(aa)});Y.queue(aa,ae);aa.expect=T;var ab=function(ag,ah){if(ag.session.certificateRequest!==null&&ag.session.clientCertificate!==null){Y.queue(ag,Y.createRecord({type:Y.ContentType.handshake,data:Y.createCertificateVerify(ag,ah)}))}Y.queue(ag,Y.createRecord({type:Y.ContentType.change_cipher_spec,data:Y.createChangeCipherSpec()}));ag.state.pending=Y.createConnectionState(ag);ag.state.current.write=ag.state.pending.write;Y.queue(ag,Y.createRecord({type:Y.ContentType.handshake,data:Y.createFinished(ag)}));ag.expect=Q;Y.flush(ag);ag.process()};if(aa.session.certificateRequest===null||aa.session.clientCertificate===null){ab(aa,null)}else{Y.getClientSignature(aa,ab)}}};Y.handleChangeCipherSpec=function(aa,ac){if(ac.fragment.getByte()!==1){aa.error(aa,{message:"Invalid ChangeCipherSpec message received.",send:true,alert:{level:Y.Alert.Level.fatal,description:Y.Alert.Description.illegal_parameter}})}else{var ab=(aa.entity===Y.ConnectionEnd.client);if((aa.session.resuming&&ab)||(!aa.session.resuming&&!ab)){aa.state.pending=Y.createConnectionState(aa)}aa.state.current.read=aa.state.pending.read;if((!aa.session.resuming&&ab)||(aa.session.resuming&&!ab)){aa.state.pending=null}aa.expect=ab?U:o;aa.process()}};Y.handleFinished=function(ab,ah,ae){var aa=ah.fragment;aa.read-=4;var af=aa.bytes();aa.read+=4;var aj=ah.fragment.getBytes();aa=H.util.createBuffer();aa.putBuffer(ab.session.md5.digest());aa.putBuffer(ab.session.sha1.digest());var ac=(ab.entity===Y.ConnectionEnd.client);var ad=ac?"server finished":"client finished";var ai=ab.session.sp;var ak=12;var ag=N;aa=ag(ai.master_secret,ad,aa.getBytes(),ak);if(aa.getBytes()!==aj){ab.error(ab,{message:"Invalid verify_data in Finished message.",send:true,alert:{level:Y.Alert.Level.fatal,description:Y.Alert.Description.decrypt_error}})}else{ab.session.md5.update(af);ab.session.sha1.update(af);if((ab.session.resuming&&ac)||(!ab.session.resuming&&!ac)){Y.queue(ab,Y.createRecord({type:Y.ContentType.change_cipher_spec,data:Y.createChangeCipherSpec()}));ab.state.current.write=ab.state.pending.write;ab.state.pending=null;Y.queue(ab,Y.createRecord({type:Y.ContentType.handshake,data:Y.createFinished(ab)}))}ab.expect=ac?P:j;ab.handshaking=false;++ab.handshakes;ab.peerCertificate=ac?ab.session.serverCertificate:ab.session.clientCertificate;if(ab.sessionCache){ab.session={id:ab.session.id,sp:ab.session.sp};ab.session.sp.keys=null}else{ab.session=null}Y.flush(ab);ab.isConnected=true;ab.connected(ab);ab.process()}};Y.handleAlert=function(ac,ae){var ab=ae.fragment;var aa={level:ab.getByte(),description:ab.getByte()};var ad;switch(aa.description){case Y.Alert.Description.close_notify:ad="Connection closed.";break;case Y.Alert.Description.unexpected_message:ad="Unexpected message.";break;case Y.Alert.Description.bad_record_mac:ad="Bad record MAC.";break;case Y.Alert.Description.decryption_failed:ad="Decryption failed.";break;case Y.Alert.Description.record_overflow:ad="Record overflow.";break;case Y.Alert.Description.decompression_failure:ad="Decompression failed.";break;case Y.Alert.Description.handshake_failure:ad="Handshake failure.";break;case Y.Alert.Description.bad_certificate:ad="Bad certificate.";break;case Y.Alert.Description.unsupported_certificate:ad="Unsupported certificate.";break;case Y.Alert.Description.certificate_revoked:ad="Certificate revoked.";break;case Y.Alert.Description.certificate_expired:ad="Certificate expired.";break;case Y.Alert.Description.certificate_unknown:ad="Certificate unknown.";break;case Y.Alert.Description.illegal_parameter:ad="Illegal parameter.";break;case Y.Alert.Description.unknown_ca:ad="Unknown certificate authority.";break;case Y.Alert.Description.access_denied:ad="Access denied.";break;case Y.Alert.Description.decode_error:ad="Decode error.";break;case Y.Alert.Description.decrypt_error:ad="Decrypt error.";break;case Y.Alert.Description.export_restriction:ad="Export restriction.";break;case Y.Alert.Description.protocol_version:ad="Unsupported protocol version.";break;case Y.Alert.Description.insufficient_security:ad="Insufficient security.";break;case Y.Alert.Description.internal_error:ad="Internal error.";break;case Y.Alert.Description.user_canceled:ad="User canceled.";break;case Y.Alert.Description.no_renegotiation:ad="Renegotiation not supported.";break;default:ad="Unknown error.";break}if(aa.description===Y.Alert.Description.close_notify){ac.close()}else{ac.error(ac,{message:ad,send:false,origin:(ac.entity===Y.ConnectionEnd.client)?"server":"client",alert:aa});ac.process()}};Y.handleHandshake=function(ac,ae){var aa=ae.fragment;var af=aa.getByte();var ad=aa.getInt24();if(ad>aa.length()){ac.fragmented=ae;ae.fragment=H.util.createBuffer();aa.read-=4;ac.process()}else{ac.fragmented=null;aa.read-=4;var ab=aa.bytes(ad+4);aa.read+=4;if(af in J[ac.entity][ac.expect]){if(ac.entity===Y.ConnectionEnd.server&&!ac.open&&!ac.fail){ac.handshaking=true;ac.session={serverNameList:[],cipherSuite:null,compressionMethod:null,serverCertificate:null,clientCertificate:null,md5:H.md.md5.create(),sha1:H.md.sha1.create()}}if(af!==Y.HandshakeType.hello_request&&af!==Y.HandshakeType.certificate_verify&&af!==Y.HandshakeType.finished){ac.session.md5.update(ab);ac.session.sha1.update(ab)}J[ac.entity][ac.expect][af](ac,ae,ad)}else{Y.handleUnexpected(ac,ae)}}};Y.handleApplicationData=function(aa,ab){aa.data.putBuffer(ab.fragment);aa.dataReady(aa);aa.process()};var W=0;var R=1;var X=2;var S=3;var V=4;var Q=5;var U=6;var P=7;var T=8;var p=0;var l=1;var q=2;var m=3;var k=4;var o=5;var j=6;var n=7;var g=Y.handleUnexpected;var t=Y.handleChangeCipherSpec;var u=Y.handleAlert;var v=Y.handleHandshake;var w=Y.handleApplicationData;var r=[];r[Y.ConnectionEnd.client]=[[g,u,v,g],[g,u,v,g],[g,u,v,g],[g,u,v,g],[g,u,v,g],[t,u,g,g],[g,u,v,g],[g,u,v,w],[g,u,v,g]];r[Y.ConnectionEnd.server]=[[g,u,v,g],[g,u,v,g],[g,u,v,g],[g,u,v,g],[t,u,g,g],[g,u,v,g],[g,u,v,w],[g,u,v,g]];var x=Y.handleHelloRequest;var y=Y.handleServerHello;var z=Y.handleCertificate;var A=Y.handleServerKeyExchange;var B=Y.handleCertificateRequest;var C=Y.handleServerHelloDone;var D=Y.handleFinished;var J=[];J[Y.ConnectionEnd.client]=[[g,g,y,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g],[x,g,g,g,g,g,g,g,g,g,g,z,A,B,C,g,g,g,g,g,g],[x,g,g,g,g,g,g,g,g,g,g,g,A,B,C,g,g,g,g,g,g],[x,g,g,g,g,g,g,g,g,g,g,g,g,B,C,g,g,g,g,g,g],[x,g,g,g,g,g,g,g,g,g,g,g,g,g,C,g,g,g,g,g,g],[x,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g],[x,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,D],[x,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g],[x,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g]];var E=Y.handleClientHello;var F=Y.handleClientKeyExchange;var G=Y.handleCertificateVerify;J[Y.ConnectionEnd.server]=[[g,E,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g],[g,g,g,g,g,g,g,g,g,g,g,z,g,g,g,g,g,g,g,g,g],[g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,F,g,g,g,g],[g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,G,g,g,g,g,g],[g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g],[g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,D],[g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g],[g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g]];Y.generateKeys=function(aa,af){var ad=N;var ae=af.client_random+af.server_random;if(!aa.session.resuming){af.master_secret=ad(af.pre_master_secret,"master secret",ae,48).bytes();af.pre_master_secret=null}ae=af.server_random+af.client_random;var ac=2*af.mac_key_length+2*af.enc_key_length+2*af.fixed_iv_length;var ab=ad(af.master_secret,"key expansion",ae,ac);return{client_write_MAC_key:ab.getBytes(af.mac_key_length),server_write_MAC_key:ab.getBytes(af.mac_key_length),client_write_key:ab.getBytes(af.enc_key_length),server_write_key:ab.getBytes(af.enc_key_length),client_write_IV:ab.getBytes(af.fixed_iv_length),server_write_IV:ab.getBytes(af.fixed_iv_length)}};Y.createConnectionState=function(aa){var ab=(aa.entity===Y.ConnectionEnd.client);var ac=function(){var af={sequenceNumber:[0,0],macKey:null,macLength:0,macFunction:null,cipherState:null,cipherFunction:function(ag){return true},compressionState:null,compressFunction:function(ag){return true},updateSequenceNumber:function(){if(af.sequenceNumber[1]===4294967295){af.sequenceNumber[1]=0;++af.sequenceNumber[0]}else{++af.sequenceNumber[1]}}};return af};var ae={read:ac(),write:ac()};ae.read.update=function(af,ag){if(!ae.read.cipherFunction(ag,ae.read)){af.error(af,{message:"Could not decrypt record or bad MAC.",send:true,alert:{level:Y.Alert.Level.fatal,description:Y.Alert.Description.bad_record_mac}})}else{if(!ae.read.compressFunction(af,ag,ae.read)){af.error(af,{message:"Could not decompress record.",send:true,alert:{level:Y.Alert.Level.fatal,description:Y.Alert.Description.decompression_failure}})}}return !af.fail};ae.write.update=function(af,ag){if(!ae.write.compressFunction(af,ag,ae.write)){af.error(af,{message:"Could not compress record.",send:false,alert:{level:Y.Alert.Level.fatal,description:Y.Alert.Description.internal_error}})}else{if(!ae.write.cipherFunction(ag,ae.write)){af.error(af,{message:"Could not encrypt record.",send:false,alert:{level:Y.Alert.Level.fatal,description:Y.Alert.Description.internal_error}})}}return !af.fail};if(aa.session){var ad=aa.session.sp;aa.session.cipherSuite.initSecurityParameters(ad);ad.keys=Y.generateKeys(aa,ad);ae.read.macKey=ab?ad.keys.server_write_MAC_key:ad.keys.client_write_MAC_key;ae.write.macKey=ab?ad.keys.client_write_MAC_key:ad.keys.server_write_MAC_key;aa.session.cipherSuite.initConnectionState(ae,aa,ad);switch(ad.compression_algorithm){case Y.CompressionMethod.none:break;case Y.CompressionMethod.deflate:ae.read.compressFunction=K;ae.write.compressFunction=s;break;default:throw {message:"Unsupported compression algorithm."}}}return ae};Y.createRandom=function(){var aa=new Date();var ac=+aa+aa.getTimezoneOffset()*60000;var ab=H.util.createBuffer();ab.putInt32(ac);ab.putBytes(H.random.getBytes(28));return ab};Y.createRecord=function(aa){if(!aa.data){return null}var ab={type:aa.type,version:{major:Y.Version.major,minor:Y.Version.minor},length:aa.data.length(),fragment:aa.data};return ab};Y.createAlert=function(aa){var ab=H.util.createBuffer();ab.putByte(aa.level);ab.putByte(aa.description);return Y.createRecord({type:Y.ContentType.alert,data:ab})};Y.createClientHello=function(aa){var ab=H.util.createBuffer();for(var aj=0;aj<aa.cipherSuites.length;++aj){var ae=aa.cipherSuites[aj];ab.putByte(ae.id[0]);ab.putByte(ae.id[1])}var af=ab.length();var ad=H.util.createBuffer();ad.putByte(Y.CompressionMethod.none);var ac=ad.length();var ah=H.util.createBuffer();if(aa.virtualHost){var ag=H.util.createBuffer();ag.putByte(0);ag.putByte(0);var am=H.util.createBuffer();am.putByte(0);Z(am,2,H.util.createBuffer(aa.virtualHost));var ao=H.util.createBuffer();Z(ao,2,am);Z(ag,2,ao);ah.putBuffer(ag)}var ai=ah.length();if(ai>0){ai+=2}var an=aa.session.id;var ak=an.length+1+2+4+28+2+af+1+ac+ai;var al=H.util.createBuffer();al.putByte(Y.HandshakeType.client_hello);al.putInt24(ak);al.putByte(Y.Version.major);al.putByte(Y.Version.minor);al.putBytes(aa.session.sp.client_random);Z(al,1,H.util.createBuffer(an));Z(al,2,ab);Z(al,1,ad);if(ai>0){Z(al,2,ah)}return al};Y.createServerHello=function(aa){var ad=aa.session.id;var ab=ad.length+1+2+4+28+2+1;var ac=H.util.createBuffer();ac.putByte(Y.HandshakeType.server_hello);ac.putInt24(ab);ac.putByte(Y.Version.major);ac.putByte(Y.Version.minor);ac.putBytes(aa.session.sp.server_random);Z(ac,1,H.util.createBuffer(ad));ac.putByte(aa.session.cipherSuite.id[0]);ac.putByte(aa.session.cipherSuite.id[1]);ac.putByte(aa.session.compressionMethod);return ac};Y.createCertificate=function(ab){var af=(ab.entity===Y.ConnectionEnd.client);var ac=null;if(ab.getCertificate){ac=ab.getCertificate(ab,af?ab.session.certificateRequest:ab.session.serverNameList)}var ae=H.util.createBuffer();if(ac!==null){try{if(!H.util.isArray(ac)){ac=[ac]}var aa=null;for(var ai=0;ai<ac.length;++ai){var ak=H.pem.decode(ac[ai])[0];if(ak.type!=="CERTIFICATE"&&ak.type!=="X509 CERTIFICATE"&&ak.type!=="TRUSTED CERTIFICATE"){throw {message:'Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".',headerType:ak.type}}if(ak.procType&&ak.procType.type==="ENCRYPTED"){throw {message:"Could not convert certificate from PEM; PEM is encrypted."}}var ag=H.util.createBuffer(ak.body);if(aa===null){aa=H.asn1.fromDer(ag.bytes(),false)}var ad=H.util.createBuffer();Z(ad,3,ag);ae.putBuffer(ad)}ac=H.pki.certificateFromAsn1(aa);if(af){ab.session.clientCertificate=ac}else{ab.session.serverCertificate=ac}}catch(ah){return ab.error(ab,{message:"Could not send certificate list.",cause:ah,send:true,alert:{level:Y.Alert.Level.fatal,description:Y.Alert.Description.bad_certificate}})}}var aj=3+ae.length();var al=H.util.createBuffer();al.putByte(Y.HandshakeType.certificate);al.putInt24(aj);Z(al,3,ae);return al};Y.createClientKeyExchange=function(ab){var aa=H.util.createBuffer();aa.putByte(Y.Version.major);aa.putByte(Y.Version.minor);aa.putBytes(H.random.getBytes(46));var af=ab.session.sp;af.pre_master_secret=aa.getBytes();var ac=ab.session.serverCertificate.publicKey;aa=ac.encrypt(af.pre_master_secret);var ad=aa.length+2;var ae=H.util.createBuffer();ae.putByte(Y.HandshakeType.client_key_exchange);ae.putInt24(ad);ae.putInt16(aa.length);ae.putBytes(aa);return ae};Y.createServerKeyExchange=function(aa){var ab=0;var ac=H.util.createBuffer();if(ab>0){ac.putByte(Y.HandshakeType.server_key_exchange);ac.putInt24(ab)}return ac};Y.getClientSignature=function(ab,ac){var aa=H.util.createBuffer();aa.putBuffer(ab.session.md5.digest());aa.putBuffer(ab.session.sha1.digest());aa=aa.getBytes();ab.getSignature=ab.getSignature||function(ae,ad,af){var ah=null;if(ae.getPrivateKey){try{ah=ae.getPrivateKey(ae,ae.session.clientCertificate);ah=H.pki.privateKeyFromPem(ah)}catch(ag){ae.error(ae,{message:"Could not get private key.",cause:ag,send:true,alert:{level:Y.Alert.Level.fatal,description:Y.Alert.Description.internal_error}})}}if(ah===null){ae.error(ae,{message:"No private key set.",send:true,alert:{level:Y.Alert.Level.fatal,description:Y.Alert.Description.internal_error}})}else{ad=ah.sign(ad,null)}af(ae,ad)};ab.getSignature(ab,aa,ac)};Y.createCertificateVerify=function(aa,ad){var ab=ad.length+2;var ac=H.util.createBuffer();ac.putByte(Y.HandshakeType.certificate_verify);ac.putInt24(ab);ac.putInt16(ad.length);ac.putBytes(ad);return ac};Y.createCertificateRequest=function(aa){var ad=H.util.createBuffer();ad.putByte(1);var ab=H.util.createBuffer();for(var af in aa.caStore.certs){var ac=aa.caStore.certs[af];var ae=H.pki.distinguishedNameToAsn1(ac.subject);ab.putBuffer(H.asn1.toDer(ae))}var ag=1+ad.length()+2+ab.length();var ah=H.util.createBuffer();ah.putByte(Y.HandshakeType.certificate_request);ah.putInt24(ag);Z(ah,1,ad);Z(ah,2,ab);return ah};Y.createServerHelloDone=function(aa){var ab=H.util.createBuffer();ab.putByte(Y.HandshakeType.server_hello_done);ab.putInt24(0);return ab};Y.createChangeCipherSpec=function(){var aa=H.util.createBuffer();aa.putByte(1);return aa};Y.createFinished=function(ab){var aa=H.util.createBuffer();aa.putBuffer(ab.session.md5.digest());aa.putBuffer(ab.session.sha1.digest());var ac=(ab.entity===Y.ConnectionEnd.client);var ag=ab.session.sp;var ah=12;var ae=N;var ad=ac?"client finished":"server finished";aa=ae(ag.master_secret,ad,aa.getBytes(),ah);var af=H.util.createBuffer();af.putByte(Y.HandshakeType.finished);af.putInt24(aa.length());af.putBuffer(aa);return af};Y.queue=function(ab,af){if(!af){return}if(af.type===Y.ContentType.handshake){var aa=af.fragment.bytes();ab.session.md5.update(aa);ab.session.sha1.update(aa);aa=null}var ag;if(af.fragment.length()<=Y.MaxFragment){ag=[af]}else{ag=[];var ac=af.fragment.bytes();while(ac.length>Y.MaxFragment){ag.push(Y.createRecord({type:af.type,data:H.util.createBuffer(ac.slice(0,Y.MaxFragment))}));ac=ac.slice(Y.MaxFragment)}if(ac.length>0){ag.push(Y.createRecord({type:af.type,data:H.util.createBuffer(ac)}))}}for(var ad=0;ad<ag.length&&!ab.fail;++ad){var ae=ag[ad];var ah=ab.state.current.write;if(ah.update(ab,ae)){ab.records.push(ae)}}};Y.flush=function(aa){for(var ab=0;ab<aa.records.length;++ab){var ac=aa.records[ab];aa.tlsData.putByte(ac.type);aa.tlsData.putByte(ac.version.major);aa.tlsData.putByte(ac.version.minor);aa.tlsData.putInt16(ac.fragment.length());aa.tlsData.putBuffer(aa.records[ab].fragment)}aa.records=[];return aa.tlsDataReady(aa)};var i=function(aa){switch(aa){case true:return true;case H.pki.certificateError.bad_certificate:return Y.Alert.Description.bad_certificate;case H.pki.certificateError.unsupported_certificate:return Y.Alert.Description.unsupported_certificate;case H.pki.certificateError.certificate_revoked:return Y.Alert.Description.certificate_revoked;case H.pki.certificateError.certificate_expired:return Y.Alert.Description.certificate_expired;case H.pki.certificateError.certificate_unknown:return Y.Alert.Description.certificate_unknown;case H.pki.certificateError.unknown_ca:return Y.Alert.Description.unknown_ca;default:return Y.Alert.Description.bad_certificate}};var h=function(aa){switch(aa){case true:return true;case Y.Alert.Description.bad_certificate:return H.pki.certificateError.bad_certificate;case Y.Alert.Description.unsupported_certificate:return H.pki.certificateError.unsupported_certificate;case Y.Alert.Description.certificate_revoked:return H.pki.certificateError.certificate_revoked;case Y.Alert.Description.certificate_expired:return H.pki.certificateError.certificate_expired;case Y.Alert.Description.certificate_unknown:return H.pki.certificateError.certificate_unknown;case Y.Alert.Description.unknown_ca:return H.pki.certificateError.unknown_ca;default:return H.pki.certificateError.bad_certificate}};Y.verifyCertificateChain=function(aa,ab){try{H.pki.verifyCertificateChain(aa.caStore,ab,function ad(aj,af,ae){var ag=i(aj);var ai=aa.verify(aa,aj,af,ae);if(ai!==true){if(typeof ai==="object"&&!H.util.isArray(ai)){var ah={message:"The application rejected the certificate.",send:true,alert:{level:Y.Alert.Level.fatal,description:Y.Alert.Description.bad_certificate}};if(ai.message){ah.message=ai.message}if(ai.alert){ah.alert.description=ai.alert}throw ah}if(ai!==aj){ai=h(ai)}}return ai})}catch(ac){if(typeof ac!=="object"||H.util.isArray(ac)){ac={send:true,alert:{level:Y.Alert.Level.fatal,description:i(ac)}}}if(!("send" in ac)){ac.send=true}if(!("alert" in ac)){ac.alert={level:Y.Alert.Level.fatal,description:i(ac.error)}}aa.error(aa,ac)}return !aa.fail};Y.createSessionCache=function(aa,ab){var ad=null;if(aa&&aa.getSession&&aa.setSession&&aa.order){ad=aa}else{ad={};ad.cache=aa||{};ad.capacity=Math.max(ab||100,1);ad.order=[];for(var ac in aa){if(ad.order.length<=ab){ad.order.push(ac)}else{delete aa[ac]}}ad.getSession=function(ah){var ag=null;var af=null;if(ah){af=H.util.bytesToHex(ah)}else{if(ad.order.length>0){af=ad.order[0]}}if(af!==null&&af in ad.cache){ag=ad.cache[af];delete ad.cache[af];for(var ae in ad.order){if(ad.order[ae]===af){ad.order.splice(ae,1);break}}}return ag};ad.setSession=function(ag,af){if(ad.order.length===ad.capacity){var ae=ad.order.shift();delete ad.cache[ae]}var ae=H.util.bytesToHex(ag);ad.order.push(ae);ad.cache[ae]=af}}return ad};Y.createConnection=function(ai){var ae=null;if(ai.caStore){if(H.util.isArray(ai.caStore)){ae=H.pki.createCaStore(ai.caStore)}else{ae=ai.caStore}}else{ae=H.pki.createCaStore()}var af=ai.cipherSuites||null;if(af===null){af=[];for(var ah in Y.CipherSuites){af.push(Y.CipherSuites[ah])}}var ag=(ai.server||false)?Y.ConnectionEnd.server:Y.ConnectionEnd.client;var aj=ai.sessionCache?Y.createSessionCache(ai.sessionCache):null;var ad={entity:ag,sessionId:ai.sessionId,caStore:ae,sessionCache:aj,cipherSuites:af,connected:ai.connected,virtualHost:ai.virtualHost||null,verifyClient:ai.verifyClient||false,verify:ai.verify||function(ak,an,am,al){return an},getCertificate:ai.getCertificate||null,getPrivateKey:ai.getPrivateKey||null,getSignature:ai.getSignature||null,input:H.util.createBuffer(),tlsData:H.util.createBuffer(),data:H.util.createBuffer(),tlsDataReady:ai.tlsDataReady,dataReady:ai.dataReady,closed:ai.closed,error:function(ak,al){al.origin=al.origin||((ak.entity===Y.ConnectionEnd.client)?"client":"server");if(al.send){Y.queue(ak,Y.createAlert(al.alert));Y.flush(ak)}var am=(al.fatal!==false);if(am){ak.fail=true}ai.error(ak,al);if(am){ak.close(false)}},deflate:ai.deflate||null,inflate:ai.inflate||null};ad.reset=function(ak){ad.record=null;ad.session=null;ad.peerCertificate=null;ad.state={pending:null,current:null};ad.expect=(ad.entity===Y.ConnectionEnd.client)?W:p;ad.fragmented=null;ad.records=[];ad.open=false;ad.handshakes=0;ad.handshaking=false;ad.isConnected=false;ad.fail=!(ak||typeof(ak)==="undefined");ad.input.clear();ad.tlsData.clear();ad.data.clear();ad.state.current=Y.createConnectionState(ad)};ad.reset();var ac=function(al,an){var ak=an.type-Y.ContentType.change_cipher_spec;var am=r[al.entity][al.expect];if(ak in am){am[ak](al,an)}else{Y.handleUnexpected(al,an)}};var ab=function(al){var an=0;var ak=al.input;var am=ak.length();if(am<5){an=5-am}else{al.record={type:ak.getByte(),version:{major:ak.getByte(),minor:ak.getByte()},length:ak.getInt16(),fragment:H.util.createBuffer(),ready:false};if(al.record.version.major!==Y.Version.major||al.record.version.minor!==Y.Version.minor){al.error(al,{message:"Incompatible TLS version.",send:true,alert:{level:Y.Alert.Level.fatal,description:Y.Alert.Description.protocol_version}})}}return an};var aa=function(al){var an=0;var ak=al.input;var am=ak.length();if(am<al.record.length){an=al.record.length-am}else{al.record.fragment.putBytes(ak.getBytes(al.record.length));ak.compact();var ao=al.state.current.read;if(ao.update(al,al.record)){if(al.fragmented!==null){if(al.fragmented.type===al.record.type){al.fragmented.fragment.putBuffer(al.record.fragment);al.record=al.fragmented}else{al.error(al,{message:"Invalid fragmented record.",send:true,alert:{level:Y.Alert.Level.fatal,description:Y.Alert.Description.unexpected_message}})}}al.record.ready=true}}return an};ad.handshake=function(al){if(ad.entity!==Y.ConnectionEnd.client){ad.error(ad,{message:"Cannot initiate handshake as a server.",fatal:false})}else{if(ad.handshaking){ad.error(ad,{message:"Handshake already in progress.",fatal:false})}else{if(ad.fail&&!ad.open&&ad.handshakes===0){ad.fail=false}ad.handshaking=true;al=al||"";var ak=null;if(al.length>0){if(ad.sessionCache){ak=ad.sessionCache.getSession(al)}if(ak===null){al=""}}if(al.length===0&&ad.sessionCache){ak=ad.sessionCache.getSession();if(ak!==null){al=ak.id}}ad.session={id:al,cipherSuite:null,compressionMethod:null,serverCertificate:null,certificateRequest:null,clientCertificate:null,sp:ak?ak.sp:{},md5:H.md.md5.create(),sha1:H.md.sha1.create()};ad.session.sp.client_random=Y.createRandom().getBytes();ad.open=true;Y.queue(ad,Y.createRecord({type:Y.ContentType.handshake,data:Y.createClientHello(ad)}));Y.flush(ad)}}};ad.process=function(ak){var al=0;if(ak){ad.input.putBytes(ak)}if(!ad.fail){if(ad.record!==null&&ad.record.ready&&ad.record.fragment.isEmpty()){ad.record=null}if(ad.record===null){al=ab(ad)}if(!ad.fail&&ad.record!==null&&!ad.record.ready){al=aa(ad)}if(!ad.fail&&ad.record!==null&&ad.record.ready){ac(ad,ad.record)}}return al};ad.prepare=function(ak){Y.queue(ad,Y.createRecord({type:Y.ContentType.application_data,data:H.util.createBuffer(ak)}));return Y.flush(ad)};ad.close=function(ak){if(!ad.fail&&ad.sessionCache&&ad.session){ad.sessionCache.setSession(ad.session.id,ad.session)}if(ad.open){ad.open=false;ad.input.clear();if(ad.isConnected||ad.handshaking){ad.isConnected=ad.handshaking=false;Y.queue(ad,Y.createAlert({level:Y.Alert.Level.warning,description:Y.Alert.Description.close_notify}));Y.flush(ad)}ad.closed(ad)}ad.reset(ak)};return ad};H.tls=H.tls||{};for(var L in Y){if(typeof Y[L]!=="function"){H.tls[L]=Y[L]}}H.tls.prf_tls1=N;H.tls.hmac_sha1=I;H.tls.createSessionCache=Y.createSessionCache;H.tls.createConnection=Y.createConnection}var d="tls";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var e=true;define=function(h,g){g(require,module)}}else{if(typeof forge==="undefined"){forge={}}return c(forge)}}var b;var a=function(h,g){g.exports=function(j){var l=b.map(function(i){return h(i)}).concat(c);j=j||{};j.defined=j.defined||{};if(j.defined[d]){return j[d]}j.defined[d]=true;for(var k=0;k<l.length;++k){l[k](j)}return j[d]}};var f=define;define=function(h,g){b=(typeof h==="string")?g.slice(2):h.slice(2);if(e){delete define;return f.apply(null,Array.prototype.slice.call(arguments,0))}define=f;return define.apply(null,Array.prototype.slice.call(arguments,0))};define(["require","module","./asn1","./hmac","./md","./pem","./pki","./random","./util"],function(){a.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function c(k){var m=k.tls;m.CipherSuites.TLS_RSA_WITH_AES_128_CBC_SHA={id:[0,47],name:"TLS_RSA_WITH_AES_128_CBC_SHA",initSecurityParameters:function(n){n.bulk_cipher_algorithm=m.BulkCipherAlgorithm.aes;n.cipher_type=m.CipherType.block;n.enc_key_length=16;n.block_length=16;n.fixed_iv_length=16;n.record_iv_length=16;n.mac_algorithm=m.MACAlgorithm.hmac_sha1;n.mac_length=20;n.mac_key_length=20},initConnectionState:l};m.CipherSuites.TLS_RSA_WITH_AES_256_CBC_SHA={id:[0,53],name:"TLS_RSA_WITH_AES_256_CBC_SHA",initSecurityParameters:function(n){n.bulk_cipher_algorithm=m.BulkCipherAlgorithm.aes;n.cipher_type=m.CipherType.block;n.enc_key_length=32;n.block_length=16;n.fixed_iv_length=16;n.record_iv_length=16;n.mac_algorithm=m.MACAlgorithm.hmac_sha1;n.mac_length=20;n.mac_key_length=20},initConnectionState:l};function l(q,n,p){var o=(n.entity===k.tls.ConnectionEnd.client);q.read.cipherState={init:false,cipher:k.aes.createDecryptionCipher(o?p.keys.server_write_key:p.keys.client_write_key),iv:o?p.keys.server_write_IV:p.keys.client_write_IV};q.write.cipherState={init:false,cipher:k.aes.createEncryptionCipher(o?p.keys.client_write_key:p.keys.server_write_key),iv:o?p.keys.client_write_IV:p.keys.server_write_IV};q.read.cipherFunction=g;q.write.cipherFunction=i;q.read.macLength=q.write.macLength=p.mac_length;q.read.macFunction=q.write.macFunction=m.hmac_sha1}function i(q,t){var r=false;var p=t.macFunction(t.macKey,t.sequenceNumber,q);q.fragment.putBytes(p);t.updateSequenceNumber();var o;if(q.version.minor>1){o=k.random.getBytes(16)}else{o=t.cipherState.init?null:t.cipherState.iv}t.cipherState.init=true;var n=t.cipherState.cipher;n.start(o);if(q.version.minor>1){n.output.putBytes(o)}n.update(q.fragment);if(n.finish(j)){q.fragment=n.output;q.length=q.fragment.length();r=true}return r}function j(n,p,o){if(!o){var q=n-(p.length()%n);p.fillWithByte(q-1,q)}return true}function h(n,r,o){var t=true;if(o){var q=r.length();var s=r.last();for(var p=q-1-s;p<q-1;++p){t=t&&(r.at(p)==s)}if(t){r.truncate(s+1)}}return t}function g(v,x){var w=false;var p=x.cipherState.init?null:x.cipherState.iv;x.cipherState.init=true;var n=x.cipherState.cipher;n.start(p);n.update(v.fragment);w=n.finish(h);var u=x.macLength;var r="";for(var o=0;o<u;++o){r+=String.fromCharCode(0)}var q=n.output.length();if(q>=u){v.fragment=n.output.getBytes(q-u);r=n.output.getBytes(u)}else{v.fragment=n.output.getBytes()}v.fragment=k.util.createBuffer(v.fragment);v.length=v.fragment.length();var t=x.macFunction(x.macKey,x.sequenceNumber,v);x.updateSequenceNumber();w=(t===r)&&w;return w}}var d="aesCipherSuites";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var e=true;define=function(h,g){g(require,module)}}else{if(typeof forge==="undefined"){forge={}}return c(forge)}}var b;var a=function(h,g){g.exports=function(j){var l=b.map(function(i){return h(i)}).concat(c);j=j||{};j.defined=j.defined||{};if(j.defined[d]){return j[d]}j.defined[d]=true;for(var k=0;k<l.length;++k){l[k](j)}return j[d]}};var f=define;define=function(h,g){b=(typeof h==="string")?g.slice(2):h.slice(2);if(e){delete define;return f.apply(null,Array.prototype.slice.call(arguments,0))}define=f;return define.apply(null,Array.prototype.slice.call(arguments,0))};define(["require","module","./aes","./tls"],function(){a.apply(null,Array.prototype.slice.call(arguments,0))})})();